import { q, c as a$4, a as s$3, w as p$2, x as m$3, A as v$2, l as a$5, r as r$2, U as k$2, J as g$2, u as r$3, s as s$5, X as f$5, T, z as r$4, az as t, f as r$5, _ as d$2 } from './cast-3d5be210.js';
import { d as f$4, c as s$4, g as d$1, Q, h as a$7 } from './request-ac4d8bfb.js';
import { a as a$6 } from './assets-99f5c3ee.js';
import './intl-54ccdc89.js';
import { l as l$1 } from './Promise-d2759b2e.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e$2{constructor(t=(t=>t.values().next().value)){this._peeker=t,this._items=new Set;}get length(){return this._items.size}clear(){this._items.clear();}last(){if(0===this._items.size)return;let t;for(t of this._items);return t}peek(){if(0!==this._items.size)return this._peeker(this._items)}push(t){this.contains(t)||this._items.add(t);}contains(t){return this._items.has(t)}pop(){if(0===this.length)return;const e=this.peek();return this._items.delete(q(e)),e}popLast(){if(0===this.length)return;const e=this.last();return this._items.delete(q(e)),e}remove(t){this._items.delete(t);}filter(t){return this._items.forEach((e=>{t(e)||this._items.delete(e);})),this}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var e$1;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON";}(e$1||(e$1={}));let r$1=0;function n$1(){return r$1++}function s$2(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}function a$3(t){return t?"string"==typeof t?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function i(t,r,n,a){if(r.type===e$1.OPEN_PORT)return void t.postMessage(r,[r.port]);if(r.type!==e$1.INVOKE&&r.type!==e$1.RESPONSE)return void t.postMessage(r);let i;s$2(n)?(i=o(n.transferList),r.data=n.result):(i=o(a),r.data=n),i?t.postMessage(r,i):t.postMessage(r);}function f$3(t){if(!t)return null;const e=t.data;return e?"string"==typeof e?JSON.parse(e):e:null}function o(e){if(!e||!e.length)return null;if(a$4("esri-workers-arraybuffer-transfer"))return e;const r=e.filter((t=>!u$2(t)));return r.length?r:null}function u$2(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const k$1={statsWorker:()=>import('./statsWorker-be044ea3.js'),geometryEngineWorker:()=>import('./geometryEngineWorker-919c3dda.js'),CSVSourceWorker:()=>import('./CSVSourceWorker-5f116214.js'),EdgeProcessingWorker:()=>import('./EdgeProcessingWorker-87151cf6.js').then(function (n) { return n.E; }),ElevationSamplerWorker:()=>import('./ElevationSamplerWorker-b25404d2.js'),FeatureServiceSnappingSourceWorker:()=>import('./FeatureServiceSnappingSourceWorker-9a7001d7.js'),GeoJSONSourceWorker:()=>import('./GeoJSONSourceWorker-308cf5ec.js'),LercWorker:()=>import('./LercWorker-4e89653f.js'),MemorySourceWorker:()=>import('./MemorySourceWorker-d4599236.js'),PBFDecoderWorker:()=>import('./PBFDecoderWorker-84fd06a9.js'),Pipeline:()=>import('./Pipeline-d06e6db8.js'),PointCloudWorker:()=>import('./PointCloudWorker-0959e161.js'),RasterWorker:()=>import('./RasterWorker-4645cffc.js'),SceneLayerSnappingSourceWorker:()=>import('./SceneLayerSnappingSourceWorker-d669febb.js'),SceneLayerWorker:()=>import('./SceneLayerWorker-58c8c123.js').then(function (n) { return n.S; }),WFSSourceWorker:()=>import('./WFSSourceWorker-4a307784.js'),WorkerTileHandler:()=>import('./WorkerTileHandler-5724d47a.js')},{CLOSE:b$2,ABORT:v$1,INVOKE:y$1,RESPONSE:j$1,OPEN_PORT:S,ON:f$2}=e$1,W=2;class M{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this);}push(e){e.type===e$1.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)));}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null;}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0;}}class w$2{constructor(e,s,t){this._port=e,this._getNextJob=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new M((e=>this._onInvokeMessage(e))),this._client=s.client,this._onMessage=this._onMessage.bind(this),this._channel=s.channel,this._schedule=s.schedule,this._port.addEventListener("message",this._onMessage),this._port.start();}static connect(e){const s=new MessageChannel;let t;t="function"==typeof e?new e:"default"in e&&"function"==typeof e.default?new e.default:e;const o=new w$2(s.port1,{channel:s,client:t},(()=>null));return "object"==typeof t&&"remoteClient"in t&&(t.remoteClient=o),w$2.clients.set(o,t),s.port2}static loadWorker(e){const s=k$1[e];return s?s():Promise.resolve(null)}close(){this._post({type:b$2}),this._close();}isBusy(){return this._outJobs.size>0}invoke(e,t,r){const c=r&&r.signal,l=r&&r.transferList;if(!this._port)return Promise.reject(new s$3("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:t}));const h=n$1();return new Promise(((s,r)=>{if(p$2(c))return this._processWork(),void r(m$3());const p=v$2(c,(()=>{const e=this._outJobs.get(h);e&&(this._outJobs.delete(h),this._processWork(),a$5(e.abortHandle),this._post({type:v$1,jobId:h}),r(m$3()));})),u={resolve:s,reject:r,abortHandle:p,debugInfo:e};this._outJobs.set(h,u),this._post({type:y$1,jobId:h,methodName:e,abortable:null!=c},t,l);}))}on(e,s){const t=new MessageChannel;function o(e){s(e.data);}return this._port.postMessage({type:e$1.ON,eventType:e,port:t.port2},[t.port2]),t.port1.addEventListener("message",o),t.port1.start(),{remove(){t.port1.postMessage({type:e$1.CLOSE}),t.port1.close(),t.port1.removeEventListener("message",o);}}}jobAdded(){this._processWork();}openPort(){const e=new MessageChannel;return this._post({type:S,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=W)return;const e=this._getNextJob();if(!e)return;const{methodName:s,data:t,invokeOptions:o,deferred:r}=e;this.invoke(s,t,o).then((e=>r.resolve(e))).catch((e=>r.reject(e)));}_close(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((e=>{a$5(e.abortHandle),e.reject(m$3(`Worker closing, aborting job calling '${e.debugInfo}'`));})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null;}_onMessage(e){r$2(this._schedule)?this._schedule((()=>this._processMessage(e))):this._processMessage(e);}_processMessage(e){const s=f$3(e);if(s)switch(s.type){case j$1:this._onResponseMessage(s);break;case y$1:this._invokeQueue.push(s);break;case v$1:this._onAbortMessage(s);break;case b$2:this._onCloseMessage();break;case S:this._onOpenPortMessage(s);break;case f$2:this._onOnMessage(s);}}_onAbortMessage(e){const s=this._inJobs,t=e.jobId,o=s.get(t);this._invokeQueue.push(e),o&&(o.controller&&o.controller.abort(),s.delete(t));}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&w$2.clients.get(this)===e&&e.destroy(),w$2.clients.delete(this),e&&e.remoteClient&&(e.remoteClient=null);}_onInvokeMessage(e){const{methodName:s,jobId:t,data:o,abortable:r}=e,i=r?new AbortController:null,n=this._inJobs;let a,p=this._client,h=p[s];try{if(!h&&s&&s.includes(".")){const e=s.split(".");for(let s=0;s<e.length-1;s++)p=p[e[s]],h=p[e[s+1]];}if("function"!=typeof h)throw new TypeError(`${s} is not a function`);a=h.call(p,o,{client:this,signal:i?i.signal:null});}catch(u){return void this._post({type:j$1,jobId:t,error:a$3(u)})}k$2(a)?(n.set(t,{controller:i,promise:a}),a.then((e=>{n.has(t)&&(n.delete(t),this._post({type:j$1,jobId:t},e));}),(e=>{n.has(t)&&(n.delete(t),g$2(e)||this._post({type:j$1,jobId:t,error:a$3(e||{message:`Error encountered at method ${s}`})}));}))):this._post({type:j$1,jobId:t},a);}_onOpenPortMessage(e){new w$2(e.port,{client:this._client},(()=>null));}_onOnMessage(e){const{port:s}=e,o=this._client.on(e.eventType,(e=>{s.postMessage(e);})),r=r$3(e.port,"message",(e=>{f$3(e).type===e$1.CLOSE&&(r.remove(),o.remove(),s.close());}));}_onResponseMessage(e){const{jobId:t,error:r,data:i}=e,n=this._outJobs;if(!n.has(t))return;const a=n.get(t);this._processWork(),n.delete(t),a$5(a.abortHandle),r?a.reject(s$3.fromJSON(JSON.parse(r))):a.resolve(i);}_post(e,s,t){return i(this._port,e,s,t)}}w$2.kernelInfo={revision:f$4,version:s$4,buildDate:d$1},w$2.clients=new Map;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const h$2=s$5.getLogger("esri.core.workers.Connection");class c$1{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new e$2;}destroy(){this.close();}get closed(){return !this._clients||!this._clients.length}open(e,t){return new Promise(((n,i)=>{let r=!0;const h=e=>{f$5(t.signal),r&&(r=!1,e());};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let o=0;o<e.length;++o){const r=e[o];k$2(r)?this._clientPromises[o]=r.then((e=>(this._clients[o]=new w$2(e,t,(()=>this._ongoingJobsQueue.pop())),h(n),this._clients[o])),(()=>(h(i),null))):(this._clients[o]=new w$2(r,t,(()=>this._ongoingJobsQueue.pop())),this._clientPromises[o]=Promise.resolve(this._clients[o]),h(n));}}))}broadcast(e,t,s){const n=new Array(this._clientPromises.length);for(let i=0;i<this._clientPromises.length;++i){const o=this._clientPromises[i];n[i]=o.then((n=>n.invoke(e,t,s)));}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.deferred.reject(m$3(`Worker closing, aborting job calling '${e.methodName}'`));for(const t of this._clientPromises)t.then((e=>e.close()));this._clients.length=0,this._clientPromises.length=0;}invoke(e,t,s){let n=null;Array.isArray(s)?(h$2.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:s}):n=s;const o=T();this._ongoingJobsQueue.push({methodName:e,data:t,invokeOptions:n,deferred:o});for(let i=0;i<this._clientPromises.length;i++){const e=this._clients[i];e?e.jobAdded():this._clientPromises[i].then((e=>e.jobAdded()));}return o.promise}on(t,s){return Promise.all(this._clientPromises).then((()=>r$4(this._clients.map((e=>e.on(t,s))))))}openPorts(){return new Promise((e=>{const t=new Array(this._clientPromises.length);let s=t.length;for(let n=0;n<this._clientPromises.length;++n){this._clientPromises[n].then((i=>{t[n]=i.openPort(),0==--s&&e(t);}));}}))}get test(){return {numClients:this._clients.length}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let s$1=null;const a$2={};function e(s,a){for(const e of s)if(e.name===a.name)return;s.push(a);}function r(s){const r={async:s.async,isDebug:s.isDebug,locale:s.locale,baseUrl:s.baseUrl,has:{...s.has},map:{...s.map},packages:s.packages&&s.packages.concat()||[],paths:{...s.paths}};return s.hasOwnProperty("async")||(r.async=!0),s.hasOwnProperty("isDebug")||(r.isDebug=!1),s.baseUrl||(r.baseUrl=a$2.baseUrl),a$2.packages?.forEach((s=>{e(r.packages,s);})),r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class n{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((s=>{this[s]=(...r)=>e[s](...r);}));}}class a$1{constructor(){this._dispatcher=new n,this._workerPostMessage({type:e$1.HANDSHAKE});}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e);}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e);}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e);}postMessage(s){t((()=>{this._workerMessageHandler(new MessageEvent("message",{data:s}));}));}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,s,r){this._dispatcher.addEventListener(e,s,r);}removeEventListener(e,s,r){this._dispatcher.removeEventListener(e,s,r);}_workerPostMessage(s){t((()=>{this.dispatchEvent(new MessageEvent("message",{data:s}));}));}async _workerMessageHandler(e){const n=f$3(e);if(n&&n.type===e$1.OPEN){const{modulePath:e,jobId:t}=n;let a=await w$2.loadWorker(e);a||(a=await import(
/* @vite-ignore */
/* webpackIgnore: true */
e));const o=w$2.connect(a);this._workerPostMessage({type:e$1.OPENED,jobId:t,data:o});}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const m$2=s$5.getLogger("esri.core.workers"),{HANDSHAKE:p$1}=e$1,g$1='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let k,h$1;const w$1="Failed to create Worker. Fallback to execute module in main thread";async function y(){if(!a$4("esri-workers")||(a$4("mozilla"),0))return b$1(new a$1);if(!k&&!h$1)try{const e=g$1.replace('"{CONFIGURATION}"',`'${v()}'`);k=URL.createObjectURL(new Blob([e],{type:"text/javascript"}));}catch(r){h$1=r||{};}let e;if(k)try{e=new Worker(k,{name:"esri-worker-"+P++});}catch(r){m$2.warn(w$1,h$1),e=new a$1;}else m$2.warn(w$1,h$1),e=new a$1;return b$1(e)}async function b$1(e){return new Promise((r=>{function o(s){const i=f$3(s);i&&i.type===p$1&&(e.removeEventListener("message",o),e.removeEventListener("error",t),r(e));}function t(r){r.preventDefault(),e.removeEventListener("message",o),e.removeEventListener("error",t),m$2.warn("Failed to create Worker. Fallback to execute module in main thread",r),(e=new a$1).addEventListener("message",o),e.addEventListener("error",t);}e.addEventListener("message",o),e.addEventListener("error",t);}))}function v(){let s;if(null!=r$5.default){const e={...r$5};delete e.default,s=JSON.parse(JSON.stringify(e));}else s=JSON.parse(JSON.stringify(r$5));s.assetsPath=Q(s.assetsPath),s.request.interceptors=[],s.log.interceptors=[],s.locale=l$1(),s.has={"esri-csp-restrictions":a$4("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":a$4("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":a$4("esri-2d-query-centroid-enabled"),"featurelayer-pbf":a$4("featurelayer-pbf"),"featurelayer-simplify-thresholds":a$4("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":a$4("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":a$4("featurelayer-simplify-mobile-factor"),"esri-atomics":a$4("esri-atomics"),"esri-shared-array-buffer":a$4("esri-shared-array-buffer"),"esri-tiles-debug":a$4("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":a$4("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":a$4("feature-polyline-generalization-factor"),"host-webworker":1},s.workers.loaderUrl&&(s.workers.loaderUrl=Q(s.workers.loaderUrl)),s.workers.workerPath?s.workers.workerPath=Q(s.workers.workerPath):s.workers.workerPath=Q(a$6("esri/core/workers/RemoteClient.js")),s.workers.useDynamicImport=!1;const a=r$5.workers.loaderConfig,l=r({baseUrl:a?.baseUrl,locale:l$1(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...a?.has},map:{...a?.map},paths:{...a?.paths},packages:a?.packages||[]}),f={version:s$4,buildDate:d$1,revision:f$4};return JSON.stringify({esriConfig:s,loaderConfig:l,kernelInfo:f})}let P=0;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const b=s$5.getLogger("esri.core.workers"),{ABORT:m$1,INVOKE:_,OPEN:g,OPENED:u$1,RESPONSE:j}=e$1;class f$1{constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(e=>{e.preventDefault(),b.error(e);}));}static async create(e){const t=await y();return new f$1(t,e)}terminate(){this.worker.terminate();}async open(e,t={}){const{signal:o}=t,s=n$1();return new Promise(((t,n)=>{const a={resolve:t,reject:n,abortHandle:d$2(o,(()=>{this._outJobs.delete(s),this._post({type:m$1,jobId:s});}))};this._outJobs.set(s,a),this._post({type:g,jobId:s,modulePath:e});}))}_onMessage(e){const t=f$3(e);if(t)switch(t.type){case u$1:this._onOpenedMessage(t);break;case j:this._onResponseMessage(t);break;case m$1:this._onAbortMessage(t);break;case _:this._onInvokeMessage(t);}}_onAbortMessage(e){const t=this._inJobs,o=e.jobId,s=t.get(o);s&&(s.controller&&s.controller.abort(),t.delete(o));}_onInvokeMessage(t){const{methodName:o,jobId:s,data:r,abortable:i}=t,l=i?new AbortController:null,h=this._inJobs,c=a$7[o];let p;try{if("function"!=typeof c)throw new TypeError(`${o} is not a function`);p=c.call(null,r,{signal:l?l.signal:null});}catch(b){return void this._post({type:j,jobId:s,error:a$3(b)})}k$2(p)?(h.set(s,{controller:l,promise:p}),p.then((e=>{h.has(s)&&(h.delete(s),this._post({type:j,jobId:s},e));}),(e=>{h.has(s)&&(h.delete(s),e||(e={message:"Error encountered at method"+o}),g$2(e)||this._post({type:j,jobId:s,error:a$3(e||{message:`Error encountered at method ${o}`})}));}))):this._post({type:j,jobId:s},p);}_onOpenedMessage(e){const{jobId:t,data:o}=e,r=this._outJobs.get(t);r&&(this._outJobs.delete(t),a$5(r.abortHandle),r.resolve(o));}_onResponseMessage(e){const{jobId:o,error:r,data:n}=e,a=this._outJobs.get(o);a&&(this._outJobs.delete(o),a$5(a.abortHandle),r?a.reject(s$3.fromJSON(JSON.parse(r))):a.resolve(n));}_post(e,t,o){return i(this.worker,e,t,o)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let s=a$4("esri-workers-debug")?1:a$4("host-browser")?navigator.hardwareConcurrency-1:0;s||(s=a$4("safari")&&a$4("mac")||a$4("trident")?7:2);let a=0;const l=[];function c(){h();}function m(t,r){return f(t,{client:r})}async function f(t,r){const e=new c$1;return await e.open(t,r),e}async function u(o,i={}){if("string"!=typeof o)throw new s$3("workers:undefined-module","modulePath is missing");let c=i.strategy||"distributed";if(a$4("host-webworker")&&!a$4("esri-workers")&&(c="local"),"local"===c){let t=await w$2.loadWorker(o);t||(t=await import(
/* @vite-ignore */
/* webpackIgnore: true */
o)),f$5(i.signal);const r=i.client||t;return f([w$2.connect(t)],{...i,client:r})}if(await h(),f$5(i.signal),"dedicated"===c){const t=a++%s;return f([await l[t].open(o,i)],i)}if(i.maxNumWorkers&&i.maxNumWorkers>0){const t=Math.min(i.maxNumWorkers,s);if(t<s){const r=new Array(t);for(let e=0;e<t;++e){const t=a++%s;r[e]=l[t].open(o,i);}return f(r,i)}}return f(l.map((t=>t.open(o,i))),i)}function p(){d&&(w.abort(),d=null);for(let t=0;t<l.length;t++)l[t]&&l[t].terminate();l.length=0;}let w,d=null;async function h(){if(d)return d;w=new AbortController;const t=[];for(let r=0;r<s;r++){const e=f$1.create(r).then((t=>(l[r]=t,t)));t.push(e);}return d=Promise.all(t),d}

export { c$1 as a, c, e$2 as e, u };
