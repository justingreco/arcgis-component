import { x } from './earcut-4e6b97b1.js';
import { f as f$1 } from './Polyline-dcdb3782.js';
import { n as n$2 } from './deduplicate-3951315a.js';
import { al as v, e, d as d$1, n as n$3, r as r$2, s as s$1, m as m$3, I as s$2 } from './cast-3d5be210.js';
import { l as l$2 } from './JSONSupport-dce2c67b.js';
import { l as l$3 } from './Color-25ce730a.js';
import { r as r$1, o as o$1 } from './Point-edff2a11.js';
import { c as c$3, p as p$3 } from './persistableUrlUtils-5dcd6081.js';
import { M } from './screenshotUtils-af7d4bfe.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function o(t){const o=l$1(t.rings,t.hasZ,c$2.CCW_IS_HOLE),s=[];let i=0,h=0;for(const e of o.polygons){const t=e.count,r=e.index,l=new Float64Array(o.position.buffer,3*r*o.position.BYTES_PER_ELEMENT,3*t),c=e.holeIndices.map((n=>n-r)),f=new Uint32Array(x(l,c,3));s.push({position:l,faces:f}),i+=l.length,h+=f.length;}const f=r(s,i,h),a=n$2(f.position.buffer,6,{originalIndices:f.faces});return f.position=new Float64Array(a.buffer),f.faces=a.indices,f}function r(n,t,e){if(1===n.length)return n[0];const o=new Float64Array(t),r=new Uint32Array(e);let l=0,s=0,i=0;for(const c of n){for(let n=0;n<c.position.length;n++)o[l++]=c.position[n];for(let n=0;n<c.faces.length;n++)r[s++]=c.faces[n]+i;i=l/3;}return {position:o,faces:r}}function l$1(n,t,e){const o=n.length,r=new Array(o),l=new Array(o),h=new Array(o);let f=0,a=0,g=0,u=0;for(let s=0;s<o;++s)u+=n[s].length;const p=new Float64Array(3*u);let d=0;for(let y=o-1;y>=0;y--){const u=n[y],w=e===c$2.CCW_IS_HOLE&&i$1(u);if(w&&1!==o)r[f++]=u;else {let n=u.length;for(let t=0;t<f;++t)n+=r[t].length;const e={index:d,pathLengths:new Array(f+1),count:n,holeIndices:new Array(f)};e.pathLengths[0]=u.length,u.length>0&&(h[g++]={index:d,count:u.length}),d=w?s(u,u.length-1,-1,p,d,u.length,t):s(u,0,1,p,d,u.length,t);for(let o=0;o<f;++o){const n=r[o];e.holeIndices[o]=d,e.pathLengths[o+1]=n.length,n.length>0&&(h[g++]={index:d,count:n.length}),d=s(n,0,1,p,d,n.length,t);}f=0,e.count>0&&(l[a++]=e);}}for(let i=0;i<f;++i){const n=r[i];n.length>0&&(h[g++]={index:d,count:n.length}),d=s(n,0,1,p,d,n.length,t);}return a<o&&(l.length=a),g<o&&(h.length=g),{position:p,polygons:l,outlines:h}}function s(n,t,e,o,r,l,s){r*=3;for(let i=0;i<l;++i){const l=n[t];o[r++]=l[0],o[r++]=l[1],o[r++]=s?l[2]:0,t+=e;}return r/3}function i$1(n){return !f$1(n,!1,!1)}var c$2;!function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE";}(c$2||(c$2={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var p$2;const d=new WeakMap;let h$1=0,u$4=p$2=class extends l$2{constructor(t){super(t),this.wrap="repeat";}get url(){return this._get("url")||null}set url(t){this._set("url",t),t&&this._set("data",null);}get data(){return this._get("data")||null}set data(t){this._set("data",t),t&&this._set("url",null);}writeData(t,e,a,r){if(t instanceof HTMLImageElement){const s={type:"image-element",src:c$3(t.src,r),crossOrigin:t.crossOrigin};e[a]=s;}else if(t instanceof HTMLCanvasElement){const r=t.getContext("2d").getImageData(0,0,t.width,t.height),s={type:"canvas-element",imageData:this._encodeImageData(r)};e[a]=s;}else if(t instanceof HTMLVideoElement){const s={type:"video-element",src:c$3(t.src,r),autoplay:t.autoplay,loop:t.loop,muted:t.muted,crossOrigin:t.crossOrigin,preload:t.preload};e[a]=s;}else {const r={type:"image-data",imageData:this._encodeImageData(t)};e[a]=r;}}readData(t){switch(t.type){case"image-element":{const e=new Image;return e.src=t.src,e.crossOrigin=t.crossOrigin,e}case"canvas-element":{const e=this._decodeImageData(t.imageData),a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(e,0,0),a}case"image-data":return this._decodeImageData(t.imageData);case"video-element":{const e=document.createElement("video");return e.src=t.src,e.crossOrigin=t.crossOrigin,e.autoplay=t.autoplay,e.loop=t.loop,e.muted=t.muted,e.preload=t.preload,e}default:return}}get transparent(){const t=this.data,e=this.url;if(t instanceof HTMLCanvasElement)return this._imageDataContainsTransparent(t.getContext("2d").getImageData(0,0,t.width,t.height));if(t instanceof ImageData)return this._imageDataContainsTransparent(t);if(e){const t=e.substr(e.length-4,4).toLowerCase(),a=e.substr(0,15).toLocaleLowerCase();if(".png"===t||"data:image/png;"===a)return !0}return !1}set transparent(t){null!=t?this._override("transparent",t):this._clearOverride("transparent");}get contentHash(){const t="string"==typeof this.wrap?this.wrap:"object"==typeof this.wrap?`${this.wrap.horizontal}/${this.wrap.vertical}`:"",e=(e="")=>`d:${e},t:${this.transparent},w:${t}`;return null!=this.url?e(this.url):null!=this.data?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?e(this.data.src):(d.has(this.data)||d.set(this.data,++h$1),e(d.get(this.data))):e()}clone(){const t={url:this.url,data:this.data,wrap:this._cloneWrap()};return new p$2(t)}cloneWithDeduplication(t){const e=t.get(this);if(e)return e;const a=this.clone();return t.set(this,a),a}_cloneWrap(){return "string"==typeof this.wrap?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}_encodeImageData(t){let e="";for(let a=0;a<t.data.length;a++)e+=String.fromCharCode(t.data[a]);return {data:btoa(e),width:t.width,height:t.height}}_decodeImageData(t){const e=atob(t.data),a=new Uint8ClampedArray(e.length);for(let r=0;r<e.length;r++)a[r]=e.charCodeAt(r);return M(a,t.width,t.height)}_imageDataContainsTransparent(t){for(let e=3;e<t.data.length;e+=4)if(255!==t.data[e])return !0;return !1}static from(t){return "string"==typeof t?new p$2({url:t}):t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLVideoElement?new p$2({data:t}):v(p$2,t)}};e([d$1({type:String,json:{write:p$3}})],u$4.prototype,"url",null),e([d$1({json:{write:{overridePolicy(){return {enabled:!this.url}}}}}),d$1()],u$4.prototype,"data",null),e([r$1("data")],u$4.prototype,"writeData",null),e([o$1("data")],u$4.prototype,"readData",null),e([d$1({type:Boolean,json:{write:{overridePolicy(){return {enabled:this._isOverridden("transparent")}}}}})],u$4.prototype,"transparent",null),e([d$1({json:{write:!0}})],u$4.prototype,"wrap",void 0),e([d$1({readOnly:!0})],u$4.prototype,"contentHash",null),u$4=p$2=e([n$3("esri.geometry.support.MeshTexture")],u$4);const m$2=u$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var p$1;let n$1=p$1=class extends l$2{constructor(o){super(o),this.color=null,this.colorTexture=null,this.normalTexture=null,this.alphaMode="auto",this.alphaCutoff=.5,this.doubleSided=!0;}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(o,e){const t=r$2(o)?o.get(this):null;if(t)return t;const l=new p$1(this.clonePropertiesWithDeduplication(e));return r$2(o)&&o.set(this,l),l}clonePropertiesWithDeduplication(o){return {color:r$2(this.color)?this.color.clone():null,colorTexture:r$2(this.colorTexture)?this.colorTexture.cloneWithDeduplication(o):null,normalTexture:r$2(this.normalTexture)?this.normalTexture.cloneWithDeduplication(o):null,alphaMode:this.alphaMode,alphaCutoff:this.alphaCutoff,doubleSided:this.doubleSided}}};e([d$1({type:l$3,json:{write:!0}})],n$1.prototype,"color",void 0),e([d$1({type:m$2,json:{write:!0}})],n$1.prototype,"colorTexture",void 0),e([d$1({type:m$2,json:{write:!0}})],n$1.prototype,"normalTexture",void 0),e([d$1({nonNullable:!0,json:{write:!0}})],n$1.prototype,"alphaMode",void 0),e([d$1({nonNullable:!0,json:{write:!0}})],n$1.prototype,"alphaCutoff",void 0),e([d$1({nonNullable:!0,json:{write:!0}})],n$1.prototype,"doubleSided",void 0),n$1=p$1=e([n$3("esri.geometry.support.MeshMaterial")],n$1);const u$3=n$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var n;let u$2=n=class extends u$3{constructor(e){super(e),this.emissiveColor=null,this.emissiveTexture=null,this.occlusionTexture=null,this.metallic=1,this.roughness=1,this.metallicRoughnessTexture=null;}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(e,t){const s=r$2(e)?e.get(this):null;if(s)return s;const i=new n(this.clonePropertiesWithDeduplication(t));return r$2(e)&&e.set(this,i),i}clonePropertiesWithDeduplication(e){return {...super.clonePropertiesWithDeduplication(e),emissiveColor:r$2(this.emissiveColor)?this.emissiveColor.clone():null,emissiveTexture:r$2(this.emissiveTexture)?this.emissiveTexture.cloneWithDeduplication(e):null,occlusionTexture:r$2(this.occlusionTexture)?this.occlusionTexture.cloneWithDeduplication(e):null,metallic:this.metallic,roughness:this.roughness,metallicRoughnessTexture:r$2(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.cloneWithDeduplication(e):null}}};e([d$1({type:l$3,json:{write:!0}})],u$2.prototype,"emissiveColor",void 0),e([d$1({type:m$2,json:{write:!0}})],u$2.prototype,"emissiveTexture",void 0),e([d$1({type:m$2,json:{write:!0}})],u$2.prototype,"occlusionTexture",void 0),e([d$1({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u$2.prototype,"metallic",void 0),e([d$1({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u$2.prototype,"roughness",void 0),e([d$1({type:m$2,json:{write:!0}})],u$2.prototype,"metallicRoughnessTexture",void 0),u$2=n=e([n$3("esri.geometry.support.MeshMaterialMetallicRoughness")],u$2);const c$1=u$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var i;const l=s$1.getLogger("esri.geometry.support.MeshVertexAttributes");let p=i=class extends l$2{constructor(r){super(r),this.color=null,this.position=new Float64Array(0),this.uv=null,this.normal=null,this.tangent=null;}castColor(r){return u$1(r,Uint8Array,[Uint8ClampedArray],{loggerTag:".color=",stride:4},l)}castPosition(r){r&&r instanceof Float32Array&&l.warn(".position=","Setting position attribute from a Float32Array may cause precision problems. Consider storing data in a Float64Array or a regular number array");return u$1(r,Float64Array,[Float32Array],{loggerTag:".position=",stride:3},l)}castUv(r){return u$1(r,Float32Array,[Float64Array],{loggerTag:".uv=",stride:2},l)}castNormal(r){return u$1(r,Float32Array,[Float64Array],{loggerTag:".normal=",stride:3},l)}castTangent(r){return u$1(r,Float32Array,[Float64Array],{loggerTag:".tangent=",stride:4},l)}clone(){const r={position:m$3(this.position),uv:m$3(this.uv),normal:m$3(this.normal),tangent:m$3(this.tangent),color:m$3(this.color)};return new i(r)}clonePositional(){const r={position:m$3(this.position),normal:m$3(this.normal),tangent:m$3(this.tangent),uv:this.uv,color:this.color};return new i(r)}};function c(r,t,o,e){const{loggerTag:n,stride:s}=t;return r.length%s!=0?(e.error(n,`Invalid array length, expected a multiple of ${s}`),new o([])):r}function u$1(r,t,o,e,n){if(!r)return r;if(r instanceof t)return c(r,e,t,n);for(const s of o)if(r instanceof s)return c(new t(r),e,t,n);if(Array.isArray(r))return c(new t(r),e,t,n);{const e=o.map((r=>`'${r.name}'`));return n.error(`Failed to set property, expected one of ${e}, but got ${r.constructor.name}`),new t([])}}function g(r,t,o){t[o]=m$1(r);}function m$1(r){const t=new Array(r.length);for(let o=0;o<r.length;o++)t[o]=r[o];return t}e([d$1({json:{write:g}})],p.prototype,"color",void 0),e([s$2("color")],p.prototype,"castColor",null),e([d$1({nonNullable:!0,json:{write:g}})],p.prototype,"position",void 0),e([s$2("position")],p.prototype,"castPosition",null),e([d$1({json:{write:g}})],p.prototype,"uv",void 0),e([s$2("uv")],p.prototype,"castUv",null),e([d$1({json:{write:g}})],p.prototype,"normal",void 0),e([s$2("normal")],p.prototype,"castNormal",null),e([d$1({json:{write:g}})],p.prototype,"tangent",void 0),e([s$2("tangent")],p.prototype,"castTangent",null),p=i=e([n$3("esri.geometry.support.MeshVertexAttributes")],p);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var m;const u=s$1.getLogger("esri.geometry.support.MeshComponent");let h=m=class extends l$2{constructor(r){super(r),this.faces=null,this.material=null,this.shading="source",this.trustSourceNormals=!1;}static from(r){return v(m,r)}castFaces(r){return u$1(r,Uint32Array,[Uint16Array],{loggerTag:".faces=",stride:3},u)}castMaterial(r){return v(r&&"object"==typeof r&&("metallic"in r||"roughness"in r||"metallicRoughnessTexture"in r)?c$1:u$3,r)}clone(){return new m({faces:m$3(this.faces),shading:this.shading,material:m$3(this.material),trustSourceNormals:this.trustSourceNormals})}cloneWithDeduplication(r,t){const o={faces:m$3(this.faces),shading:this.shading,material:this.material?this.material.cloneWithDeduplication(r,t):null,trustSourceNormals:this.trustSourceNormals};return new m(o)}};e([d$1({json:{write:!0}})],h.prototype,"faces",void 0),e([s$2("faces")],h.prototype,"castFaces",null),e([d$1({type:u$3,json:{write:!0}})],h.prototype,"material",void 0),e([s$2("material")],h.prototype,"castMaterial",null),e([d$1({type:String,json:{write:!0}})],h.prototype,"shading",void 0),e([d$1({type:Boolean})],h.prototype,"trustSourceNormals",void 0),h=m=e([n$3("esri.geometry.support.MeshComponent")],h);const f=h;

export { c$1 as a, c$2 as c, f, l$1 as l, m$2 as m, o, p };
