import { H as l$9, B as t$b, e as e$6, d as d$9, n as n$j, y as y$4, as as o$f, r as r$b, L as L$3, t as t$c, aH as t$d, aI as U$5, aJ as x, c as a$f, i as i$f, s as s$e, a as s$f, G as b$1, h as e$9, I as s$h, aD as A$1, aK as C$1, T as T$2, A as v$5, X as f$6, l as a$j, O as v$6, aF as n$n, J as g$a, v as n$o, aL as h$8, aM as O$2, w as p$i, U as k$1, ak as m$c, aE as t$i, aN as n$r, ax as j$6 } from './cast-3d5be210.js';
import { u as u$9 } from './Handles-54afc0a7.js';
import { l as l$8, h as h$7, f as f$4, U as U$6, a as a$i, j as j$4, w as w$5 } from './reactiveUtils-bd6fe823.js';
import { i as i$e, O as O$1, n as n$l, f as f$5, v as v$4, w as w$4, e as e$c, t as t$f, a as t$g, r as r$c, b as e$d, o as o$l } from './jsxFactory-4cd653a4.js';
import { j as j$2, n as n$k } from './Collection-a38e0489.js';
import { c as c$i, d as d$a, a as a$k } from './HandleOwner-fe336959.js';
import { s as s$g } from './intl-54ccdc89.js';
import { J as J$1, i as i$g, e as e$b, E as E$2 } from './Feature-d7b2670c.js';
import { o as o$g } from './aliasOf-bdfe6662.js';
import './geometry-2f332a26.js';
import { g as g$9 } from './Graphic-93f45ded.js';
import { S as S$2 } from './symbols-ab3e849a.js';
import { R as R$2, j as j$3, E as E$3, k, I, p as p$j, b as R$3, M as M$4 } from './Point-edff2a11.js';
import { b as b$2 } from './Layer-569a1fc8.js';
import { a as a$g, c as c$j, b as a$h } from './ActionToggle-a5849e6f.js';
import { x as x$1 } from './symbolUtils-7f5a2832.js';
import { e as e$8, a as e$a } from './GoTo-929e809f.js';
import { n as n$m } from './utils-112c7fa0.js';
import { t as t$e } from './vmEvent-c5708c9c.js';
import { L as L$5 } from './Map-3fa127ca.js';
import { y as y$5 } from './TimeExtent-66b53603.js';
import { p as p$h } from './CollectionFlattener-9ce72729.js';
import { m as m$b } from './Portal-5df9f5a7.js';
import { m as m$a, _ as _$6 } from './Promise-d2759b2e.js';
import { m as m$8, c as c$l, a as a$l } from './GraphicsCollection-851bdafb.js';
import { M as M$1, r as r$h } from './Extent-f27111e1.js';
import { v as v$7 } from './HeightModelInfo-12951268.js';
import { c as c$k, i as i$h } from './screenUtils-31d073db.js';
import { L as L$4, Q as Q$1 } from './Scheduler-ed7a36dc.js';
import { e as e$7 } from './workers-c7a27acb.js';
import { m as m$9, o as o$h, d as o$i, q as q$1 } from './mathUtils-559a53d9.js';
import { g as g$b, h as h$9 } from './heightModelInfoUtils-4737da37.js';
import { l as l$a } from './ViewingMode-4a1cffad.js';
import { e as en, A as An, r as rn, t as tn } from './projection-fbd5d346.js';
import { u as u$a } from './Viewpoint-e3d4029a.js';
import { l as l$c } from './JSONSupport-dce2c67b.js';
import { f as f$7, e as e$e, c as c$m, i as i$i, r as r$e, M as M$2, h as h$a, n as n$q } from './mat2d-677a80fe.js';
import { s as s$j, r as r$g, M as M$3, h as h$b, i as i$j } from './mat3-eb8de168.js';
import { r as r$d, a as a$m, l as l$b, x as x$2, C as C$2, o as o$j, v as v$8, y as y$6, j as j$5, q, z as z$2, s as s$i } from './vec2-4f9a494f.js';
import { t as t$h } from './vec2f32-23e4a539.js';
import { n as n$p, r as r$f } from './vec2f64-2956001b.js';
import { z as z$1 } from './unitUtils-a0a11e54.js';
import { l as l$d } from './capabilities-cb32c85a.js';
import { o as o$k } from './context-util-5ae1bf7b.js';
import { n as n$s } from './themeUtils-b1f4a2e4.js';
import { a as a$n } from './asyncUtils-96c00c9e.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const n$i={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],a=i[1],t=this.values;return a>=s?t.portrait:t.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},o$e={xsmall:544,small:768,medium:992,large:1200};function m$7(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}function g$8(e,i){return i?n$i[e].valueToClassName[i].split(" "):[]}const w$3=w=>{let d=class extends w{constructor(...e){super(...e),this._breakpointsHandles=new u$9,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=o$e;}initialize(){this._breakpointsHandles.add(l$8((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),h$7));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=l$9(this._breakpointsHandles));}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=m$7(e);if(!i){const e=JSON.stringify(o$e,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:o$e,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=t$b.acquire(),s=t$b.acquire();let a,t=!1;for(a in n$i){const i=this[a],r=n$i[a].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==r&&(t=!0,this[a]=r,g$8(a,i).forEach((e=>s.push(e))),g$8(a,r).forEach((i=>e.push(i))));}t&&(this._applyClassNameChanges(e,s),t$b.release(e),t$b.release(s));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in n$i)g$8(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e$6([d$9()],d.prototype,"breakpoints",null),e$6([d$9()],d.prototype,"orientation",void 0),e$6([d$9()],d.prototype,"widthBreakpoint",void 0),e$6([d$9()],d.prototype,"heightBreakpoint",void 0),d=e$6([n$j("esri.views.BreakpointsOwner")],d),d};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let c$h=class extends y$4{constructor(){super(...arguments),this.items=new j$2,this._watchUpdatingTracking=new c$i,this._callbacks=new Map,this._projector=i$e(),this._hiddenProjector=i$e();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t);}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e);}}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};e$6([d$9({readOnly:!0})],c$h.prototype,"surface",void 0),e$6([d$9({readOnly:!0})],c$h.prototype,"items",void 0),e$6([d$9({readOnly:!0})],c$h.prototype,"needsRender",null),e$6([d$9({readOnly:!0})],c$h.prototype,"_watchUpdatingTracking",void 0),e$6([d$9({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$h.prototype,"updating",void 0),c$h=e$6([n$j("esri.views.overlay.ViewOverlay")],c$h);const n$h=c$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var l$7;const d$8=Symbol("anchorHandles");let m$6=class extends n$k.EventedAccessor{constructor(o){super(o),this[l$7]=new u$9,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[d$8].add([f$4((()=>o$f(this.screenLocationEnabled?this.view:null,(o=>[o.size,"3d"===o.type?o.camera:o.viewpoint]))),(()=>this.notifyChange("screenLocation"))),l$8((()=>this.screenLocation),((o,e)=>{r$b(o)&&r$b(e)&&this.emit("view-change");}))]);}destroy(){this.view=null,this[d$8]=l$9(this[d$8]);}get screenLocation(){const{location:o,view:e,screenLocationEnabled:t}=this;return t&&r$b(o)&&r$b(e)&&e.ready?e.toScreen(o):null}};l$7=d$8,e$6([d$9()],m$6.prototype,"location",void 0),e$6([d$9()],m$6.prototype,"screenLocation",null),e$6([d$9()],m$6.prototype,"screenLocationEnabled",void 0),e$6([d$9()],m$6.prototype,"view",void 0),m$6=e$6([n$j("esri.widgets.support.AnchorElementViewModel")],m$6);const h$6=m$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const t$a="esri.widgets.CompassViewModel";let p$g=class extends h$6{constructor(s){super(s),this.visible=!1;}};e$6([d$9()],p$g.prototype,"visible",void 0),p$g=e$6([n$j(t$a)],p$g);const c$g=p$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const c$f={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let h$5=class extends O$1{constructor(i,s){super(i,s),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new c$g,this.visible=!1;}initialize(){this.own([l$8((()=>this.visible),(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:s,promise:e}=i;s&&(this.viewModel.location=s),this.visible=!0;const o=()=>this.hide();e&&e.catch((()=>{})).then(o);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:s}=this.viewModel,e=!!s,o=i&&e,t=!i&&e,r={[c$f.spinnerStart]:o,[c$f.spinnerFinish]:t},n=this._getPositionStyles();return n$l("div",{class:this.classes(c$f.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const s=L$3(this._animationDelay);this._animationPromise=s,s.catch((()=>{})).then((()=>{this._animationPromise===s&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:e}=this.viewModel;if(t$c(e)||t$c(i))return {};const{padding:o}=e;return {left:i.x-o.left+"px",top:i.y-o.top+"px"}}};e$6([o$g("viewModel.location")],h$5.prototype,"location",void 0),e$6([o$g("viewModel.view")],h$5.prototype,"view",void 0),e$6([d$9({type:c$g})],h$5.prototype,"viewModel",void 0),e$6([o$g("viewModel.visible")],h$5.prototype,"visible",void 0),h$5=e$6([n$j("esri.widgets.Spinner")],h$5);const m$5=h$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class o$d{constructor(r,o){this.owner=o,this.properties={},this.afterDispatchHandle=null;for(const t in r){const o=r[t],s=new t$d(o,null,null,2,2);this.properties[t]={pool:s,acquired:[]};}this.afterDispatchHandle=U$5((()=>this._release()));}destroy(){this.afterDispatchHandle&&(this.afterDispatchHandle.remove(),this.afterDispatchHandle=null);for(const e in this.properties){const t=this.properties[e];for(const e of t.acquired)x(e)||t.pool.release(e);t.pool.destroy(),t.pool=null,t.acquired=null;}this.properties=null,this.owner=null;}get(e){const t=this.owner._get(e),r=this.properties[e];let o=r.pool.acquire();for(r.acquired.push(o);o===t;)r.acquired.push(o),o=r.pool.acquire();return o}_release(){for(const e in this.properties){const t=this.properties[e];let o=0;for(const e of t.acquired)x(e)?t.acquired[o++]=e:t.pool.release(e);t.acquired.length=o;}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const t$9=a$f("mac")?"Meta":"Ctrl",o$c={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let s=48;s<58;s++)o$c[s]=String.fromCharCode(s);for(let s=1;s<25;s++)o$c[111+s]=`F${s}`;for(let s=65;s<91;s++)o$c[s]=[String.fromCharCode(s+32),String.fromCharCode(s)];function a$e(e){if(void 0!==e.key)return i$f(e);const t=o$c[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function n$g(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e$5{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const n$f=s$e.getLogger("esri.views.input.InputHandler");class i$d{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$f.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e?new e$5(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$d(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&!t.includes(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$d(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$f.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$d{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$d{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class s$c extends i$d{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(t=>{const s="touch"===t.data.native.pointerType;this._setValue(s?"touch":"mouse",t.data.x,t.data.y);}));}_setValue(t,s,e){t===this._value&&this._x===s&&this._y===e||(this._value=t,this._x=s,this._y=e,this._onChange(t,s,e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const d$7=s$e.getLogger("esri.views.input.InputManager");let c$e=class extends y$4{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$9,this.latestPointerType="mouse",this._propertiesPool=new o$d({latestPointerLocation:P$1},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null,this._propertiesPool.destroy();}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=g$7.INTERNAL){if(this._nameToGroup[e])return void d$7.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void d$7.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let n=i.handlers.length-1;n>=0;n--){const e=i.handlers[n];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(t,r,i,n,s)=>{this._emitInputEvent(e.priorityIndex+1,t,r,i,s,n);},setPointerCapture:(t,r)=>{this._setPointerCapture(i,e,t,r);},setEventCallback:t=>{e.eventCallback=t;},setUninstallCallback:t=>{e.uninstallCallback=t;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):d$7.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const e=this._handlers[r];e.priorityIndex=r,this._handlersPriority.push(e);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$g(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointer(e,t,r){this._get("latestPointerType")!==e&&this._set("latestPointerType",e);const n=this._get("latestPointerLocation");if(t$c(n)||n.x!==t||n.y!==r){const e=this._propertiesPool.get("latestPointerLocation");e.x=t,e.y=r,this._set("latestPointerLocation",e);}}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerHandler=new s$c(((e,t,r)=>this._setLatestPointer(e,t,r))),this.installHandlers("input-manager-logic",[this._latestPointerHandler],g$7.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,g$7.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new u$8(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new e$7,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies();}}_pausePropagation(e){const t=new e$7;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>e.keyModifiers.includes(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};e$6([d$9({readOnly:!0})],c$e.prototype,"hasPendingInputs",null),e$6([d$9()],c$e.prototype,"eventSource",void 0),e$6([d$9()],c$e.prototype,"recognizers",void 0),e$6([d$9({readOnly:!0})],c$e.prototype,"latestPointerType",void 0),e$6([d$9({readOnly:!0})],c$e.prototype,"latestPointerLocation",void 0),c$e=e$6([n$j("esri.views.input.InputManager")],c$e);class u$8{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=_$5.NONE,this._resumeCallback=null;}stopPropagation(){this._propagationState|=_$5.STOPPED;}shouldStopPropagation(){return 0!=(this._propagationState&_$5.STOPPED)}async(e){this._propagationState|=_$5.PAUSED;const t=(e,t)=>{this._propagationState&=~_$5.PAUSED;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(this._propagationState&_$5.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}var _$5;!function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED";}(_$5||(_$5={}));const g$7={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};class P$1{}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const s$b={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},o$b=new a$g({id:"zoom-to-feature",title:"{messages.zoom}",className:s$b.iconZoom}),t$8=new a$g({id:"remove-selected-feature",title:"{messages.remove}",className:s$b.iconTrash}),r$a=new a$g({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:s$b.iconZoom}),i$c=new a$g({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:s$b.iconBrowseClusteredFeatures}),a$c=[o$b,t$8,i$c,r$a];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const s$a="esri.widgets.Popup.PopupViewModel",c$d=s$e.getLogger(s$a),u$7=t=>{const{event:s,view:c}=t,{action:u}=s,d=c&&c.popup;if(!u)return Promise.reject(new s$f("trigger-action:missing-arguments","Event has no action"));if(!d)return Promise.reject(new s$f("trigger-action:missing-arguments","view.popup is missing"));const{disabled:l,id:g}=u;if(!g)return Promise.reject(new s$f("trigger-action:invalid-action","action.id is missing"));if(l)return Promise.reject(new s$f("trigger-action:invalid-action","Action is disabled"));if(g===o$b.id)return w$2(d.viewModel).catch(b$1);if(g===r$a.id)return p$f(d.viewModel);if(g===i$c.id)return d.featureMenuOpen=!d.featureMenuOpen,d.viewModel.browseClusterEnabled=!d.viewModel.browseClusterEnabled,Promise.resolve();if(d.viewModel.browseClusterEnabled=!1,g===t$8.id){d.close();const{selectedFeature:t}=d;if(!t)return Promise.reject(new s$f(`trigger-action:${t$8.id}`,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:r}=t;return r?r.remove(t):c.graphics.remove(t),Promise.resolve()}return Promise.resolve()};function d$6(e){const{selectedFeature:t,location:r,view:o}=e;if(!o)return null;if("3d"===o.type)return t||r;return e.get("selectedFeature.geometry")||r}function l$6(e){return e?.isAggregate&&"cluster"===e?.sourceLayer?.featureReduction?.type}function g$6(t,r){if("3d"!==r?.type||!t||"esri.Graphic"!==t.declaredClass)return !0;const o=r.getViewForGraphic(t);if(o&&"whenGraphicBounds"in o){let r=!1;return o.whenGraphicBounds(t,{useViewElevation:!0}).then((e=>{r=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const r=new s$f("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});c$d.error(r);})),r}return !0}async function w$2(t){const{location:r,selectedFeature:i,view:n,zoomFactor:a}=t,s=d$6(t);if(!s){const t=new s$f("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:n});throw c$d.error(t),t}const u=n.scale/a,l=t.get("selectedFeature.geometry")||r,w=l&&"point"===l.type&&g$6(i,n);o$b.active=!0,o$b.disabled=!0;try{await t.view.goTo({target:s,scale:w?u:void 0});}finally{o$b.active=!1,o$b.disabled=!1,t.zoomToLocation=null,w&&(t.location=l);}}async function p$f(t){const{selectedFeature:r,view:o}=t;if("2d"!==o?.type){const t=new s$f("zoomToCluster:invalid-view","View must be 2d MapView.",{view:o});throw c$d.error(t),t}if(!l$6(r)){const t=new s$f("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw c$d.error(t),t}const n=r.sourceLayer,a=await o.whenLayerView(n),s=a.createQuery();s.aggregateIds=[r.getObjectId()],r$a.active=!0,r$a.disabled=!0;const{extent:u}=await a.queryExtent(s);await o.goTo({target:u}),r$a.active=!1,r$a.disabled=!1;}async function f$3(e){const{selectedFeature:t,view:r}=e,o=t.sourceLayer,i=await r.whenLayerView(o),n=i.createQuery();n.aggregateIds=[t.getObjectId()];const{extent:a}=await i.queryExtent(n);e.selectedClusterBoundaryFeature.geometry=a,r.graphics.add(e.selectedClusterBoundaryFeature);}async function v$3(e){const{selectedFeature:t,view:r}=e,o=t.sourceLayer,i=await r.whenLayerView(o),a=i.createQuery();a.aggregateIds=[t.getObjectId()],i$c.active=!0,i$c.disabled=!0;const{features:s}=await i.queryFeatures(a);i$c.active=!1,i$c.disabled=!1,r.popup.open({features:[t].concat(s),featureMenuOpen:!0});}function m$4(e){const t=e.features.filter((e=>l$6(e)));t.length&&(e.features=t);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const S$1=j$2.ofType({key:"type",defaultKeyValue:"button",base:c$j,typeMap:{button:a$g,toggle:a$h}}),B$2=()=>[o$b.clone()],R$1=()=>[r$a.clone(),i$c.clone()],G$2="esri.widgets.Popup.PopupViewModel",z=s$e.getLogger(G$2);let H$1=class extends(e$8(h$6)){constructor(e){super(e),this._handles=new u$9,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new S$1,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new g$9({symbol:new S$2({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null;}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([l$8((()=>[this.autoOpenEnabled,this.view]),(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),l$8((()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view]),(()=>this._highlightSelectedFeature())),l$8((()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view]),(()=>this._highlightActiveFeature())),l$8((()=>this.view?.animation?.state),(e=>this._animationStateChange(e))),l$8((()=>this.location),(e=>this._locationChange(e))),l$8((()=>this.selectedFeature),(e=>this._selectedFeatureChange(e))),l$8((()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage]),(()=>this._selectedFeatureIndexChange())),l$8((()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels]),(()=>this._setGraphicOnFeatureViewModels())),l$8((()=>this.featureViewModels),(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>u$7({event:e,view:this.view}))),f$4((()=>!this.waitingForResult),(()=>this._waitingForResultChange()),U$6),l$8((()=>[this.features,this.view?.map,this.view?.spatialReference]),(()=>this._updateFeatureVMs())),l$8((()=>this.view?.scale),(()=>this._viewScaleChange())),f$4((()=>!this.visible),(()=>this.browseClusterEnabled=!1)),l$8((()=>this.browseClusterEnabled),(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new S$1;e.removeAll();const{actions:t,defaultActions:i,defaultPopupTemplateEnabled:s,includeDefaultActions:r,selectedFeature:o}=this,n=r?i.concat(t):t,a=o&&("function"==typeof o.getEffectivePopupTemplate&&o.getEffectivePopupTemplate(s)||o.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){const e=this._get("defaultActions")||new S$1;return e.removeAll(),e.addMany(l$6(this.selectedFeature)?R$1():B$2()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:i,promiseCount:s,selectedFeatureIndex:r}=this,o=s&&t.length;o&&i&&-1===r?this.selectedFeatureIndex=0:o&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=R$2(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);},i=()=>this._updatePendingPromises(e);e.then(t,i);})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=d$6(this);if(!t){const i=new s$f("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return z.error(i),Promise.reject(i)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null});}fetchFeatures(e,t){const{view:i}=this;if(!i||!e){const t=new s$f("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return z.error(t),Promise.reject(t)}return i.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:i}=t;delete t.fetchFeatures,i&&this._setFetchFeaturesPromises(t.location);const s=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const r of s)delete t[r];this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){m$4(this),this._clearBrowsedClusterGraphics();}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;"2d"===e?.type?l$6(t)?(await f$3(this),await v$3(this)):z.warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):z.warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t);}_animationStateChange(e){this.zoomToLocation||(o$b.disabled="waiting-for-target"===e);}_clearBrowsedClusterGraphics(){const e=this.view?.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null;}_viewScaleChange(){if(l$6(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature]);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:i}=this;i&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null;}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null;}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:i,featuresPerPage:s,featureViewModels:r}=this;if(null===i)return;const o=((i-1)*s+t)%t,n=o+s;r.slice(o,n).forEach(((t,i)=>{t&&!t.graphic&&(t.graphic=e[o+i]);}));}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:i,view:s}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(s.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),l$6(e))return;return e.symbol=await x$1(e),this._selectedClusterFeature=e,void s.graphics.add(this._selectedClusterFeature)}!i&&t||!e.geometry?i&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=s.center.clone();})):this.location=e$9(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:i}=e,s=Promise.resolve(t),r=i.map((e=>e.promise));this.promises=[s,...r];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:i}=this;if(l$6(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const s=i.slice(0),r=[];t.forEach(((t,i)=>{if(!t)return;let o=null;if(s.some(((e,i)=>(e&&e.graphic===t&&(o=e,s.splice(i,1)),!!o))),o)r[i]=o;else {const s=new J$1({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:this.view?.spatialReference,graphic:t===e?t:null,map:this.view?.map,view:this.view});r[i]=s;}})),s.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",r);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:i}=this;if(t.remove(e),i&&this.view){const i=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),g$7.WIDGET);t.add(i,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const i=new AbortController,{signal:s}=i;this._fetchFeaturesController=i,this.notifyChange("waitingForResult");const r=this.fetchFeatures(e,{signal:s,event:t});return r.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),r}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:i}=e,{view:s}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:r,location:o}=e,n=[Promise.resolve(t),...r.map((e=>e.promise))];return s.popup.open({location:o||i,promises:n}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_getPointFromGeometry(e){return t$c(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:i}=e;return "map-notes"===i?.type||"subtype-group"===i?.type?i:t}_getHighlightTarget(e,t){const i="imagery"===t.type?void 0:"objectIdField"in t&&t.objectIdField,s=e.attributes;return s&&i&&s[i]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:i,activeFeature:s,visible:r}=this;if(!(s&&i&&t&&r))return;const o=this._getHighlightLayer(s);if(!(o&&o instanceof b$2))return;const n=this._getLayerView(i,o);this._highlightActiveFeaturePromise=n;const a=await n;if(!(a&&e$a(a)&&this._highlightActiveFeaturePromise===n&&this.activeFeature&&this.highlightEnabled))return;const l=a.highlight(this._getHighlightTarget(s,o));this._handles.add(l,e);}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:i,view:s,visible:r}=this;if(!(t&&s&&i&&r))return;const o=this._getHighlightLayer(t);if(!(o&&o instanceof b$2))return;const n=this._getLayerView(s,o);this._highlightSelectedFeaturePromise=n;const a=await n;if(!(a&&e$a(a)&&this._highlightSelectedFeaturePromise===n&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const l=a.highlight(this._getHighlightTarget(t,o));this._handles.add(l,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const i=e.filter((e=>!t.includes(e)));this.features=t.concat(i);}};e$6([d$9()],H$1.prototype,"featurePage",void 0),e$6([d$9()],H$1.prototype,"isLoadingFeature",null),e$6([d$9({type:S$1})],H$1.prototype,"actions",void 0),e$6([d$9({readOnly:!0})],H$1.prototype,"active",null),e$6([d$9()],H$1.prototype,"activeFeature",void 0),e$6([d$9({readOnly:!0})],H$1.prototype,"allActions",null),e$6([d$9({type:Boolean})],H$1.prototype,"defaultPopupTemplateEnabled",void 0),e$6([d$9()],H$1.prototype,"autoCloseEnabled",void 0),e$6([d$9()],H$1.prototype,"autoOpenEnabled",void 0),e$6([d$9()],H$1.prototype,"browseClusterEnabled",void 0),e$6([d$9()],H$1.prototype,"content",void 0),e$6([d$9({type:S$1,readOnly:!0})],H$1.prototype,"defaultActions",null),e$6([d$9({readOnly:!0})],H$1.prototype,"featureCount",null),e$6([d$9()],H$1.prototype,"features",null),e$6([d$9()],H$1.prototype,"featuresPerPage",void 0),e$6([d$9()],H$1.prototype,"featureViewModelAbilities",void 0),e$6([d$9({readOnly:!0})],H$1.prototype,"featureViewModels",void 0),e$6([d$9()],H$1.prototype,"highlightEnabled",void 0),e$6([d$9()],H$1.prototype,"includeDefaultActions",void 0),e$6([d$9({type:j$3})],H$1.prototype,"location",null),e$6([d$9({readOnly:!0})],H$1.prototype,"pendingPromisesCount",null),e$6([d$9({readOnly:!0})],H$1.prototype,"selectedClusterBoundaryFeature",void 0),e$6([d$9({readOnly:!0})],H$1.prototype,"waitingForResult",null),e$6([d$9({readOnly:!0})],H$1.prototype,"promiseCount",null),e$6([d$9()],H$1.prototype,"promises",null),e$6([d$9({value:null,readOnly:!0})],H$1.prototype,"selectedFeature",null),e$6([d$9({value:-1})],H$1.prototype,"selectedFeatureIndex",null),e$6([d$9({readOnly:!0})],H$1.prototype,"selectedFeatureViewModel",null),e$6([d$9({readOnly:!0})],H$1.prototype,"state",null),e$6([d$9()],H$1.prototype,"title",void 0),e$6([d$9()],H$1.prototype,"updateLocationEnabled",void 0),e$6([d$9()],H$1.prototype,"view",void 0),e$6([d$9()],H$1.prototype,"visible",void 0),e$6([d$9()],H$1.prototype,"zoomFactor",void 0),e$6([d$9()],H$1.prototype,"zoomToLocation",void 0),e$6([d$9()],H$1.prototype,"centerAtLocation",null),H$1=e$6([n$j(G$2)],H$1);const U$4=H$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const N="selected-index",T$1=0,B$1="popup-spinner",D$1={iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button"},E$1={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},P="esri-popup";function L$2(e,t){return void 0===t?`${P}__${e}`:`${P}__${e}-${t}`}const S="esri.widgets.Popup",V$2=s$e.getLogger(S),U$3={closeButton:!0,featureNavigation:!0};let R=class extends(i$g(O$1)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new u$9,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{e?.isIntersecting&&this.viewModel.featurePage++;},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=e$b((()=>this._displaySpinner()),T$1),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new U$4,this.visible=null,this.visibleElements={...U$3},this._addSelectedFeatureIndexHandle(),this.own([l$8((()=>this.viewModel?.screenLocation),(()=>this._positionContainer())),l$8((()=>[this.viewModel?.active,this.dockEnabled]),(()=>this._toggleScreenLocationEnabled())),l$8((()=>this.viewModel?.screenLocation),((e,t)=>{!!e!=!!t&&this.reposition();})),l$8((()=>[this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment]),(()=>this.reposition())),l$8((()=>this.spinnerEnabled),(e=>this._spinnerEnabledChange(e))),l$8((()=>this.viewModel?.view?.size),((e,t)=>this._updateDockEnabledForViewSize(e,t))),l$8((()=>this.viewModel?.view),((e,t)=>this._viewChange(e,t))),l$8((()=>this.viewModel?.view?.ready),((e,t)=>this._viewReadyChange(e,t))),l$8((()=>[this.viewModel?.waitingForResult,this.viewModel?.location]),(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),l$8((()=>[this.selectedFeatureWidget?.viewModel?.title,this.selectedFeatureWidget?.viewModel?.state]),(()=>this._setTitleFromFeatureWidget())),l$8((()=>[this.selectedFeatureWidget?.viewModel?.content,this.selectedFeatureWidget?.viewModel?.state]),(()=>this._setContentFromFeatureWidget())),f$4((()=>!this.collapsed),(()=>{"xsmall"===this.viewModel?.view?.widthBreakpoint&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),a$i((()=>this.viewModel?.allActions),"change",(()=>this._watchActions())),l$8((()=>this.viewModel?.allActions),(()=>this._watchActions()),h$7),l$8((()=>this.viewModel?.featureViewModels),(()=>this._featureMenuViewportScrollTop()))]);}destroy(){this._destroySelectedFeatureWidget(),this._destroySpinner(),this._handles?.destroy(),this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver?.disconnect(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){return !!(this.selectedFeatureWidget?this.selectedFeatureWidget?.viewModel?.waitingForContent||"error"===this.selectedFeatureWidget?.viewModel?.state||this.selectedFeatureWidget?.viewModel?.content:this.viewModel?.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||E$1}set dockOptions(e){const t={...E$1},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:i}=this,{selectedFeatureViewModel:o}=this.viewModel,n={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=n):this._feature=new E$2({headingLevel:i+1,viewModel:o,visibleElements:n}),this._feature):null}castVisibleElements(e){return {...U$3,...e}}blur(){const{active:e}=this.viewModel;e||V$2.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||V$2.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){this._handles.remove(N);const t=!!e&&!!e.featureMenuOpen,i=!!e&&!!e.actionsMenuOpen,o={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:i,featureMenuOpen:t};"xsmall"===this.viewModel?.view?.widthBreakpoint&&(o.collapsed=!0),this.set(o),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:i,dividedActions:o,currentAlignment:n,currentDockPosition:s}=this,{active:r}=this.viewModel,{menuActions:a}=o,l=r&&a.length>1&&e,u=r&&t,c=r&&!t,d=this.selectedFeature?.layer?.title,p=this.selectedFeature?.layer?.id,h={[D$1.alignTopCenter]:"top-center"===n,[D$1.alignBottomCenter]:"bottom-center"===n,[D$1.alignTopLeft]:"top-left"===n,[D$1.alignBottomLeft]:"bottom-left"===n,[D$1.alignTopRight]:"top-right"===n,[D$1.alignBottomRight]:"bottom-right"===n,[D$1.isDocked]:u,[D$1.shadow]:c,[D$1.isDockedTopLeft]:"top-left"===s,[D$1.isDockedTopCenter]:"top-center"===s,[D$1.isDockedTopRight]:"top-right"===s,[D$1.isDockedBottomLeft]:"bottom-left"===s,[D$1.isDockedBottomCenter]:"bottom-center"===s,[D$1.isDockedBottomRight]:"bottom-right"===s,[D$1.isFeatureMenuOpen]:i,[D$1.isActionsMenuOpen]:l};return n$l("div",{class:this.classes(D$1.base,h),role:"presentation","data-layer-title":d,"data-layer-id":p,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},r?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return n$l("span",{"aria-hidden":"true",class:this.classes(D$1.icon,D$1.iconLoading,D$1.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?n$l("div",{key:L$2("loading-container"),role:"presentation",class:D$1.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=f$5(this.container),t={[D$1.iconRightTriangleArrow]:e,[D$1.paginationPreviousIconRTL]:e,[D$1.iconLeftTriangleArrow]:!e,[D$1.paginationPreviousIconLTR]:!e};return n$l("span",{"aria-hidden":"true",class:this.classes(D$1.icon,t)})}renderPreviousButton(){const{messages:e}=this;return n$l("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(D$1.button,D$1.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=f$5(this.container),t={[D$1.iconLeftTriangleArrow]:e,[D$1.paginationNextIconRTL]:e,[D$1.iconRightTriangleArrow]:!e,[D$1.paginationNextIconLTR]:!e};return n$l("span",{"aria-hidden":"true",class:this.classes(D$1.icon,t)})}renderNextButton(){const{messages:e}=this;return n$l("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(D$1.button,D$1.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return n$l("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(D$1.button,D$1.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[D$1.iconUndock]:e,[D$1.iconDock]:!e,[D$1.iconDockToRight]:!e&&("top-right"===t||"bottom-right"===t),[D$1.iconDockToLeft]:!e&&("top-left"===t||"bottom-left"===t),[D$1.iconDockToTop]:!e&&"top-center"===t,[D$1.iconDockToBottom]:!e&&"bottom-center"===t};return n$l("span",{"aria-hidden":"true",class:this.classes(i,D$1.icon)})}renderDockButton(){const{dockEnabled:e,messages:t}=this,i=this.viewModel?.view?.widthBreakpoint,o=e?t.undock:t.dock;return "xsmall"!==i&&this.dockOptions?.buttonEnabled?n$l("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(D$1.button,D$1.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[D$1.headerContainerButton]:i},r=n$l(n$m,{level:this.headingLevel,class:D$1.headerTitle,innerHTML:e}),a=i?n$l("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(D$1.headerContainer,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed,type:"button"},r):n$l("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(D$1.headerContainer,s)},r);return e?a:null}renderCloseIcon(){return n$l("span",{"aria-hidden":"true",class:this.classes(D$1.icon,D$1.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?n$l("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:D$1.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return n$l("header",{class:D$1.header},this.renderTitle(),n$l("div",{class:D$1.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?n$l("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:D$1.content},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?n$l("div",{key:L$2("actions-menu-button"),class:this.classes(D$1.button,D$1.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},n$l("span",{"aria-hidden":"true",class:D$1.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n}=o;return n.length&&i?n$l("ul",{id:e,role:"menu","aria-labelledby":t,key:L$2("actions"),class:D$1.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map((e=>this.renderAction({action:e,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map((e=>this.renderAction({action:e,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?n$l("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:D$1.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?n$l("section",{key:L$2("navigation"),class:this.classes(D$1.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[D$1.footerHasPagination]:e,[D$1.footerHasActions]:n,[D$1.footerHasActionsMenu]:s};return e||n?n$l("div",{key:L$2("feature-buttons"),class:this.classes(D$1.footer,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,o=s$g(e.selectedFeatures,{total:t.length});return n$l("section",{key:L$2("menu"),class:D$1.featureMenu},n$l("strong",{class:D$1.featureMenuHeader},o),n$l("nav",{bind:this,class:D$1.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:v$4},this.renderFeatureMenu(),n$l("div",{class:D$1.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?n$l("div",{class:D$1.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:n$l("div",{key:L$2("pointer"),class:D$1.pointer,role:"presentation"},n$l("div",{class:this.classes(D$1.pointerDirection,D$1.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[D$1.shadow]:e,[D$1.isCollapsible]:s,[D$1.isCollapsed]:a};return n$l("div",{class:this.classes(D$1.main,D$1.widget,p),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){const e=this.viewModel?.content;return e?"string"==typeof e?n$l("div",{key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return n$l("span",{key:"text",class:D$1.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[D$1.iconLoading]:e.active,[D$1.rotating]:e.active,[D$1.icon]:!!t,[D$1.actionImage]:!e.active&&!!i};return t&&(o[t]=!e.active),n$l("span",{key:"icon","aria-hidden":"true",class:this.classes(D$1.icon,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,type:i}=e,o=this._getActionTitle(t),n={[D$1.action]:"toggle"!==t.type,[D$1.actionToggle]:"toggle"===t.type,[D$1.actionToggleOn]:"toggle"===t.type&&t.value,[D$1.buttonDisabled]:t.disabled},s=[this.renderActionIcon(t),this.renderActionText(o)],r="menu-item"===i?n$l("li",{key:t.uid,role:"menuitem",tabIndex:0,title:o,"aria-label":o,class:this.classes(D$1.button,n),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s):n$l("div",{key:t.uid,role:"button",tabIndex:0,title:o,"aria-label":o,class:this.classes(D$1.button,n),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s);return t.visible?r:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,a={[D$1.featureMenuSelected]:r},l=r?n$l("span",{key:L$2(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:D$1.iconCheckMark}):null,u=n$l("span",{innerHTML:e.title||o.untitled});return n$l("li",{role:"menuitem",tabIndex:-1,key:L$2(`feature-menu-feature-${n}`),class:this.classes(a,D$1.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},n$l("span",{class:D$1.featureMenuTitle},u,l))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?n$l("ol",{class:D$1.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=i?.attributes,r="zoom-to-feature"===n?s$g(e.title,{messages:t}):"remove-selected-feature"===n?s$g(e.title,{messages:o}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?s$g(e.title,{messages:t}):e.title;return r&&s?s$g(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=t?.attributes,{className:o,image:n}=e,s=n||o?o:D$1.iconDefaultAction;return s&&i?s$g(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=t?.attributes,{image:o}=e;return o&&i?s$g(o,i):o}_createFeatureUpdatedAnimation(){return w$4("enter",D$1.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(l$8((()=>[e.uid,e.active,e.className,e.disabled,e.id,e.title,e.image,e.visible]),(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,i=e.filter((e=>e.visible)),o=this._getInlineActionCount(),n=null===o,s=0===o;return {inlineActions:n?i.slice(0):s?new j$2:i.slice(0,o),menuActions:n?new j$2:s?i.slice(0):i.slice(o)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title="error"===e.viewModel?.state?t.errorMessage:e.viewModel?.title||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e;}_handleFeatureMenuKeyup(e){"Escape"===i$f(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===i$f(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_setActiveFeature(e){const{viewModel:t}=this,i=e.currentTarget["data-feature-index"];t.activeFeature=t.features[i]||null;}_removeActiveFeature(){this.viewModel.activeFeature=null;}_handleFeatureMenuItemKeyup(e){const t=i$f(e),{_featureMenuNode:o}=this,n=e.currentTarget["data-feature-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleActionMenuItemKeyup(e){const t=i$f(e),{_actionsMenuNode:o}=this,n=e.currentTarget.dataset.actionUid,{menuActions:s}=this.dividedActions,r=s.findIndex((e=>e.uid===n));if(!o)return;const a=o.querySelectorAll("li"),l=a.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();a[a.length-1].focus();}else {e.stopPropagation();a[0].focus();}else {e.stopPropagation();a[(r+1+l)%l].focus();}else {e.stopPropagation();a[(r-1+l)%l].focus();}}_handleMainKeyup(e){const t=i$f(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await j$4((()=>!0===this.viewModel?.active)),this.focus());}_addSelectedFeatureIndexHandle(){const e=l$8((()=>this.viewModel?.selectedFeatureIndex),((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,N);}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:r,view:a}=n;if(t$c(r)||!a||!i)return "top-center";if(!this._isScreenLocationWithinView(r,a))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const u=o?window.getComputedStyle(o,null):null,c=u?l(u.getPropertyValue("max-height")):0,d=u?l(u.getPropertyValue("height")):0,{height:p,width:h}=i.getBoundingClientRect(),g=h+t,_=Math.max(p,c,d)+t,f=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"right",view:a}),v=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"left",view:a}),m=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"top",view:a}),b=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"bottom",view:a});return v?m?"bottom-right":"top-right":f?m?"bottom-left":"top-left":m?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return f$5(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){if("auto"!==e)return e;const t=this.viewModel?.view,i=f$5(this.container)?"top-left":"top-right";if(!t)return i;const o=t.padding||{left:0,right:0,top:0,bottom:0},n=t.width-o.left-o.right,{breakpoints:s}=t;return s&&n<=s.xsmall?"bottom-center":i}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,a=i.height-t,l=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:a+s-u.bottom,right:l+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:l+s-u.right}:"top-right"===n?{bottom:a+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:a+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return {left:"",top:"",right:"",bottom:""};if(t$c(e)||!t)return;const n=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,o,n);return r?{top:void 0!==r.top?`${r.top}px`:"auto",left:void 0!==r.left?`${r.left}px`:"auto",bottom:void 0!==r.bottom?`${r.bottom}px`:"auto",right:void 0!==r.right?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:a,height:l}=i;return o<=a&&s>a||o>a&&s<=a||n<=l&&r>l||n>l&&r<=l}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:a}=this,l=a.breakpoint;this._dockingThresholdCrossed(s,r,l)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){const t=e.breakpoint,i=this.viewModel?.view?.ui;if(!i)return !1;const{width:o,height:n}=i;if(isNaN(o)||isNaN(n))return !1;const s=t.hasOwnProperty("width")&&o<=t.width,r=t.hasOwnProperty("height")&&n<=t.height;return s||r}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?s$g(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,B$1),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new m$5({view:e}),e.ui.add(this._spinner,{key:B$1,position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:i}=this.viewModel,o=i.findIndex((e=>e.uid===t)),n=i.getItemAt(o);n&&"toggle"===n.type&&(n.value=!n.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(o);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};e$6([d$9({readOnly:!0})],R.prototype,"actionsMenuId",null),e$6([d$9({readOnly:!0})],R.prototype,"actionsMenuButtonId",null),e$6([d$9({readOnly:!0})],R.prototype,"featureMenuId",null),e$6([d$9({readOnly:!0})],R.prototype,"titleId",null),e$6([d$9({readOnly:!0})],R.prototype,"contentId",null),e$6([d$9({readOnly:!0})],R.prototype,"hasContent",null),e$6([d$9({readOnly:!0})],R.prototype,"featureNavigationVisible",null),e$6([d$9({readOnly:!0})],R.prototype,"collapsible",null),e$6([d$9({readOnly:!0})],R.prototype,"featureMenuVisible",null),e$6([d$9({readOnly:!0})],R.prototype,"contentCollapsed",null),e$6([d$9({readOnly:!0})],R.prototype,"dividedActions",null),e$6([o$g("viewModel.actions")],R.prototype,"actions",void 0),e$6([d$9()],R.prototype,"actionsMenuOpen",null),e$6([d$9()],R.prototype,"alignment",void 0),e$6([o$g("viewModel.autoCloseEnabled")],R.prototype,"autoCloseEnabled",void 0),e$6([o$g("viewModel.autoOpenEnabled")],R.prototype,"autoOpenEnabled",void 0),e$6([o$g("viewModel.defaultPopupTemplateEnabled")],R.prototype,"defaultPopupTemplateEnabled",void 0),e$6([o$g("viewModel.content")],R.prototype,"content",void 0),e$6([d$9()],R.prototype,"collapsed",void 0),e$6([d$9()],R.prototype,"collapseEnabled",void 0),e$6([d$9({readOnly:!0})],R.prototype,"currentAlignment",null),e$6([d$9({readOnly:!0})],R.prototype,"currentDockPosition",null),e$6([d$9()],R.prototype,"dockOptions",null),e$6([d$9()],R.prototype,"dockEnabled",void 0),e$6([o$g("viewModel.featureCount")],R.prototype,"featureCount",void 0),e$6([d$9()],R.prototype,"featureMenuOpen",void 0),e$6([o$g("viewModel.features")],R.prototype,"features",void 0),e$6([o$g("viewModel.goToOverride")],R.prototype,"goToOverride",void 0),e$6([d$9()],R.prototype,"headingLevel",void 0),e$6([o$g("viewModel.highlightEnabled")],R.prototype,"highlightEnabled",void 0),e$6([o$g("viewModel.location")],R.prototype,"location",void 0),e$6([d$9({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),e$6([d$9()],R.prototype,"maxInlineActions",void 0),e$6([d$9(),e$c("esri/widgets/Popup/t9n/Popup")],R.prototype,"messages",void 0),e$6([d$9(),e$c("esri/t9n/common")],R.prototype,"messagesCommon",void 0),e$6([o$g("viewModel.promises")],R.prototype,"promises",void 0),e$6([o$g("viewModel.selectedFeature")],R.prototype,"selectedFeature",void 0),e$6([o$g("viewModel.selectedFeatureIndex")],R.prototype,"selectedFeatureIndex",void 0),e$6([d$9({readOnly:!0})],R.prototype,"selectedFeatureWidget",null),e$6([d$9()],R.prototype,"spinnerEnabled",void 0),e$6([o$g("viewModel.title")],R.prototype,"title",void 0),e$6([o$g("viewModel.updateLocationEnabled")],R.prototype,"updateLocationEnabled",void 0),e$6([o$g("viewModel.view")],R.prototype,"view",void 0),e$6([d$9({type:U$4}),t$e(["triggerAction","trigger-action"])],R.prototype,"viewModel",void 0),e$6([o$g("viewModel.visible")],R.prototype,"visible",void 0),e$6([d$9()],R.prototype,"visibleElements",void 0),e$6([s$h("visibleElements")],R.prototype,"castVisibleElements",null),e$6([t$f()],R.prototype,"_close",null),e$6([t$f()],R.prototype,"_toggleDockEnabled",null),e$6([t$f()],R.prototype,"_toggleFeatureMenu",null),e$6([t$f()],R.prototype,"_toggleActionsMenu",null),e$6([t$f()],R.prototype,"_triggerAction",null),e$6([t$f()],R.prototype,"_selectFeature",null),e$6([t$f()],R.prototype,"_next",null),e$6([t$f()],R.prototype,"_previous",null),R=e$6([n$j(S)],R);const j$1=R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const l$5=[0,0];function p$e(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return l$5[0]=s.left+t.pageXOffset,l$5[1]=s.top+t.pageYOffset,l$5}function c$c(e){e&&(t$g(e),e.parentNode&&e.parentNode.removeChild(e));}function m$3(e){const t=document.createElement("div");return e.appendChild(t),t}const f$2=16,y$3=750,v$2=512,_$4=2,g$5=i=>{let l=class extends i{constructor(...e){super(...e),this._freqInfo={freq:f$2,time:y$3},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([l$8((()=>this.cursor),(e=>{const{surface:t}=this;t&&t.setAttribute("data-cursor",e);})),l$8((()=>this.interacting),(e=>{const{surface:t}=this;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(l$8((()=>this.ui),((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const s=this._get("container");if(s===e)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),c$c(this.root),this._set("root",null),r$c(this.userContent,s),c$c(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",r$c(e,s),e.appendChild(s),this._set("userContent",s);const h=document.createElement("div");h.className="esri-view-root",e.insertBefore(h,e.firstChild),this._set("root",h);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,h.appendChild(a),this._set("surface",a);const u=new n$h;h.appendChild(u.surface),this._set("overlay",u),l$8((()=>u.needsRender),(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=A$1({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(l$8((()=>this.size),(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?a.classList.add(i):a.classList.remove(i);}),h$7),i),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new j$1({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([l$8((()=>this.root),(t=>{e.container=t?m$3(t):null;}),h$7),l$8((()=>this.popup),((t,s)=>{const i="popup",o="manual";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:o}));}),h$7)],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=f$2,e.time=y$3,this.handles.add([(()=>{const t=()=>{e.freq=f$2,e.time=y$3;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),A$1({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=f$2,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?f$2:Math.min(y$3,s.freq*_$4),!t&&s.freq>=v$2&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=p$e(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return e$6([d$9({value:null,cast:e=>e$d(e)})],l.prototype,"container",null),e$6([d$9({readOnly:!0})],l.prototype,"focused",null),e$6([d$9({readOnly:!0})],l.prototype,"height",void 0),e$6([d$9({type:j$1})],l.prototype,"popup",null),e$6([d$9({type:n$h})],l.prototype,"overlay",void 0),e$6([d$9({readOnly:!0})],l.prototype,"position",void 0),e$6([d$9({readOnly:!0})],l.prototype,"resizing",void 0),e$6([d$9({readOnly:!0})],l.prototype,"root",void 0),e$6([d$9({value:null,readOnly:!0})],l.prototype,"size",null),e$6([d$9({readOnly:!0})],l.prototype,"surface",void 0),e$6([d$9({readOnly:!0})],l.prototype,"suspended",void 0),e$6([d$9()],l.prototype,"ui",void 0),e$6([d$9({readOnly:!0})],l.prototype,"userContent",void 0),e$6([d$9({readOnly:!0})],l.prototype,"width",void 0),e$6([d$9()],l.prototype,"widthBreakpoint",void 0),l=e$6([n$j("esri.views.DOMContainer")],l),l};function w$1(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const p$d=p=>{let a=class extends p{async fetchPopupFeatures(e,r){await this.when();const{location:i,queryArea:p,layerViewsAndGraphics:a,clientOnlyGraphics:t}=await this._prepareFetchPopupFeatures(e,r),o=Promise.resolve(t),c=this._queryLayerPopupFeatures(p,a,r),n=c.map((e=>e.promise));return {location:i,clientOnlyGraphics:t,allGraphicsPromise:C$1([o,...n]).then((e=>Array.from(new Set(e.flat())))),promisesPerLayerView:c}}_queryLayerPopupFeatures(e,s,i){return s.map((({layerView:s,graphics:p})=>{const a={clientGraphics:p,event:r$b(i)?i.event:null,signal:r$b(i)?i.signal:null,defaultPopupTemplateEnabled:!!r$b(i)&&!!i.defaultPopupTemplateEnabled},t=s.fetchPopupFeatures(e,a);return {layerView:s,promise:t}}))}_isValidPopupGraphic(e,s){return e&&!!e.getEffectivePopupTemplate(r$b(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,a);return {clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>"graphic"===e.type&&this._isValidPopupGraphic(e.graphic,r))),a=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||a}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),r$b(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r$b(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const a of e){const e=i.get(a.layer)||i.get(a.sourceLayer)||null;e?e.push(a):s.push(a);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return a=e$6([n$j("esri.views.PopupView")],a),a};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const i$b=s$e.getLogger("esri.support.AnalysesCollection");let n$e=class extends m$8{constructor(e){super(e),this.handles.add(this.on("before-add",(e=>{t$c(e.item)||e.item.parent===this.owner&&(i$b.warn("Analysis inside the collection must be unique. Not adding this element again."),e.preventDefault());})));}_own(e){e.parent=this.owner;}_release(e){e.parent=null;}};n$e=e$6([n$j("esri.support.AnalysesCollection")],n$e);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p$c=class extends y$4{constructor(e){super(e),this.view=null,this.baseLayerViews=new j$2,this.referenceLayerViews=new j$2,this._loadingHandle=l$8((()=>this.view?.map?.basemap),(e=>{e&&e.load().catch((()=>{}));}),h$7);}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){if(this.view&&this.view.suspended)return !1;const e=this.view?.map?.basemap;return !!e&&(!!e.loaded&&(this.baseLayerViews.some((e=>e.updating))||this.referenceLayerViews.some((e=>e.updating))))}};e$6([d$9({constructOnly:!0})],p$c.prototype,"view",void 0),e$6([d$9({readOnly:!0})],p$c.prototype,"baseLayerViews",void 0),e$6([d$9({readOnly:!0})],p$c.prototype,"referenceLayerViews",void 0),e$6([d$9({readOnly:!0})],p$c.prototype,"suspended",null),e$6([d$9({type:Boolean,readOnly:!0})],p$c.prototype,"updating",null),p$c=e$6([n$j("esri.views.BasemapView")],p$c);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const v$1=s$e.getLogger("esri.views.LayerViewManager");class V$1{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=T$2(),this._started=!1,this.done=!1,v$5(this._controller.signal,(()=>{const r=new s$f("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:t}=this;r.emit("layerview-destroy",{view:t,layerView:e}),t.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:i}=this;this._map=i.map;try{let s,o;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)s=await r.createLayerView(i,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$f("layer:view-not-supported","No layerview implementation was found");const a=await this.layerViewImporter.importLayerView(r);f$6(e),s="default"in a?new a.default({layer:r,view:i}):new a({layer:r,view:i});}const l=()=>{o=a$j(o),s.destroyed||s.destroy(),s.layer=null,s.parent=null,s.view=null,this.done=!0;};o=v$5(e,l),f$6(e);try{await s.when();}catch(a){throw l(),a}const y=this._map?.allLayers?.includes(r);if(!y)return l(),void this._deferred.reject(new s$f("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=s,r.emit("layerview-create",{view:i,layerView:s}),i.emit("layerview-create",{layer:r,layerView:s}),this.done=!0,this._deferred.resolve(s);}catch(a){r.emit("layerview-create-error",{view:i,error:a}),i.emit("layerview-create-error",{layer:r,error:a}),this.done=!0,this._deferred.reject(new s$f("layerview:create-error","layerview creation failed",{layer:r,error:a}));}}}let L$1=class extends d$a{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new c$i,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const e=this.view.map?.allLayers;if(e)for(const r of e)this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r);},this._reschedule=()=>(t$c(this._workPromise)&&(this._workPromise=T$2()),this.handles.remove("reschedule"),this.handles.add(v$6(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),t$c(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const t=new p$h({getCollections:()=>this._rootCollectionNames.map((e=>this.get(e))),getChildrenFunction:e=>e&&"layers"in e?e.layers:null});if(!t)return this._workPromise.resolve(),void(this._workPromise=null);for(const r of t)this._createLayerView(r);this._refreshCollections();for(const[r,s]of this._layerLayerViewInfoMap)t.includes(r)||(this._layerLayerViewInfoMap.delete(s.layer),s.destroy());const i=t.filter((e=>"group"===e.type)).map((e=>e.layers)),a=[e?.ground?.layers,e?.basemap?.baseLayers,e?.basemap?.referenceLayers,e?.layers,...i].filter((e=>!!e));this.handles.add(a.map((e=>this._watchUpdatingTracking.addOnCollectionChange((()=>e),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([a$i((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),l$8((()=>{const e=this.view,r=e?.map;return [r?.basemap,r?.ground,r?.layers,e?.ready]}),(()=>this._reschedule()),w$5)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return r$b(this._workPromise)||this._watchUpdatingTracking.updating||n$n(this._layerLayerViewInfoMap,(e=>!e.done))}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new s$f("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining");}_populateLayerViewsOwners(e,r,t){if(!e||!r)return void(r&&r.removeAll());let i=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=t,r.getItemAt(i)!==s&&r.splice(i,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),i+=1;}i<r.length&&r.splice(i,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new V$1(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{r&&(g$a(r)||"cancelled:layerview-create"===r.name)||v$1.error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining");}};e$6([d$9()],L$1.prototype,"_workPromise",void 0),e$6([d$9({readOnly:!0})],L$1.prototype,"_watchUpdatingTracking",void 0),e$6([d$9({readOnly:!0})],L$1.prototype,"_layersToLayerViews",null),e$6([d$9({readOnly:!0})],L$1.prototype,"_rootCollectionNames",null),e$6([d$9()],L$1.prototype,"layerViewImporter",void 0),e$6([d$9()],L$1.prototype,"supportsGround",void 0),e$6([d$9({readOnly:!0})],L$1.prototype,"updating",null),e$6([d$9({readOnly:!0})],L$1.prototype,"updatingRemaining",null),e$6([d$9({constructOnly:!0})],L$1.prototype,"view",void 0),L$1=e$6([n$j("esri.views.LayerViewManager")],L$1);const M=L$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let i$a=class extends y$4{constructor(o){super(o),this.factor=1.5,this.offset=c$k(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0;}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e$6([d$9({type:Number})],i$a.prototype,"factor",void 0),e$6([d$9({nonNullable:!0})],i$a.prototype,"offset",void 0),e$6([d$9()],i$a.prototype,"position",void 0),e$6([d$9({type:Number,range:{min:0}})],i$a.prototype,"size",void 0),e$6([d$9()],i$a.prototype,"maskUrl",void 0),e$6([d$9()],i$a.prototype,"maskEnabled",void 0),e$6([d$9()],i$a.prototype,"overlayUrl",void 0),e$6([d$9()],i$a.prototype,"overlayEnabled",void 0),e$6([d$9({readOnly:!0})],i$a.prototype,"version",null),e$6([d$9({type:Boolean})],i$a.prototype,"visible",void 0),i$a=e$6([n$j("esri.views.Magnifier")],i$a);const p$b=i$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let i$9=class extends y$4{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=t?.registerTask(L$4.TEXTURE_UNLOAD)??Q$1;}normalizeCtorArgs(){return {}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach((e=>this._releaseTextureRequest(e))),this._textureRequests.clear();}get updating(){return this._frameTask.updating}fromData(e,t,r){const s=this.makeUid(e);let o=this._textureRequests.get(s);return o||(o={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:r},this._stage&&(this._stage.add(o.texture),this._stage.loadImmediate(o.texture)),this._textureRequests.set(s,o)),o.referenceCount++,{uid:s,texture:o.texture,release:()=>this._release(s)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(e)))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`);}get test(){return {textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e));}_releaseTextureRequest(e){e.onRemove&&e.onRemove(),e.texture?this._stage?.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null);}makeUid(e,t=null){return r$b(t)?`${e}.${t}px`:e}};e$6([d$9()],i$9.prototype,"_frameTask",void 0),e$6([d$9()],i$9.prototype,"updating",null),i$9=e$6([n$j("esri.views.3d.support.TextureCollection")],i$9);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var t$7;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right";}(t$7||(t$7={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const r$9=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$8={};function o$a(t){return !!i$8[t]}function s$9(t){for(const e of t)if(!o$a(e))return !1;return !0}r$9.forEach((t=>{i$8[t]=!0;}));class p$a{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!s$9(i))return i.some(o$a)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let p,l;Array.isArray(e)?l=e:(p=e,l=[]),"function"==typeof a?p=a:r=a,r=null!=r?r:g$7.DEFAULT;const u=this._createUniqueGroupName(),m=new c$b(this.view,i,l,p);this.handlers.set(u,{handler:m,priority:r});for(const n of i){const t=this.handlerCounts.get(n)||0;this.handlerCounts.set(n,t+1);}return this.inputManager&&this.inputManager.installHandlers(u,[m],r),{remove:()=>this._removeHandler(u,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}_removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}_createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class c$b extends i$d{constructor(t,e,a,n){super(!0),this.view=t;for(const r of e)switch(r){case"click":this.registerIncoming("click",a,(t=>n(this._wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this._wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this._wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this._wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this._wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this._wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this._wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this._wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this._wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this._wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this._wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this._wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this._wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this._wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this._wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this._wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this._wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this._wrapBlur(t));}));}}_wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:c$k(i,o),mapPoint:this._getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this._getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this._getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this._getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this._getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_getMapPoint(t,a){return this.view.toMap(c$k(t,a),{exclude:[]})}_wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:m$9(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var o$9,t$6,u$6;!function(o){o[o.USER=0]="USER",o[o.MANAGER=1]="MANAGER";}(o$9||(o$9={})),function(o){o[o.None=0]="None",o[o.Unfocused=1]="Unfocused",o[o.Focused=2]="Focused",o[o.Unselected=4]="Unselected",o[o.Selected=8]="Selected",o[o.All=15]="All";}(t$6||(t$6={})),function(o){o[o.None=0]="None",o[o.Custom1=16]="Custom1",o[o.Custom2=32]="Custom2",o[o.Custom3=64]="Custom3",o[o.Custom4=128]="Custom4",o[o.Custom5=256]="Custom5",o[o.Custom6=512]="Custom6",o[o.Custom7=1024]="Custom7",o[o.Custom8=2048]="Custom8",o[o.Custom9=4096]="Custom9",o[o.Custom10=8192]="Custom10",o[o.Custom11=16384]="Custom11",o[o.Custom12=32768]="Custom12",o[o.All=65520]="All";}(u$6||(u$6={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const o$8=s$e.getLogger("esri.views.interactive.interactiveToolUtils");function i$7(e){return [e.on("before-add",(t=>{const i=t.item;if(null==i||e.includes(i))return o$8.warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd();})),e.on("after-remove",(e=>{const t=e.item;t.visible=!1,t.active&&(t.view.activeTool=null),t.destroy();}))]}function r$8(e){return e.visible&&e.getEditableFlag(o$9.USER)&&e.getEditableFlag(o$9.MANAGER)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function n$d(t){return c$k(t.x,t.y)}function c$a(e){return i$h(e.x,e.y)}function i$6(t,n){const c=(t instanceof HTMLElement?t:t.surface).getBoundingClientRect();return c$k(n.clientX-c.left,n.clientY-c.top)}function r$7(e,t){return t instanceof Event?i$6(e,t):n$d(t)}function o$7(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;default:return !1}}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class p$9{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._currentlyActiveTool=null,this._revertToActiveTool=!1,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(t,a){const s=()=>t.stopPropagation();switch(t.type){case"pointer-move":c$9(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!u$5(t))break;const e=n$d(t),n=this._intersect(e,t.pointerType,a.forEachTool);if(t$c(n))break;const p=this._findToolAndManipulatorByKey(n,a.forEachTool,h$4),c=o$f(p,(t=>t.manipulator)),d=o$f(p,(t=>t.tool));!(r$b(c)&&r$b(d)&&c.interactive)||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,d,t),r$b(c)&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:e,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&a.activeTool!==n.tool&&(this._currentlyActiveTool=a.activeTool,this._revertToActiveTool=!0,a.setActiveTool(n.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:e}),s());break}case"pointer-up":this._handlePointerEnd(t,a);break;case"pointer-drag":{if(!u$5(t))break;const i=this._grabbedManipulators.get(t.pointerId),p=this._draggedManipulators.get(t.pointerId),c=o$f(i||p,(({key:t})=>t)),d=this._findManipulatorByKey(c,a.forEachTool);if(t$c(d))break;const h=n$d(t);h.x=o$h(h.x,0,a.view.width),h.y=o$h(h.y,0,a.view.height);const g=e$9(i||p).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:e$9(c),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,a);}s();break}case"immediate-click":{const e=n$d(t),r=this._intersect(e,t.pointerType,a.forEachTool),n=this._findToolAndManipulatorByKey(r,a.forEachTool,h$4);if(d$5(t)||a.forEachTool((t=>{if((!r$b(n)||n.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$c(n))break;const{manipulator:p,tool:c}=n;if(!p.interactive)break;p.selectable&&c.automaticManipulatorSelection&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const u=t.native.shiftKey;p.events.emit("immediate-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:u,stopPropagation:s});break}case"click":{const e=n$d(t),i=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(i,a.forEachTool);if(t$c(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit(t.type,{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n}),s();break}case"double-click":{const e=n$d(t),i=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(i,a.forEachTool);if(t$c(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}case"immediate-double-click":{const e=n$d(t),i=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(i,a.forEachTool);if(t$c(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}}this._onFocusChange(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,o){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:o.pointerType,screenPoint:n$d(o)}),this._grabbedManipulators.forEach((({key:o},i)=>{o.tool===e&&e.manipulators.findById(o.manipulatorId)===t&&this._grabbedManipulators.delete(i);}));}_handlePointerEnd(t,e){const o=o$f(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),n=this._findManipulatorByKey(o,e.forEachTool);r$b(n)&&!n.dragging&&(1===this._grabbedManipulators.size&&0===this._draggedManipulators.size&&this._revertToActiveTool&&(e.setActiveTool(this._currentlyActiveTool),this._revertToActiveTool=!1,this._currentlyActiveTool=null),n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:n$d(t)})),this._grabbedManipulators.delete(t.pointerId));}_cursorFromMap(e,o){let r=null;return n$n(e,(({key:t})=>{const e=this._findManipulatorByKey(t,o);return !!(r$b(e)&&e.interactive&&"cursor"in e&&e.cursor)&&(r=e.cursor,!0)})),r}_onFocusChange(t){this._updateCursor(t),this._updateFocusedManipulatorTools(t);}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}_updateFocusedManipulatorTools(t){const e=new Set;this._grabbedManipulators.forEach((({key:{tool:t}})=>{e.add(t);})),this._hoveredManipulators.forEach((({key:{tool:t}})=>{e.add(t);})),t((t=>{t.hasFocusedManipulators=e.has(t);}));}clearPointers(t,e,r=!0,n){const a=e=>e.tool===t&&(t$c(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t,pointerType:o},r)=>{if(a(t)){this._grabbedManipulators.delete(r);const n=this._findManipulatorByKey(t,e);r$b(n)&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:o}));}})),this._draggedManipulators.forEach((({key:t},o)=>{if(a(t)){this._draggedManipulators.delete(o);const r=this._findManipulatorByKey(t,e);r$b(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},o)=>{if(a(t)){this._hoveredManipulators.delete(o);const r=this._findManipulatorByKey(t,e);r$b(r)&&(r.hovering=!1);}})),this._onFocusChange(e);}_intersect(t,e,i){let r=null;return i((i=>{if(null==i.manipulators||!r$8(i))return !1;const n=i.manipulators.intersect(t,e);return !t$c(n)&&(r={manipulatorId:n.id,tool:i},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,o)=>{this._updateHoveredStateForPointerAtScreenPosition(c$k(e.x,e.y),o,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!c$9(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(n$d(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,e,o,a){const s=this._intersect(t,o,a);let l=this._findManipulatorByKey(s,a);const p=o$f(this._hoveredManipulators.get(e),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);r$b(l)&&!l.interactive&&(l=null),c!==l&&(r$b(c)&&(c.hovering=!1),r$b(l)?(l.hovering=!0,this._hoveredManipulators.set(e,{key:e$9(s)})):this._hoveredManipulators.delete(e),this._onFocusChange(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,h$4)?h$4.manipulator:null}_findToolAndManipulatorByKey(t,e,r){return t$c(t)?null:(r.tool=null,r.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!r$8(e))return !1;const o=e.manipulators.findById(t.manipulatorId);return !!r$b(o)&&(r.manipulator=o,r.tool=e,!0)})),r.manipulator?r:null)}}function c$9(t){return "mouse"===t}function u$5(t){return "mouse"!==t.pointerType||0===t.button}function d$5(t){return !!t.native.shiftKey}const h$4={manipulator:null,tool:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const E=s$e.getLogger("esri.views.ToolViewManager"),g$4="attached",w="tools";let y$2=class extends d$a{constructor(t){super(t),this._manipulatorState=new p$9,this.tools=new j$2,this.cursor=null,this._forEachTool=t=>{for(const o of this.tools.items)if(t(o))return};}initialize(){this.handles.add([this.view.on(r$9,(t=>{this._handleInputEvent(t);}),g$7.TOOL),...i$7(this.tools),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this.detach(),this.handles.removeAll();}set activeTool(t){if(r$b(t)&&!this.view.ready)return void E.error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const o=this.activeTool;this._set("activeTool",t),r$b(o)&&o.deactivate(),r$b(t)&&t.activate(),this._removeIncompleteTools(t);const e=t$c(this.activeTool);for(const i of this.tools){i.setEditableFlag(o$9.MANAGER,e||i===this.activeTool);const t=r$8(i);!e&&t||this._manipulatorState.clearPointers(i,this._forEachTool,!t);}this._updateCursor();}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))||(this.textures?.updating??!1)}attach(){"3d"===this.view.type?(this._set("textures",new i$9(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([l$8((()=>{const{state:t}=this.view;return "camera"in t&&t.camera}),(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this._forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));})),n$o((()=>this._set("textures",l$9(this.textures))))],g$4)):this.handles.add(l$8((()=>this.view.extent),(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){r$b(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(g$4);}_forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let o=!1;const e={...t,stopPropagation:()=>{o=!0,t.stopPropagation();}};r$b(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(e):this._forEachTool((t=>{!o&&t.visible&&t.handleInputEvent(e);})),!o&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(e,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},view:this.view}),!o&&r$b(this.activeTool)&&this.activeTool.handleInputEventAfter(e),this._manipulatorState.handleHoverEvent(e,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this.handles.remove(w),this._forEachTool((t=>{if(t instanceof y$4){const o=l$8((()=>[t.cursor,t.visible,t.editable]),(()=>{r$8(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this.handles.add(o,w);}t.manipulators&&this.handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),w);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){const t=this._manipulatorState.cursor;let o=t;this._forEachTool((e=>!(!r$b(e.cursor)||!e.visible||!t$c(t)&&e.preferManipulatorCursor)&&(o=e.cursor,!0))),this._get("cursor")!==o&&this._set("cursor",o);}_removeIncompleteTools(t){this.tools.filter((o=>(t$c(t)||o!==t)&&!o.created&&o.removeIncompleteOnCancel)).forEach((t=>{this.tools.remove(t);}));}};e$6([d$9({constructOnly:!0,nonNullable:!0})],y$2.prototype,"view",void 0),e$6([d$9({readOnly:!0,nonNullable:!0})],y$2.prototype,"textures",void 0),e$6([d$9({value:null})],y$2.prototype,"activeTool",null),e$6([d$9({readOnly:!0,type:j$2})],y$2.prototype,"tools",void 0),e$6([d$9({readOnly:!0})],y$2.prototype,"cursor",void 0),e$6([d$9({readOnly:!0})],y$2.prototype,"updating",null),y$2=e$6([n$j("esri.views.ToolViewManager")],y$2);const j=y$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let o$6=class extends y$4{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":n$c.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return a$b[this.deviceType]}};e$6([d$9({nonNullable:!0,readOnly:!0})],o$6.prototype,"nativeIndex",void 0),e$6([d$9({type:String,readOnly:!0})],o$6.prototype,"deviceType",null),e$6([d$9({type:Number,readOnly:!0})],o$6.prototype,"axisThreshold",null),o$6=e$6([n$j("esri.views.input.gamepad.GamepadInputDevice")],o$6);const n$c=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),a$b={standard:.15,spacemouse:.025,unknown:0},i$5=o$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let c$8=class extends y$4{constructor(...e){super(...e),this.devices=new j$2,this.enabledFocusMode="document";}};e$6([d$9({type:j$2.ofType(i$5),readOnly:!0})],c$8.prototype,"devices",void 0),e$6([d$9({type:["document","view","none"]})],c$8.prototype,"enabledFocusMode",void 0),c$8=e$6([n$j("esri.views.input.gamepad.GamepadSettings")],c$8);const i$4=c$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p$8=class extends y$4{constructor(){super(...arguments),this.gamepad=new i$4;}};e$6([d$9({readOnly:!0})],p$8.prototype,"gamepad",void 0),p$8=e$6([n$j("esri.views.input.Input")],p$8);const a$a=p$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let s$8=class extends y$4{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e$6([d$9({type:Boolean,nonNullable:!0})],s$8.prototype,"enabled",void 0),e$6([d$9({type:i$5})],s$8.prototype,"device",void 0),e$6([d$9({type:["pan","zoom"],nonNullable:!0})],s$8.prototype,"mode",void 0),e$6([d$9({type:["forward-down","forward-up"],nonNullable:!0})],s$8.prototype,"tiltDirection",void 0),e$6([d$9({type:Number,nonNullable:!0})],s$8.prototype,"velocityFactor",void 0),s$8=e$6([n$j("esri.views.navigation.gamepad.GamepadSettings")],s$8);const a$9=s$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let a$8=class extends y$4{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new a$9,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e$6([d$9({type:Boolean})],a$8.prototype,"browserTouchPanEnabled",void 0),e$6([d$9({type:a$9,nonNullable:!0})],a$8.prototype,"gamepad",void 0),e$6([d$9({type:Boolean})],a$8.prototype,"momentumEnabled",void 0),e$6([d$9({type:Boolean})],a$8.prototype,"mouseWheelZoomEnabled",void 0),a$8=e$6([n$j("esri.views.navigation.Navigation")],a$8);const p$7=a$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let n$b,s$7=null;async function c$7(r){s$7||(s$7=import('./geometryServiceUtils-b4e25893.js').then((e=>n$b=e))),await s$7,f$6(r);}async function p$6(e,s,a,m){if(!e)return null;const l=e.spatialReference;return en()||An(l,s)?rn(e,s):n$b?n$b.projectGeometry(e,s,a,m):(await Promise.race([c$7(m),tn(m)]),p$6(e,s,a,m))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let h$3=class extends y$4{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null};}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=h$8(this._projectExtentTask.task)),this._set("map",null);}get ready(){return !this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return !this._heightModelInfoTask.updating}get spatialReference(){return r$b(this.userSpatialReference)?this.userSpatialReference:e$9(this._spatialReferenceTask.spatialReference)}get extent(){return e$9(this._extentTask.extent)}get heightModelInfo(){return e$9(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return e$9(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return e$9(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return t$c(this.userSpatialReference)||this.userSpatialReference.equals(e$9(this._spatialReferenceTask.spatialReference))?e$9(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return e$9(this._tileInfoTask.tileInfo)}get mapCollections(){const e=this.map?.(),t=[];return r$b(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let a=null;for(const i of e){const e=this._getSupportedSpatialReferences(i);if(e.length>0){const t=this._narrowDownSpatialReferenceCandidates(a,e);r$b(t)&&(a=t);}if(r$b(a)&&1===a.length)break}if(t&&(t$c(a)||1!==a.length))return {updating:!0};const s=this._pickSpatialReferenceCandidate(a);return {spatialReference:r$b(s)?s.spatialReference:null,viewingMode:r$b(s)?s.viewingMode:null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return {updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:this.map?.()?.basemap,layers:this.map?.()?.basemap?.baseLayers},{layers:this.map?.()?.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const t=e[0].tileInfo;return {tileInfo:t&&t.spatialReference.equals(this.spatialReference)?t:null,updating:!1}}return {updating:t}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const a of e)if(g$b(a)){const e=h$9(a);if(e)return {heightModelInfo:e,vcsWkid:a.spatialReference?.vcsWkid,latestVcsWkid:a.spatialReference?.latestVcsWkid,updating:!1}}return {updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return {updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,a=[];for(const s of e.layers){const e="fullExtents"in s&&s.fullExtents||(r$b(s.fullExtent)?[s.fullExtent]:[]),t=this.requiresExtentInSpatialReference?null:e[0],i=e.find((e=>e.spatialReference.equals(this.spatialReference)))??t;if(i)return {candidates:[{extent:i,layer:s}],updating:!1};if(this._getSupportedSpatialReferences(s).length>0)for(const n of e)a.push({extent:n,layer:s});}return {candidates:a,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return {updating:t};if(t$c(e)||0===e.length)return {updating:!1};if(!this.spatialReference)return {updating:this._spatialReferenceTask.updating};const s=this._pickExtentCandidate(e),l=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&l.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:r$b(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(r$b(this._projectExtentTask.task)&&(this._projectExtentTask.task=h$8(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:l.clone(),task:O$2((async e=>{try{const t=await p$6(s.extent,l,s.layer.portalItem,e);this._projectExtentTask={...this._projectExtentTask,task:null,output:t};}catch(t){if(p$i(e))return;this._projectExtentTask={...this._projectExtentTask,task:null};}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(t$c(e))return t;const a=[],s=(e,t)=>r$b(e)?r$b(t)?e===t&&e:e:t;for(const n of e)for(const e of t){if(!n.spatialReference.equals(e.spatialReference))continue;const t=s(n.viewingMode,e.viewingMode);if(!1!==t){a.push({spatialReference:n.spatialReference,viewingMode:t});break}}return a.length>0?a:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return t$c(e)||e.length<1?r$b(t)?{spatialReference:t,viewingMode:null}:null:(r$b(t)&&e.length>1&&e.some((({spatialReference:e})=>e.equals(t)))&&(e=e.filter((({spatialReference:e})=>e.equals(t)))),e.length>1&&e.some((({viewingMode:e})=>e!==l$a.Local))&&(e=e.filter((({viewingMode:e})=>e!==l$a.Local))),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return [];const a=[];for(const s of t){const t=this.getSpatialReferenceSupport({spatialReference:s,layer:e});if(r$b(t)){const e=r$b(t.constraints)?t.constraints:[{spatialReference:s,viewingMode:null}];for(const{spatialReference:t,viewingMode:n}of e)(!this.requiresExtentInSpatialReference||t$c(this.userSpatialReference)||t.equals(this.userSpatialReference))&&a.push({spatialReference:t,viewingMode:n});}}return a}_pickExtentCandidate(e){const t=this.spatialReference;return e.find((({extent:e})=>t.equals(e.spatialReference)))||e[0]}_collectLayers(e){if("loaded"!==this._loadMaybe(this.map?.()))return {layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const a of e)if(this._collectCollection(a,t),t.preloading===this.sourcePreloadCount)break;return {layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const a of e.layers){switch(this._loadMaybe(a)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(a),"layers"in a&&this._collectCollection({layers:a.layers},t);}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?"not-loaded"===e.loadStatus?(e.load(),"loading"):e.loadStatus:"loaded"}};e$6([d$9()],h$3.prototype,"required",void 0),e$6([d$9({constructOnly:!0})],h$3.prototype,"map",void 0),e$6([d$9({constructOnly:!0})],h$3.prototype,"getSpatialReferenceSupport",void 0),e$6([d$9()],h$3.prototype,"defaultSpatialReference",void 0),e$6([d$9()],h$3.prototype,"userSpatialReference",void 0),e$6([d$9()],h$3.prototype,"sourcePreloadCount",void 0),e$6([d$9()],h$3.prototype,"priorityCollection",void 0),e$6([d$9()],h$3.prototype,"requiresExtentInSpatialReference",void 0),e$6([d$9()],h$3.prototype,"suspended",void 0),e$6([d$9({readOnly:!0})],h$3.prototype,"ready",null),e$6([d$9({readOnly:!0})],h$3.prototype,"heightModelInfoReady",null),e$6([d$9({readOnly:!0})],h$3.prototype,"spatialReference",null),e$6([d$9({readOnly:!0})],h$3.prototype,"extent",null),e$6([d$9({readOnly:!0})],h$3.prototype,"heightModelInfo",null),e$6([d$9({readOnly:!0})],h$3.prototype,"vcsWkid",null),e$6([d$9({readOnly:!0})],h$3.prototype,"latestVcsWkid",null),e$6([d$9({readOnly:!0})],h$3.prototype,"viewingMode",null),e$6([d$9({readOnly:!0})],h$3.prototype,"tileInfo",null),e$6([d$9({readOnly:!0})],h$3.prototype,"mapCollections",null),e$6([d$9({readOnly:!0})],h$3.prototype,"_allLayers",null),e$6([d$9({readOnly:!0})],h$3.prototype,"_spatialReferenceTask",null),e$6([d$9({readOnly:!0})],h$3.prototype,"_tileInfoTask",null),e$6([d$9({readOnly:!0})],h$3.prototype,"_heightModelInfoTask",null),e$6([d$9({readOnly:!0})],h$3.prototype,"_extentCandidatesTask",null),e$6([d$9()],h$3.prototype,"_extentTask",null),e$6([d$9()],h$3.prototype,"_projectExtentTask",void 0),h$3=e$6([n$j("esri.views.support.DefaultsFromMap")],h$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var U$2;const W$1=s$e.getLogger("esri.views.View");let A=U$2=class extends(a$k(n$k.EventedMixin(m$a(y$4)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new p$h({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.fatalError=null,this.extent=null,this.graphics=new c$l,this.analyses=new n$e,this.navigating=!1,this.typeSpecificPreconditionsReady=!0,this.layerViews=new j$2,this.magnifier=new p$b,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new a$a,this.navigation=new p$7,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new p$a(this),this.persistableViewModels=new j$2,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(l$8((()=>this.preconditionsReady),(e=>{e?(this._currentSpatialReference=this.spatialReference,U$2.views.add(this)):(this._currentSpatialReference=null,U$2.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager?.clear(),this.toolViewManager?.detach(),r$b(this.analysisViewManager)&&this.analysisViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),r$b(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach());}),U$6));}initialize(){this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,j$4((()=>this.ready)))))),this.basemapView=new p$c({view:this}),this.layerViewManager=new M({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new j({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([l$8((()=>this.initialExtentRequired),(e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e}),{sync:!0,initial:!0}),l$8((()=>this.ready),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference);}),{sync:!0}),l$8((()=>this._userSpatialReference),(e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e);}),{sync:!0,initial:!0})]);}_setupSpatialReferenceLogger(){let e=null;this.handles.add([l$8((()=>this.defaultsFromMap?.ready),(t=>{const i=this.map?.allLayers.length>0;if(t&&!this.spatialReference&&i){if(r$b(e))return;const t=n$o((()=>e=h$8(e)));e=O$2((async t=>{try{await L$3(this.spatialReferenceWarningDelay,null,t);}catch{return}finally{e=null;}W$1.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})),this.handles.add(t,"spatial-reference-logger-task");}else this.handles.remove("spatial-reference-logger-task");}),{sync:!0})]);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=l$9(this.graphics),this.analyses=l$9(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),l$9(this.analysisViewManager),this.toolViewManager=l$9(this.toolViewManager),this.layerViewManager=l$9(this.layerViewManager),this.basemapView=l$9(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,e?.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return Promise.resolve(this)}toMap(){return W$1.error("#toMap()","Not implemented on this instance of View"),null}get _defaultsFromMapSettings(){return {}}get defaultsFromMap(){return new h$3({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:e=>this.getSpatialReferenceSupport(e),...this._defaultsFromMapSettings})}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||m$b.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}set map(e){e!==this._get("map")&&(e?.destroyed&&(W$1.warn("#map","The provided map is already destroyed",{map:e}),e=null),m$b.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.defaultsFromMap?.required?.heightModelInfo&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){const t=!E$3(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e));}_spatialReferenceChanged(e){}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return r$b(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return (this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}importLayerView(e){throw new s$f("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async validate(){}invalidate(){this._isValid=!1;}getSpatialReferenceSupport(){return {constraints:null}}_validateSpatialReference(e){return r$b(this.getSpatialReferenceSupport({spatialReference:e}))}when(e,t){return this.isResolved()&&!this.ready&&W$1.warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(f$4((()=>!1===this.preconditionsReady),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0);}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e;}tryFatalErrorRecovery(){this.fatalError=null;}};A.views=new j$2,e$6([d$9()],A.prototype,"_userSpatialReference",void 0),e$6([o$g("toolViewManager.activeTool")],A.prototype,"activeTool",void 0),e$6([d$9({readOnly:!0})],A.prototype,"allLayerViews",void 0),e$6([d$9()],A.prototype,"groundView",void 0),e$6([d$9()],A.prototype,"animation",void 0),e$6([d$9()],A.prototype,"basemapView",void 0),e$6([d$9({readOnly:!0})],A.prototype,"_defaultsFromMapSettings",null),e$6([d$9()],A.prototype,"defaultsFromMap",null),e$6([d$9()],A.prototype,"fatalError",void 0),e$6([d$9({type:M$1})],A.prototype,"extent",void 0),e$6([d$9(a$l(c$l,"graphics"))],A.prototype,"graphics",void 0),e$6([d$9(a$l(n$e,"analyses"))],A.prototype,"analyses",void 0),e$6([d$9({readOnly:!0,type:v$7})],A.prototype,"heightModelInfo",null),e$6([d$9({readOnly:!0})],A.prototype,"interacting",null),e$6([d$9({readOnly:!0})],A.prototype,"navigating",void 0),e$6([d$9({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],A.prototype,"preconditionsReady",null),e$6([d$9({readOnly:!0})],A.prototype,"typeSpecificPreconditionsReady",void 0),e$6([d$9({type:j$2,readOnly:!0})],A.prototype,"layerViews",void 0),e$6([d$9({type:p$b})],A.prototype,"magnifier",void 0),e$6([d$9({value:null,type:L$5})],A.prototype,"map",null),e$6([d$9()],A.prototype,"padding",void 0),e$6([d$9({readOnly:!0})],A.prototype,"ready",void 0),e$6([d$9({type:k})],A.prototype,"spatialReference",null),e$6([d$9()],A.prototype,"spatialReferenceWarningDelay",void 0),e$6([d$9()],A.prototype,"stationary",null),e$6([d$9({readOnly:!0})],A.prototype,"supportsGround",void 0),e$6([d$9({type:y$5})],A.prototype,"timeExtent",void 0),e$6([o$g("toolViewManager.tools")],A.prototype,"tools",void 0),e$6([d$9()],A.prototype,"toolViewManager",void 0),e$6([d$9({readOnly:!0})],A.prototype,"type",void 0),e$6([d$9({type:Number})],A.prototype,"scale",void 0),e$6([d$9({readOnly:!0})],A.prototype,"updating",void 0),e$6([d$9({readOnly:!0})],A.prototype,"initialExtentRequired",void 0),e$6([d$9({readOnly:!0})],A.prototype,"initialExtent",null),e$6([d$9()],A.prototype,"cursor",null),e$6([d$9({readOnly:!0})],A.prototype,"input",void 0),e$6([d$9({type:p$7,nonNullable:!0})],A.prototype,"navigation",void 0),e$6([d$9()],A.prototype,"layerViewManager",void 0),e$6([d$9()],A.prototype,"analysisViewManager",void 0),e$6([d$9()],A.prototype,"width",void 0),e$6([d$9()],A.prototype,"height",void 0),e$6([d$9({readOnly:!0})],A.prototype,"resizing",void 0),e$6([d$9({value:null,readOnly:!0})],A.prototype,"size",null),e$6([d$9({readOnly:!0})],A.prototype,"suspended",void 0),e$6([d$9({readOnly:!0})],A.prototype,"viewEvents",void 0),e$6([d$9({readOnly:!0})],A.prototype,"persistableViewModels",void 0),e$6([d$9()],A.prototype,"_isValid",void 0),e$6([d$9()],A.prototype,"_readyCycleForced",void 0),e$6([d$9()],A.prototype,"_currentSpatialReference",void 0),A=U$2=e$6([n$j("esri.views.View")],A);const G$1=A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p$5=class extends _$6{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(new Promise(((t,s)=>this._dfd={resolve:t,reject:s})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$f("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,s){s||(s=k$1(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",s);}};e$6([d$9({readOnly:!0})],p$5.prototype,"done",null),e$6([d$9({readOnly:!0,type:String})],p$5.prototype,"state",void 0),e$6([d$9()],p$5.prototype,"target",void 0),p$5=e$6([n$j("esri.views.ViewAnimation")],p$5),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(p$5||(p$5={}));const n$a=p$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function e$4(){return [1,0,0,1,0,0]}function r$6(e){return [e[0],e[1],e[2],e[3],e[4],e[5]]}function t$5(e,r,t,n,o,a){return [e,r,t,n,o,a]}function n$9(e,r){return new Float64Array(e,r,6)}const o$5=Object.freeze(Object.defineProperty({__proto__:null,create:e$4,clone:r$6,fromValues:t$5,createView:n$9},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const Q=96,U$1=39.37,B=180/Math.PI;function D(t){return t.wkid?t:t.spatialReference||k.WGS84}function T(t,e){return e.type?r$d(t,e.x,e.y):a$m(t,e)}function W(t){return z$1(t)}function H(t,e){const n=Math.max(1,e[0]),r=Math.max(1,e[1]);return Math.max(t.width/n,t.height/r)*ct(t.spatialReference)}async function J(t,a,i,c){let s,u;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(j$2.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const e=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(e&&r&&a&&a.allLayerViews){const e=new Map;for(const n of t){const t=n.layer,r=e.get(t)||[],o=n.attributes[t.objectIdField];null!=o&&r.push(o),e.set(t,r);}const r=[];e.forEach(((t,e)=>{const n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,r.push(n.queryFeatures(o));}}));const i=await Promise.all(r),c=[];for(const t of i)if(t&&t.features&&t.features.length)for(const e of t.features)r$b(e.geometry)&&c.push(e.geometry);o=c;}for(const t of o)c=await J(t,a,i,c);return c}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])s=new j$3(t);else if(t instanceof p$j)s=t;else if("geometry"in t)if(t.geometry)s=t.geometry;else if(t.layer){const e=t.layer,n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=[t.attributes[e.objectIdField]],o.returnGeometry=!0;const a=await n.queryFeatures(o);s=m$c(a,"features",0,"geometry");}}if(t$c(s))return null;if(u="point"===s.type?new M$1({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference}):s.extent,!u)return null;en()||An(u.spatialReference,i)||await tn();const f=rn(u,i);return f?c=c?c.union(f):f:null}function K(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}function X(t,e){return E$3(D(t),e)?t:rn(t,e)}async function Y(e,r){if(!e||!r)return new u$a({targetGeometry:new j$3,scale:0,rotation:0});let o=r.spatialReference;const{constraints:a,padding:i,viewpoint:c,size:s}=r,u=[i?s[0]-i.left-i.right:s[0],i?s[1]-i.top-i.bottom:s[1]];let f=null;e instanceof u$a?f=e:e.viewpoint?f=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(f=e.target);let l=null;f&&f.targetGeometry?l=f.targetGeometry:e instanceof M$1?l=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(l=await J(e.center,r,o)||await J(e.extent,r,o)||await J(e.target,r,o)||await J(e,r,o)),!l&&c&&c.targetGeometry?l=c.targetGeometry:!l&&r.extent&&(l=r.extent),o||(o=D(r.spatialReference||r.extent||l)),en()||E$3(l.spatialReference,o)||An(l,o)||await tn();const m=X(l.center?l.center:l,o);let y=null;if(f&&r$b(f.targetGeometry)&&"point"===f.targetGeometry.type)y=f.scale;else if("scale"in e&&e.scale)y=e.scale;else if("zoom"in e&&-1!==e.zoom&&a&&a.effectiveLODs)y=a.zoomToScale(e.zoom);else if(Array.isArray(l)||"point"===l.type||"extent"===l.type&&0===l.width&&0===l.height){const t=X(r.extent,o);y=r$b(t)?H(t,u):r.extent?H(r.extent,u):c.scale;}else y=H(X(l.extent,o),u);const p=K(e);p&&(p.min&&p.min>y?y=p.min:p.max&&p.max<y&&(y=p.max));let g=0;f?g=f.rotation:e.hasOwnProperty("rotation")?g=e.rotation:c&&(g=c.rotation);let x=new u$a({targetGeometry:m,scale:y,rotation:g});return a&&(x=a.fit(x),a.constrainByGeometry(x),a.rotationEnabled||(x.rotation=g)),x}function Z(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $(t,e,n){return n?r$d(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$b(t,e,.5)}const _$3=function(){const t=n$p();return function(e,n,r){const o=n.targetGeometry;T(t,o);const a=.5*ot(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function tt(t,e,n,r,o){return xt(t,e,n.center),t.scale=H(n,r),o&&o.constraints&&o.constraints.constrain(t),t}function et(t,e,n,r){return ft(t,e,n,r),r$e(t,t)}const nt=function(){const t=n$p();return function(e,n,r){return C$2(e,st(e,n),$(t,n,r))}}(),rt=function(){const t=e$4(),e=n$p();return function(n,r,o,a){const i=ot(r),f=it(r);return r$d(e,i,i),M$2(t,e),e$e(t,t,f),i$i(t,t,nt(e,o,a)),i$i(t,t,[0,a.top-a.bottom]),r$d(n,t[4],t[5])}}();function ot(t){return t.scale*at(t.targetGeometry)}function at(t){return r$b(t)&&I(t.spatialReference)?1/(W(t.spatialReference)*U$1*Q):1}function it(t){return o$i(t.rotation)||0}function ct(t){return I(t)?W(t)*U$1*Q:1}function st(t,e){return l$b(t,e,.5)}const ut=function(){const t=n$p(),e=n$p(),n=n$p();return function(r,o,a,i,c,m){return x$2(t,o),l$b(e,a,.5*m),r$d(n,1/i*m,-1/i*m),f$7(r,e),c&&e$e(r,r,c),c$m(r,r,n),i$i(r,r,t),r}}(),ft=function(){const t=n$p();return function(e,n,r,o){const a=ot(n),i=it(n);return T(t,n.targetGeometry),ut(e,t,r,a,i,o)}}(),lt=function(){const t=n$p();return function(e,n,r,o){const a=ot(n);return T(t,n.targetGeometry),ut(e,t,r,a,0,o)}}();function mt(t){const e=R$3(t);return e?e.valid[1]-e.valid[0]:0}function yt(t,e){return Math.round(mt(t)/e)}const pt=function(){const t=n$p(),e=n$p(),n=[0,0,0];return function(r,o,a){o$j(t,r,o),v$8(t,t),o$j(e,r,a),v$8(e,e),y$6(n,t,e);let i=Math.acos(j$5(t,e)/(q(t)*q(e)))*B;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),gt=function(){const t=n$p();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),rt(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),xt=function(t,e,n){Z(t,e);const r=t.targetGeometry;return r.x=n.x,r.y=n.y,r.spatialReference=n.spatialReference,t},ht=function(){const t=n$p();return function(e,n,r,o,a){a||(a="center"),C$2(t,r,o),l$b(t,t,.5);const i=t[0],c=t[1];switch(a){case"center":r$d(t,0,0);break;case"left":r$d(t,-i,0);break;case"top":r$d(t,0,c);break;case"right":r$d(t,i,0);break;case"bottom":r$d(t,0,-c);break;case"top-left":r$d(t,-i,c);break;case"bottom-left":r$d(t,-i,-c);break;case"top-right":r$d(t,i,c);break;case"bottom-right":r$d(t,i,-c);}return St(e,n,t),e}}();function bt(t,e,n){return Z(t,e),t.rotation+=n,t}function wt(t,e,n){return Z(t,e),t.rotation=n,t}const dt=function(){const t=n$p();return function(e,n,r,o,a){return Z(e,n),isNaN(r)||0===r||(kt(t,o,n,a),e.scale=n.scale*r,At(t,t,e,a),St(e,e,r$d(t,t[0]-o[0],o[1]-t[1]))),e}}();function jt(t,e,n){return Z(t,e),t.scale=n,t}const Gt=function(){const t=n$p();return function(e,n,r,o,a,i){return Z(e,n),isNaN(r)||0===r||(kt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,At(t,t,e,i),St(e,e,r$d(t,t[0]-a[0],a[1]-t[1]))),e}}(),Rt=function(){const t=n$p(),e=n$p();return function(n,r,o,a,i,c,s){return nt(e,c,s),s$i(t,i,e),a?Gt(n,r,o,a,t,c):dt(n,r,o,t,c)}}(),kt=function(){const t=e$4();return function(e,n,r,o){return z$2(e,n,et(t,r,o,1))}}(),At=function(){const t=e$4();return function(e,n,r,o){return z$2(e,n,ft(t,r,o,1))}}(),St=function(){const t=n$p(),e=e$4();return function(n,r,o){Z(n,r);const a=ot(r),i=n.targetGeometry;return h$a(e,it(r)),c$m(e,e,r$f(a,a)),z$2(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function e$3(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function r$5(e){const r=new Float32Array(9);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function t$4(e,r,t,n,o,a,c,u,l){const s=new Float32Array(9);return s[0]=e,s[1]=r,s[2]=t,s[3]=n,s[4]=o,s[5]=a,s[6]=c,s[7]=u,s[8]=l,s}function n$8(e,r){return new Float32Array(e,r,9)}const o$4=Object.freeze(Object.defineProperty({__proto__:null,create:e$3,clone:r$5,fromValues:t$4,createView:n$8},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function n$7(n){return n instanceof Float32Array&&n.length>=2}function r$4(n){return Array.isArray(n)&&n.length>=2}function t$3(t){return n$7(t)||r$4(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var V;const G=[0,0];let O=V=class extends l$c{constructor(t){super(t),this._viewpoint2D={center:n$p(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new M$1,this.id=0,this.inverseTransform=e$4(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$4(),this.transformNoRotation=e$4(),this.displayMat3=e$3(),this.displayViewMat3=e$3(),this.viewMat3=e$3(),this.viewMat2d=n$q(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=Z(i,t.viewpoint),this._set("size",a$m(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new V({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$3(s)?z$2(t,s,this.inverseTransform):(G[0]=s,G[1]=i,z$2(t,G,this.inverseTransform))}toScreen(t,s,i){return t$3(s)?z$2(t,s,this.transform):(G[0]=s,G[1]=i,z$2(t,G,this.transform))}toScreenNoRotation(t,s,i){return t$3(s)?z$2(t,s,this.transformNoRotation):(G[0]=s,G[1]=i,z$2(t,G,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return ut(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:i,scale:e,rotation:o}=this._viewpoint2D,c=this._get("pixelRatio")||1,m=this._get("size"),d=new u$a({targetGeometry:new j$3(t[0],t[1],i),scale:e,rotation:o});if(this._set("viewpoint",d),!m||!i||!e)return;this.resolution=ot(d),this.rotation=o,this.scale=e,this.spatialReference=i,a$m(this.center,t);const y=0!==m[0]?2/m[0]:0,_=0!==m[1]?-2/m[1]:0;s$j(this.displayMat3,y,0,0,0,_,0,-1,1,1);const x=r$g(this.viewMat3),z=t$h(m[0]/2,m[1]/2),g=t$h(-m[0]/2,-m[1]/2),b=o$i(o);M$3(x,x,z),h$b(x,x,b),M$3(x,x,g),i$j(this.displayViewMat3,this.displayMat3,x);const V=f$7(this.viewMat2d,z);return e$e(V,V,b),i$i(V,V,g),_$3(this.extent,d,m),ft(this.transform,d,m,c),r$e(this.inverseTransform,this.transform),lt(this.transformNoRotation,d,m,c),this.worldScreenWidth=yt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e$6([d$9({readOnly:!0})],O.prototype,"id",void 0),e$6([d$9({value:1,json:{write:!0}})],O.prototype,"pixelRatio",null),e$6([d$9({json:{write:!0}})],O.prototype,"size",null),e$6([d$9()],O.prototype,"spatialReference",void 0),e$6([d$9({type:u$a,json:{write:!0}})],O.prototype,"viewpoint",null),O=V=e$6([n$j("esri.views.2d.ViewState")],O);const U=O;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function t$2(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}function r$3(t,r){if("touch"===t.pointerType)return !1;switch(r){case"primary":return 0===t.button;case"secondary":return 2===t.button;case"tertiary":return 1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class t$1{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this._emitStart(t);break;case"added":this._emitEnd(this.previousEvent),this.currentCount=i,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this.startEvent&&this._emitEnd(this.previousEvent),this.currentCount=i,this._emitStart(t);break;case"end":this._emitEnd(t),this.currentCount=0;}this.previousEvent=t;}_emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}_emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}_emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function n$6(t){let n=t*t;return t<0&&(n*=-1),n}function a$7(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$3(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1,c=1;return "standard"===r.deviceType?(s.translation[0]=n$6(e.axes[0]),s.translation[1]=n$6(e.axes[1]),s.translation[2]=n$6(e.buttons[7])-n$6(e.buttons[6]),s.heading=n$6(e.axes[2]),s.tilt=n$6(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$6(e.axes[0]),s.translation[1]=1.2*n$6(e.axes[1]),s.translation[2]=2*-n$6(e.axes[2]),s.heading=1.2*n$6(e.axes[5]),s.tilt=1.2*n$6(e.axes[3])),s.tilt*=l,q$1(s.translation,s.translation,c),s}function o$3(t,n){const a=n;return a.translation[0]=t[1]-t[0],a.translation[1]=t[3]-t[2],a.translation[2]=t[4]-t[5],a.heading=t[7]-t[6],a.tilt=t[8]-t[9],a.zoom=t[10]-t[11],a}function s$6(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function t(t){const n=t.native;return n?{buttons:n.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:n.axes.map((n=>s$5(n,t.axisThreshold)))}:{buttons:[],axes:[]}}function n$5(t,n){if(t.axes.length!==n.axes.length)return !1;if(t.buttons.length!==n.buttons.length)return !1;for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==n.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==n.buttons[e])return !1;return !0}function e$2(t){for(let n=0;n<t.axes.length;n++)if(0!==t.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(0!==t.buttons[n])return !1;return !0}function s$5(t,n){const e=Math.abs(t);return e<n?0:Math.sign(t)*(e-n)/(1-n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class a$6{constructor(e,t$1){this.element=e,this.input=t$1,this._hasEventListeners=!1,this._onConnectGamepad=e=>{this._connectGamepad(e.gamepad);},this._onDisconnectGamepad=e=>{const t$1=e.gamepad,i=t$1.index,n=this.inputDevices[i];n&&(this._emitGamepadEvent(t$1,t(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this._forEachGamepad((e=>this._connectGamepad(e))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}_connectGamepad(e){const s=new i$5(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this._startPolling():this._stopPolling();}_startPolling(){null==this.frameTask&&(this.frameTask=A$1({update:()=>this._readGamepadState()}));}_stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}_readGamepadState(){const e=document.hasFocus(),t$1=this.element.contains(document.activeElement),a="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t$1;this._forEachGamepad((e=>{const t$1=this.inputDevices[e.index];if(!t$1)return;const d=this.latestUpdate[e.index],o=t(t$1),r=a||e$2(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$5(d.state,o))return}this._emitGamepadEvent(e,o,!r);}));}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this._validate(i)&&e(i);}}_emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?"start":n&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a});}_validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const o$2=a$f("trident"),a$5=a$f("edge"),s$4=a$f("chrome"),r$2=a$f("ff"),h$2=a$f("safari"),l$4={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class u$4{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new a$6(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(c$6[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&c$6[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(c$6[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$4.touchNone:l$4.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?l$4.touchPan:l$4.touchNone);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$4.touchNone),this._element.classList.remove(l$4.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(t){}}_updateNormalizedPointerLikeEvent(e,t){const n=i$6(this._element,e);return u$4.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,n){const i=a$e(n);i&&"key-up"===e&&this._keyDownState.delete(i);const o={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(o.key),this._callback(e,o);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(o$2||a$5)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}o$2||a$5?n*=.7:s$4||h$2?n*=.6:r$2&&(n*=1.375);const i=100,l=Math.abs(n);if(l>i){const e=.02;n=n/l*200/(1+Math.exp(-e*(l-i)));}const u=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,u);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}u$4.test={disableSubpixelCoordinates:!1};const c$6={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e$1 extends i$d{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function e(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$4(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$1(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:c$k()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=c$k(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const s$3={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class a$4 extends i$d{constructor(t=s$3.maximumDoubleClickDelay,i=s$3.maximumDoubleClickDistance,o=s$3.maximumDoubleTouchDelay,l=s$3.maximumDoubleTouchDistance,a=t$i){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=l,this._clock=a,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>e.doubleClickTimeout=a$j(e.doubleClickTimeout)));}get hasPendingInputs(){return n$n(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e$1){const t=e$1.data,i=this._pointerId(t),o=this._pointerState.get(i);if(o){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(o.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e$1)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(o.event.data,void 0,o.event.modifiers));}else this._startClick(e$1);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class s$2 extends i$d{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this));}_createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(t){const e=t.native.pointerId,i=a$3(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$1(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(i);}_updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this._addPointer(t);}_removePointer(t){const e=a$3(this.activePointerMap).angle;this.activePointerMap.delete(t),this._updatePointerAngles(e);}_updatePointerAngles(t){const e=a$3(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$1(i,e)-t,i.lastAngle=h$1(i,e)-t;}));}_emitEvent(t,e,i){const n=a$3(this.activePointerMap);this.drag.emit(this._createPayload(t,e,n,i),void 0,this.startStateModifiers);}_handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=n$r(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this._updatePointer(t.data),!this.isCurrentDragSuppressed&&this._emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",t.data,n$r(t.timestamp))));}_handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=n$r(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this.isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this._updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this._emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(c$k(e.event.x,e.event.y));})),r$1(i)}function a$3(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h$1(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$1(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$4;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$4||(p$4={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class n$3 extends i$d{constructor(e=s$3.maximumDoubleClickDelay,o=s$3.maximumDoubleClickDistance,n=s$3.maximumDoubleTouchDelay,a=s$3.maximumDoubleTouchDistance,s=t$i){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=o,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e$1){const i=t.data,n=this._pointerId(i),a=this._pointerState.get(n);if(a&&"pointer-up"===e$1&&a.downButton===i.native.button){const e$1=a.immediateDoubleClick;if(e$1){e$1.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(e$1,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e$1.modifiers),this._removeState(i));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const n$2={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o extends i$d{constructor(e=n$2.maximumClickDelay,i=n$2.movementUntilMouseDrag,o=n$2.movementUntilPenDrag,r=n$2.movementUntilTouchDrag,s=n$2.holdDelay,a=t$i){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$4(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this._startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}}_startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function i$2(i){const s=l$d(i);if(!s.available)return new s$f("webgl:required","WebGL is required but not supported.");if("3d"===i&&s.majorPerformanceCaveat)return new s$f("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!s.supportsHighPrecisionFragment)return new s$f("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!s.supportsVertexShaderSamplers)return new s$f("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(s.type===o$k.WEBGL1){if(!s.supportsElementIndexUint)return new s$f("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!s.supportsStandardDerivatives)return new s$f("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!s.supportsInstancedArrays)return new s$f("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function i$1(t){return t&&"nodeType"in t}function d$4(t){return t&&"function"==typeof t.render}const c$5={component:"esri-component"};let p$3=class extends y$4{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const o=this._get("node");t!==o&&(t&&t.classList.add(c$5.component),o&&o.classList.remove(c$5.component),this._set("node",t));}castNode(t){return t?"string"==typeof t||i$1(t)?(this._set("widget",null),e$d(t)):(d$4(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e$6([d$9({dependsOn:[]})],p$3.prototype,"id",null),e$6([d$9()],p$3.prototype,"node",null),e$6([s$h("node")],p$3.prototype,"castNode",null),e$6([d$9({readOnly:!0})],p$3.prototype,"widget",void 0),p$3=e$6([n$j("esri.views.ui.Component")],p$3);const l$3=p$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const m$2={left:0,top:0,bottom:0,right:0},u$3={bottom:30,top:15,right:15,left:15},f$1="manual",_$2={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function g$3(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function y$1(t){const o=t,i="object"==typeof o&&null!==o&&Object.getPrototypeOf(o);return (null===i||i===Object.prototype)&&("component"in o||"index"in o||"position"in o)?t:null}function C(t,{top:o,bottom:i,left:e,right:n}){t.style.top=o,t.style.bottom=i,t.style.left=e,t.style.right=n;}let v=class extends n$k.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$9,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&C(t,this._toPxPosition(this._getViewPadding()));},this._applyUIPadding=()=>{const t=this._innerContainer;t&&C(t,this._toPxPosition(this.padding));},this._initContainers();}initialize(){this._handles.add([l$8((()=>[this.view?.padding,this.container]),this._applyViewPadding,h$7),l$8((()=>this.padding),this._applyUIPadding,h$7)]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(_$2.ui),n$s(t),this._attachContainers(t)),i&&(i.classList.remove(_$2.ui),C(i,{top:"",bottom:"",left:"",right:""}),t$g(i)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.top+o.bottom;return Math.max(t-i,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...u$3,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.left+o.right;return Math.max(t-i,0)}add(t,o){let i,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,o)));const n=y$1(t);n&&({index:i,position:o,component:t,key:e}=n),o&&"object"==typeof o&&({index:i,key:e,position:o}=o),!t||o&&!this._isValidPosition(o)||this._add(t,o,i,e);}remove(t,o){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,o)));const i=this._find(t);if(i){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==o)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,o)=>t.concat(o)));if((t=t||f$1)===f$1){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(_$2.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,o){if(Array.isArray(t)&&t.forEach((t=>this.move(t,o))),!t)return;let i;const e=y$1(t)||y$1(o);if(e&&(i=e.index,o=e.position,t=e.component||t),o&&!this._isValidPosition(o))return;const n=this.remove(t);n&&this.add(n,{position:o,index:i});}find(t){if(!t)return null;const o=this._findById(t);return o&&(o.widget||o.node)}getPosition(t){for(const o in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[o].contains(t))return o}return null}_add(t,o,i,e){t instanceof l$3||(t=new l$3({node:t})),this._place({component:t,position:o,index:i}),this._components.push(t),e&&this._componentToKey.set(t,e);}_find(t){return t?t instanceof l$3?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||m$2}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(_$2.innerContainer),t.classList.add(_$2.cornerContainer);const o=document.createElement("div");o.classList.add(_$2.innerContainer),o.classList.add(_$2.manualContainer);const i=document.createElement("div");i.classList.add(_$2.topLeft),i.classList.add(_$2.corner),t.appendChild(i);const e=document.createElement("div");e.classList.add(_$2.topRight),e.classList.add(_$2.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(_$2.bottomLeft),n.classList.add(_$2.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(_$2.bottomRight),r.classList.add(_$2.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=o;const s=f$5();this._cornerNameToContainerLookup={"top-left":i,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:i,"top-trailing":s?i:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:o,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const o=t.component,e=t.position||f$1,n=t.index,r=this._positionNameToContainerLookup[e],s=n>-1;if(g$3(o.widget)&&o.widget.startup(),!s)return void r.appendChild(o.node);const a=Array.prototype.slice.call(r.children);if(0===n)return void(r.firstChild?o$l(o.node,r.firstChild):r.appendChild(o.node));n>=a.length?r.appendChild(o.node):o$l(o.node,a[n]);}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let o,i=null;return this._components.some((e=>(o=e===t,o&&(i=e),o))),i}_findById(t){let o,i=null;return this._components.some((e=>(o=e.id===t,o&&(i=e),o))),i}_findByNode(t){let o,i=null;return this._components.some((e=>(o=e.node===t,o&&(i=e),o))),i}};e$6([d$9()],v.prototype,"container",null),e$6([d$9()],v.prototype,"height",null),e$6([d$9({value:u$3})],v.prototype,"padding",null),e$6([s$h("padding")],v.prototype,"castPadding",null),e$6([d$9()],v.prototype,"view",void 0),e$6([d$9()],v.prototype,"width",null),v=e$6([n$j("esri.views.ui.UI")],v);const L=v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function d$3(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function m$1(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function f(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}function y(t){return "bing-maps"===t.type}const b=[];let g$2=class extends d$a{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new j$2,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>l$8((()=>[t.suspended,t.layer?.attributionVisible]),(()=>this._updateAttributionItems())))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this.handles.add([a$i((()=>this.view?.allLayerViews),"change",(t=>this._allLayerViewsChange(t)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),f$4((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.get("view.allLayerViews");b.length=0,t?(t.forEach((t=>{if(t.suspended||!t.layer?.attributionVisible)return;const e=t.layer;if(d$3(e,"user"))return void f(b,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?f(b,t,this._getDynamicAttribution(i,this.view,e)):d$3(e)&&f(b,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");f(b,t,i||e.copyright);})),m$1(this.items,b)&&(this.items.removeAll(),this.items.addMany(b)),b.length=0,this.notifyChange("state")):this._clear();}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await a$n(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const e=i.ok?this._createContributionIndex(i.value,y(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,e);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,r={};if(!i)return r;for(let s=0;s<i.length;s++){const t=i[s],o=t.coverageAreas;if(!o)return;for(const i of o){const o=i.bbox,n=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),c={xmin:o[1],ymin:o[0],xmax:o[3],ymax:o[2],spatialReference:k.WGS84},u={extent:R$2(c),attribution:t.attribution||"",score:null!=i.score?i.score:100,id:s};for(let t=n;t<=a;t++)r[t]=r[t]||[],r[t].push(u);}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,i){const{extent:r,scale:s}=e;let o=i.tileInfo.scaleToZoom(s);if(o=Math.min(t.maxKey,Math.round(o)),!r||null==o||o<=-1)return "";const n=t[o],a=M$4(r.center.clone().normalize(),e.spatialReference),c={};return n?n.filter((t=>{const e=!c[t.id]&&a&&r$h(t.extent,a);return e&&(c[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e$6([d$9({readOnly:!0,type:j$2})],g$2.prototype,"items",void 0),e$6([d$9({readOnly:!0})],g$2.prototype,"state",null),e$6([d$9()],g$2.prototype,"view",void 0),g$2=e$6([n$j("esri.widgets.Attribution.AttributionViewModel")],g$2);const _$1=g$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const d$2={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let l$2=class extends O$1{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((e=>e.forEach((({target:e})=>this._checkSourceTextOverflow(e))))),this.iconClass=d$2.widgetIcon,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new _$1;}initialize(){this.own(a$i((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())));}destroy(){this._resizeObserver?.disconnect();}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(e.includes(t.text)||e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[d$2.open]:this._isOpen};return n$l("div",{bind:this,class:this.classes(d$2.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return n$l("div",{class:d$2.poweredBy},"Powered by"," ",n$l("a",{class:d$2.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?"0":"",{attributionText:r}=this,s={[d$2.sourcesOpen]:e,[d$2.interactive]:t};return n$l("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(d$2.sources,s),innerHTML:r,tabindex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e);}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:s}=e,o=s>r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen);}};e$6([d$9()],l$2.prototype,"_isOpen",void 0),e$6([d$9()],l$2.prototype,"_isInteractive",null),e$6([d$9()],l$2.prototype,"_attributionTextOverflowed",void 0),e$6([d$9()],l$2.prototype,"_prevSourceNodeHeight",void 0),e$6([d$9({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],l$2.prototype,"attributionText",null),e$6([d$9()],l$2.prototype,"iconClass",void 0),e$6([d$9()],l$2.prototype,"itemDelimiter",void 0),e$6([d$9({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$2.prototype,"label",void 0),e$6([d$9(),e$c("esri/widgets/Attribution/t9n/Attribution")],l$2.prototype,"messages",void 0),e$6([o$g("viewModel.view")],l$2.prototype,"view",void 0),e$6([d$9({type:_$1})],l$2.prototype,"viewModel",void 0),e$6([t$f()],l$2.prototype,"_toggleState",null),l$2=e$6([n$j("esri.widgets.Attribution")],l$2);const u$2=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const p$2="esri.widgets.CompassViewModel";let d$1=class extends(e$8(y$4)){constructor(t){super(t),this._handles=new u$9,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this);}initialize(){this._handles.add(l$8((()=>this.view),this._updateRotationWatcher,h$7));}destroy(){this._handles=a$j(this._handles),this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const o=-t.heading;this.orientation={x:0,y:0,z:o};}_updateRotationWatcher(t){this._handles.removeAll(),t&&this._handles.add("2d"===t.type?l$8((()=>t?.rotation),this._updateForRotation,h$7):l$8((()=>t?.camera),this._updateForCamera,h$7));}};e$6([d$9({readOnly:!0})],d$1.prototype,"canShowNorth",null),e$6([d$9()],d$1.prototype,"orientation",void 0),e$6([d$9({readOnly:!0})],d$1.prototype,"state",null),e$6([d$9()],d$1.prototype,"view",void 0),d$1=e$6([n$j(p$2)],d$1);const c$4=d$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const p$1={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let l$1=class extends O$1{constructor(s,e){super(s,e),this.goToOverride=null,this.iconClass=p$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new c$4;}reset(){return this.viewModel.reset()}render(){const{orientation:s,state:e}=this.viewModel,o="disabled"===e,t="compass"===("rotation"===e?"rotation":"compass"),r=o?-1:0,i={[p$1.disabled]:o,[p$1.interactive]:!o},a={[p$1.northIcon]:t,[p$1.rotationIcon]:!t},{messages:c}=this;return n$l("div",{bind:this,class:this.classes(p$1.base,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":c.reset,title:c.reset},n$l("span",{"aria-hidden":"true",class:this.classes(p$1.icon,a),styles:this._toRotationTransform(s)}),n$l("span",{class:p$1.text},c.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(s){return {transform:`rotateZ(${s.z}deg)`}}};e$6([o$g("viewModel.goToOverride")],l$1.prototype,"goToOverride",void 0),e$6([d$9()],l$1.prototype,"iconClass",void 0),e$6([d$9({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$1.prototype,"label",void 0),e$6([d$9(),e$c("esri/widgets/Compass/t9n/Compass")],l$1.prototype,"messages",void 0),e$6([o$g("viewModel.view")],l$1.prototype,"view",void 0),e$6([d$9({type:c$4})],l$1.prototype,"viewModel",void 0),e$6([t$f()],l$1.prototype,"_reset",null),l$1=e$6([n$j("esri.widgets.Compass")],l$1);const d=l$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let a$2=class extends y$4{constructor(t){super(t),this._handles=new u$9,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(f$4((()=>this.view?.inputManager),(()=>this._setNavigationMode())));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e$6([d$9({readOnly:!0})],a$2.prototype,"state",null),e$6([d$9()],a$2.prototype,"navigationMode",void 0),e$6([d$9()],a$2.prototype,"view",void 0),a$2=e$6([n$j("esri.widgets.NavigationToggleViewModel")],a$2);const n$1=a$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const g$1={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let p=class extends O$1{constructor(t,o){super(t,o),this.iconClass=g$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1;}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t);}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),o="pan"===this.get("viewModel.navigationMode"),e={[g$1.disabled]:t,[g$1.isLayoutHorizontal]:"horizontal"===this.layout},s={[g$1.activeButton]:o},i={[g$1.activeButton]:!o},a=t?-1:0,r=this.messages.toggle;return n$l("div",{bind:this,class:this.classes(g$1.base,e),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":r,title:r},n$l("div",{class:this.classes(g$1.button,g$1.panButton,s)},n$l("span",{class:g$1.panIcon})),n$l("div",{class:this.classes(g$1.button,g$1.rotateButton,i)},n$l("span",{class:g$1.rotationIcon})))}_toggle(){this.toggle();}};e$6([d$9()],p.prototype,"iconClass",void 0),e$6([d$9({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],p.prototype,"label",void 0),e$6([d$9({value:"vertical"})],p.prototype,"layout",null),e$6([d$9(),e$c("esri/widgets/NavigationToggle/t9n/NavigationToggle")],p.prototype,"messages",void 0),e$6([o$g("viewModel.view")],p.prototype,"view",void 0),e$6([d$9({type:n$1})],p.prototype,"viewModel",void 0),e$6([t$f()],p.prototype,"_toggle",null),p=e$6([n$j("esri.widgets.NavigationToggle")],p);const c$3=p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const c$2={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let n=class extends O$1{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[c$2.disabled]:!this.enabled,[c$2.interactive]:this.enabled},i={[this.iconClass]:!!this.iconClass};return n$l("div",{bind:this,class:this.classes(c$2.button,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},n$l("span",{"aria-hidden":"true",role:"presentation",class:this.classes(c$2.icon,i)}),n$l("span",{class:c$2.iconText},this.title))}_triggerAction(){this.action.call(this);}};e$6([d$9()],n.prototype,"action",void 0),e$6([d$9()],n.prototype,"enabled",void 0),e$6([d$9()],n.prototype,"iconClass",void 0),e$6([d$9()],n.prototype,"title",void 0),e$6([t$f()],n.prototype,"_triggerAction",null),n=e$6([n$j("esri.widgets.IconButton")],n);const a$1=n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let s$1=class extends y$4{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e$6([d$9({readOnly:!0})],s$1.prototype,"canZoomIn",null),e$6([d$9({readOnly:!0})],s$1.prototype,"canZoomOut",null),e$6([d$9()],s$1.prototype,"view",void 0),s$1=e$6([n$j("esri.widgets.Zoom.ZoomConditions2D")],s$1);const i=s$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let s=class extends y$4{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e$6([d$9({readOnly:!0})],s.prototype,"canZoomIn",null),e$6([d$9({readOnly:!0})],s.prototype,"canZoomOut",null),e$6([d$9()],s.prototype,"view",void 0),s=e$6([n$j("esri.widgets.Zoom.ZoomConditions3D")],s);const c$1=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let m=class extends y$4{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i({view:o}):"3d"===o.type&&(this._zoomConditions=new c$1({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():j$6(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():j$6(o.goTo({zoomFactor:.5}));}};e$6([d$9()],m.prototype,"_zoomConditions",void 0),e$6([d$9({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m.prototype,"canZoomIn",void 0),e$6([d$9({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m.prototype,"canZoomOut",void 0),e$6([d$9({readOnly:!0})],m.prototype,"state",null),e$6([d$9()],m.prototype,"view",null),m=e$6([n$j("esri.widgets.Zoom.ZoomViewModel")],m);const a=m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const l={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let u$1=class extends O$1{constructor(o,t){super(o,t),this.iconClass=l.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new a;}initialize(){this._zoomInButton=new a$1({action:this.zoomIn.bind(this),iconClass:l.zoomInIcon}),this._zoomOutButton=new a$1({action:this.zoomOut.bind(this),iconClass:l.zoomOutIcon});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[l.horizontalLayout]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,n$l("div",{class:this.classes(l.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e$6([d$9()],u$1.prototype,"iconClass",void 0),e$6([d$9({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],u$1.prototype,"label",void 0),e$6([d$9({value:"vertical"})],u$1.prototype,"layout",null),e$6([d$9(),e$c("esri/widgets/Zoom/t9n/Zoom")],u$1.prototype,"messages",void 0),e$6([o$g("viewModel.view")],u$1.prototype,"view",void 0),e$6([d$9({type:a})],u$1.prototype,"viewModel",void 0),u$1=e$6([n$j("esri.widgets.Zoom")],u$1);const c=u$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const h="esri.views.ui.DefaultUI";function u(t){return t&&void 0!==t.view}s$e.getLogger(h);let g=class extends L{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[];}initialize(){this._handles.add([l$8((()=>this.components),this._componentsWatcher.bind(this),h$7),l$8((()=>this.view),this._updateViewAwareWidgets.bind(this),h$7)]);}_add(t,o,e,i){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,e,i);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const e=this._find(o),i=e&&e.widget;u(i)&&(i.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new l$3({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new u$2({view:this.view})}_createCompass(){return new d({view:this.view})}_createNavigationToggle(){return new c$3({view:this.view})}_createZoom(){return new c({view:this.view})}};e$6([d$9()],g.prototype,"components",void 0),g=e$6([n$j(h)],g);const _=g;

export { $, o$7 as A, r$7 as B, i$2 as C, ht as D, pt as E, r$3 as F, Gt as G, H, o$3 as I, o$d as J, i$9 as K, r$5 as L, e$3 as M, n$e as N, nt as O, bt as P, mt as Q, Rt as R, St as S, t$3 as T, U, t$4 as V, c$a as W, u$6 as X, Y, Z, _, t$1 as a, t$6 as a0, o$9 as a1, w$1 as a2, t$7 as a3, n$d as a4, a$7 as b, i$3 as c, s$3 as d, e, n$3 as f, gt as g, a$4 as h, i$d as i, s$2 as j, c$e as k, e$1 as l, g$7 as m, n$a as n, o, g$5 as p, p$d as q, G$1 as r, s$6 as s, t$2 as t, u$4 as u, tt as v, w$3 as w, xt as x, wt as y, jt as z };
