import { t as t$4, r as r$6, e as e$7, d as d$5, I as s$3, V as a$4, n as n$3, h as e$8, ag as c$4, s as s$7, z as r$b, bz as t$6, y as y$3, aL as h$4, aF as n$9, aK as C$1, X as f$2, w as p$b, v as n$b, az as t$7, C as x$2, ax as j$a, l as a$7, as as o$5, H as l$a } from './cast-3d5be210.js';
import { j as j$9, n as n$a } from './Collection-a38e0489.js';
import { l as l$4, U as U$1, w as w$1, h as h$5, a as a$9 } from './reactiveUtils-bd6fe823.js';
import { n as n$4, C as C$2, a as n$d } from './LineVisualElement-0571b2ba.js';
import { c as c$5 } from './vectorStacks-3fa8ee55.js';
import { l as l$3 } from './Color-25ce730a.js';
import './geometry-2f332a26.js';
import { a as a$3 } from './Clonable-533c7a05.js';
import { s as s$4 } from './Cyclical-922b1741.js';
import { M as M$3 } from './Extent-f27111e1.js';
import { j as j$2, E as E$4 } from './Point-edff2a11.js';
import { d as d$8 } from './HandleOwner-fe336959.js';
import { u as u$2 } from './Handles-54afc0a7.js';
import { aS as H$2, T as T$3, aV as n$8, aW as Z$1, aQ as r$f } from './SceneView-ed3703c9.js';
import { u as u$1, i as i$6 } from './screenUtils-31d073db.js';
import { G as G$2, y as y$5, p as p$c, z as z$3, a as a$8, c as c$7, m as m$a, s as s$8 } from './analysisViewUtils-869adced.js';
import { n as n$5, r as r$7, b as r$9, e as e$9, F as F$1, Q as D, B as a$5, k as j$3, z as z$1, u as u$3, A as A$1, aa as g$3, P as P$2, a1 as J, _ as _$3, a0 as G$3, a5 as f$3, x as x$5, a as o$7 } from './mathUtils-559a53d9.js';
import { r as r$8, b as t$5 } from './DefaultVertexAttributeLayouts-664d07a8.js';
import { G as p$9, M as m$5, N as l$6, R as v$3, S as s$5 } from './frustum-95850b85.js';
import { l as l$5, j as j$4, v as v$4 } from './lineSegment-99193ade.js';
import { d as d$6, p as p$8, L as L$4, n as n$c } from './sphere-4710475c.js';
import { _ as _$2, S as S$2 } from './PointVisualElement-0396d7c0.js';
import { aa as h$3 } from './objectResourceUtils-e575a410.js';
import { O } from './VertexAttribute-ef09ced9.js';
import { v as v$5, o as o$4, l as l$7, r as r$a, s as s$6, b as b$2, j as j$8, a as a$6, p as p$a, d as d$9, A as A$2, m as m$8 } from './vec2-4f9a494f.js';
import { j as j$5 } from './RightAngleQuadVisualElement-bde59657.js';
import { l as l$8 } from './JSONSupport-dce2c67b.js';
import { c as l$9, j as j$6, R as R$1, l as l$b, v as v$7, b as v$8, o as o$6 } from './Segment-ff1a2d80.js';
import { z as z$2, B } from './dragEventPipeline3D-c2dc6030.js';
import { y as y$4, b as b$3, d as d$7, j as j$7, v as v$6, E as E$2, N as N$1, L as L$3, m as m$6, S as S$3, g as g$2, x as x$3, i as i$7 } from './EditGeometryOperations-b01ec575.js';
import { E as E$3 } from './QueryEngineResult-4211c0f6.js';
import { a as n$7 } from './LercDecoder-0b4fb3f9.js';
import { m as m$7 } from './elevationInfoUtils-d6676eee.js';
import { n as n$6, r as r$c } from './vec2f64-2956001b.js';
import { r as r$d } from './dehydratedFeatures-7b45465d.js';
import { L as L$5, Q } from './Scheduler-ed7a36dc.js';
import { x as x$4, s as t$8 } from './viewpointUtils-4c294048.js';
import { W as c$6 } from './DefaultUI-a0db5719.js';
import { r as r$e } from './vec4f64-011248e0.js';
import { m as m$9 } from './number-c5a37d3e.js';
import { g as ee, s as se } from './unitUtils-a0a11e54.js';
import { B as Bn } from './projection-fbd5d346.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const t$3=["horizontal","vertical","direct"];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let y$2=class extends a$3{constructor(t){super(t),this.type="length",this.startPoint=null,this.endPoint=null,this.axis="horizontal",this.offset=0,this.heading=0;}get extent(){if(t$4(this.startPoint))return null;const t=M$3.fromPoint(this.startPoint);return r$6(this.endPoint)&&t.union(M$3.fromPoint(this.endPoint)),t}};e$7([d$5({type:["length"]})],y$2.prototype,"type",void 0),e$7([d$5({type:j$2})],y$2.prototype,"startPoint",void 0),e$7([d$5({type:j$2})],y$2.prototype,"endPoint",void 0),e$7([d$5({type:t$3,nonNullable:!0})],y$2.prototype,"axis",void 0),e$7([d$5({type:Number,nonNullable:!0})],y$2.prototype,"offset",void 0),e$7([d$5({type:Number,nonNullable:!0}),s$3((t=>s$4.normalize(a$4(t),0,!0)))],y$2.prototype,"heading",void 0),e$7([d$5({readOnly:!0})],y$2.prototype,"extent",null),y$2=e$7([n$3("esri.analysis.LengthDimension")],y$2);const u=y$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const o$3={main:new l$3([255,127,0])};class i$5{constructor(){this.color=o$3.main,this.opacity=.5,this.radius=5;}}class r$5{constructor(){this.fontSize=14;}get height(){return 1.5*u$1(this.fontSize)}get offset(){return this.height+20}}class e$6{constructor(){this.pointManipulators=new i$5,this.labels=new r$5;}}const n$2=new e$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class G$1 extends n$4{constructor(t){super(t),this._ray=d$6(),this._externalResources=null,this._handles=new u$2,this._isWorldDown=!1,this._start=n$5(),this._end=r$7(1,0,0),this._width=1,this._color=r$8(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=r$8(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=V$1.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=h$3.OccludeAndTransparent,this._fadedExtensions=F,this.applyProps(t);}createExternalResources(){const e=new H$2(this.materialParameters);this._handles.add(l$4((()=>this.view.state.camera),(()=>{this._updateGeometry();})));const t=new _$2({view:this.view,attached:this._laserlineEnabled});this._externalResources={material:e,laserline:t};}destroyExternalResources(){r$6(this._externalResources)&&this._externalResources.laserline.destroy(),this._externalResources=null,this._handles.removeAll();}forEachExternalMaterial(e){r$6(this._externalResources)&&e(this._externalResources.material);}createGeometries(e){const t=[n$5(),n$5()],i=this.extensionType===V$1.FADED;i&&t.push(n$5(),n$5());const r=i?new Float32Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]):null,n=T$3.createPolylineGeometry(t,null,r);e.addGeometry(n,e$8(this._externalResources).material),this._updateVertices(e);}updateVisibility(e){super.updateVisibility(e),r$6(this._externalResources)&&(this._externalResources.laserline.visible=e);}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,r$9(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),e$9(this._end,e,this._end),p$8(this._start,this._end,this._ray),this._updateGeometry();}get start(){return this._start}set start(e){this._isWorldDown=!1,F$1(this._start,e)||(r$9(this._start,e),p$8(this._start,this._end,this._ray),this._updateGeometry());}get end(){return this._end}set end(e){this._isWorldDown=!1,F$1(this._end,e)||(r$9(this._end,e),p$8(this._start,this._end,this._ray),this._updateGeometry());}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get color(){return this._color}set color(e){D(e,this._color)||(a$5(this._color,e),this._updateMaterial());}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial());}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial());}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial());}get innerColor(){return this._innerColor}set innerColor(e){D(e,this._innerColor)||(a$5(this._innerColor,e),this._updateMaterial());}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const s=r$6(e)!==r$6(this._stipplePattern);this._stipplePattern=e,s?this.recreate():this._updateMaterial();}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){(t$4(e)||t$4(this._stippleOffColor)||!D(e,this._stippleOffColor))&&(this._stippleOffColor=r$6(e)?t$5(e):null,this._updateMaterial());}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial());}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial());}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this._updateGeometry());}get _laserlineAttached(){return this._laserlineEnabled&&r$6(this._laserlineStyle)}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,r$6(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached,r$6(e)&&(this._externalResources.laserline.style=e));}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,r$6(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached));}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=c$4(e,F),this.recreateGeometry();}_updateMaterial(){if(t$4(this._externalResources))return;this._externalResources.material.setParameters(this.materialParameters);}get materialParameters(){return {width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateGeometry(){r$6(this.object)&&this._updateVertices(this.object);}_updateVertices(e){const s=this._extensionType===V$1.FADED?this._updateLineSegmentFinite(T$2):this._updateLineSegmentInfinite(this._extensionType,T$2);this._updateVertexAttributes(e,s),r$6(this._externalResources)&&(this._externalResources.laserline.intersectsLine=s);}_updateLineSegmentFinite(e){return l$5(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const s=this.view.state.camera;switch(p$9(this._ray,W),e){case V$1.LINE:W.c0=-Number.MAX_VALUE;break;case V$1.RAY:case V$1.GROUND_RAY:{const e=this._ray.origin,t=c$4(this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),s=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&s<t&&j$3(W.ray.direction,W.ray.direction),this._extensionType===V$1.GROUND_RAY&&null!=t&&(W.c1=Math.abs(s-t));break}}if(!m$5(s.frustum,W))return l$5(this._start,this._end,t);const i=l$6(W,L$2),n=v$3(W,S$1);return l$5(i,n,t)}_updateVertexAttributes(e,t){const s=e.geometries[0].getMutableAttribute(O.POSITION).data;if(this.extensionType===V$1.FADED){const e=j$4(t,-this.fadedExtensions.start,L$2);s[0]=e[0],s[1]=e[1],s[2]=e[2];const i=j$4(t,0,L$2);s[3]=i[0],s[4]=i[1],s[5]=i[2];const r=j$4(t,1,L$2);s[6]=r[0],s[7]=r[1],s[8]=r[2];const n=j$4(t,1+this.fadedExtensions.end,L$2);s[9]=n[0],s[10]=n[1],s[11]=n[2];}else {const e=j$4(t,0,L$2);s[0]=e[0],s[1]=e[1],s[2]=e[2];const i=j$4(t,1,L$2);s[3]=i[0],s[4]=i[1],s[5]=i[2];}e.geometryVertexAttrsUpdated(e.geometryRecords[0]);}}const W=s$5(),L$2=n$5(),S$1=n$5(),T$2=v$4();var V$1;!function(e){e[e.LINE=0]="LINE",e[e.RAY=1]="RAY",e[e.GROUND_RAY=2]="GROUND_RAY",e[e.FADED=3]="FADED";}(V$1||(V$1={}));const N=1/3,F={start:N,end:N};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class v$2 extends n$4{constructor(t){super(t),this._handles=new u$2,this._location=n$5(),this._direction=r$7(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=r$8(1,0,1,1),this._renderOccluded=h$3.OccludeAndTransparent,this.applyProps(t);}get location(){return this._location}set location(e){F$1(this._location,e)||(r$9(this._location,e),this._updateGeometry());}get direction(){return this._direction}set direction(e){F$1(this._direction,e)||(r$9(this._direction,e),this._updateGeometry());}setDirectionFromPoints(e,t){z$1(this._direction,e$9(this._direction,t,e)),this._updateGeometry();}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry());}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry());}get color(){return this._color}set color(e){D(e,this._color)||(a$5(this._color,e),this._updateMaterial());}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}createExternalResources(){const e=new H$2(this.materialParameters);this._handles.add(l$4((()=>this.view.state.camera),(()=>{this._updateGeometry();}))),this._externalResources={material:e};}destroyExternalResources(){this._handles.removeAll(),this._externalResources=null;}createGeometries(e){const r=T$3.createPolylineGeometry([n$5(),n$5()]),s=T$3.createPolylineGeometry([n$5(),n$5()]),i=e$8(this._externalResources).material;e.addGeometry(r,i),e.addGeometry(s,i),this._updateVertices(e);}forEachExternalMaterial(e){r$6(this._externalResources)&&e(this._externalResources.material);}_updateMaterial(){if(t$4(this._externalResources))return;this._externalResources.material.setParameters(this.materialParameters);}get materialParameters(){return {width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){const e=this.object;t$4(e)||this._updateVertices(e);}_updateVertices(e){const t=this.view.state.camera;t.projectToScreen(this.location,V),u$3(P$1,this.location,this.direction),t.projectToScreen(P$1,A),v$5(A,o$4(A,A,V)),this._updateVertexAttributes(t,e,0,V,A,1),this._updateVertexAttributes(t,e,1,V,A,-1);}_updateVertexAttributes(e,t,r,s,i,o){const a=t.geometryRecords[r],c=a.geometry.getMutableAttribute(O.POSITION).data,d=l$7(M$2,r$a(M$2,i[1]*o,i[0]*-o),this.offset+this.width/2),m=s$6(k$1,s$6(k$1,s$6(k$1,s,l$7(k$1,i,this.length/2)),d),d),u=s$6(E$1,m,l$7(E$1,i,-this.length));e.unprojectFromScreen(m,P$1),c[0]=P$1[0],c[1]=P$1[1],c[2]=P$1[2],e.unprojectFromScreen(u,P$1),c[3]=P$1[0],c[4]=P$1[1],c[5]=P$1[2],t.geometryVertexAttrsUpdated(a);}}const P$1=n$5(),V=i$6(),A=i$6(),M$2=i$6(),k$1=i$6(),E$1=i$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let r$4=class extends l$8{constructor(){super(...arguments),this.enabled=!0;}};e$7([d$5({type:Boolean})],r$4.prototype,"enabled",void 0),r$4=e$7([n$3("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],r$4);let l$2=class extends l$8{constructor(e){super(e),this.lineSnapper=new r$4,this.parallelLineSnapper=new r$4,this.rightAngleSnapper=new r$4,this.rightAngleTriangleSnapper=new r$4,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new l$3([255,127,0]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5;}};e$7([d$5({type:r$4,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l$2.prototype,"lineSnapper",void 0),e$7([d$5({type:r$4,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l$2.prototype,"parallelLineSnapper",void 0),e$7([d$5({type:r$4,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l$2.prototype,"rightAngleSnapper",void 0),e$7([d$5({type:r$4,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l$2.prototype,"rightAngleTriangleSnapper",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l$2.prototype,"shortLineThreshold",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l$2.prototype,"distance",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],l$2.prototype,"pointThreshold",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],l$2.prototype,"intersectionParallelLineThreshold",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],l$2.prototype,"parallelLineThreshold",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l$2.prototype,"touchSensitivityMultiplier",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],l$2.prototype,"pointOnLineThreshold",void 0),e$7([d$5({type:l$3,nonNullable:!0})],l$2.prototype,"orange",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l$2.prototype,"lineHintWidthReference",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l$2.prototype,"lineHintWidthTarget",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],l$2.prototype,"lineHintFadedExtensions",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l$2.prototype,"parallelLineHintWidth",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],l$2.prototype,"parallelLineHintLength",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],l$2.prototype,"parallelLineHintOffset",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],l$2.prototype,"rightAngleHintSize",void 0),e$7([d$5({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],l$2.prototype,"rightAngleHintOutlineSize",void 0),l$2=e$7([n$3("esri.views.interactive.snapping.Settings.Defaults")],l$2);const p$7=new l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function E(t,E){const n=t.x-E.x,r=t.y-E.y;return n*n+r*r}function n$1(t,E){const n=t.length===E.length&&t[0]===E[0]&&t[1]===E[1];switch(t.length){case 2:return n;case 3:return n&&t[2]===E[2];case 4:return n&&t[3]===E[3]}return !1}function r$3(E,n){n.sort(((n,r)=>b$2(n.targetPoint,E)-b$2(r.targetPoint,E)));}var e$5;!function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION";}(e$5||(e$5={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class o$2{constructor(o){this.elevationInfo=o;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class i$4 extends o$2{constructor(t,n){super(n),this.intersectionPoint=t;}equals(n){return n instanceof i$4&&n$1(this.intersectionPoint,n.intersectionPoint)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
s$7.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");class s$2 extends o$2{constructor(t,i,e,s,n=!0,r=!0){super(s),this.type=t,this.lineStart=i,this.lineEnd=e,this.fadeLeft=n,this.fadeRight=r;}equals(t){return t instanceof s$2&&(this.type===t.type&&n$1(this.lineStart,t.lineStart)&&n$1(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
s$7.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");class e$4 extends o$2{constructor(i,t,n){super(n),this.lineStart=i,this.lineEnd=t;}equals(i){return i instanceof e$4&&(n$1(this.lineStart,i.lineStart)&&n$1(this.lineEnd,i.lineEnd))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class s$1 extends o$2{constructor(t,n){super(n),this.point=t;}equals(n){return n instanceof s$1&&n$1(this.point,n.point)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
s$7.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");class i$3 extends o$2{constructor(e,t,r,i){super(i),this.previousVertex=e,this.centerVertex=t,this.nextVertex=r;}equals(e){return e instanceof i$3&&(n$1(this.previousVertex,e.previousVertex)&&n$1(this.centerVertex,e.centerVertex)&&n$1(this.nextVertex,e.nextVertex))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class r$2{draw(r,a){const p=this._getUniqueHints(r),h=[];for(const i of p)i instanceof i$4&&h.push(this.visualizeIntersectionPoint(i,a)),i instanceof s$2&&h.push(this.visualizeLine(i,a)),i instanceof e$4&&h.push(this.visualizeParallelSign(i,a)),i instanceof i$3&&h.push(this.visualizeRightAngleQuad(i,a)),i instanceof s$1&&h.push(this.visualizePoint(i,a));return r$b(h)}_getUniqueHints(i){const n=[];for(const t of i){let i=!0;for(const s of n)if(t.equals(s)){i=!1;break}i&&n.push(t);}return n}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class g$1 extends r$2{visualizeIntersectionPoint(i,o){const{coordinateHelper:r,view:a}=o;return t$6(new S$2({view:a,primitive:"circle",geometry:r.vectorToPoint(i.intersectionPoint),elevationInfo:c$4(i.elevationInfo,o.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:l$3.toUnitRGBA(p$7.orange),pixelSnappingEnabled:!1}))}visualizePoint(i,o){const{coordinateHelper:r,view:a}=o;return t$6(new S$2({view:a,primitive:"circle",geometry:r.vectorToPoint(i.point),elevationInfo:c$4(i.elevationInfo,o.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:l$3.toUnitRGBA(p$7.orange),pixelSnappingEnabled:!1}))}visualizeLine(e,i){const{coordinateHelper:o,view:r}=i;return t$6(this._createLineSegmentHintFromMap(e.type,e.lineStart,e.lineEnd,o,c$4(e.elevationInfo,i.elevationInfo),r,e.fadeLeft,e.fadeRight))}visualizeParallelSign(o,r){const{coordinateHelper:a,view:s}=r,c=c$4(o.elevationInfo,r.elevationInfo),m=l$9(o.lineStart,a,c,r.view),v=l$9(o.lineEnd,a,c,r.view),f=A$1(v,m,v,.5),g=new v$2({view:s,attached:!1,offset:p$7.parallelLineHintOffset,length:p$7.parallelLineHintLength,width:p$7.parallelLineHintWidth,color:l$3.toUnitRGBA(p$7.orange),location:f,renderOccluded:h$3.Opaque});return g.setDirectionFromPoints(m,f),g.attached=!0,t$6(g)}visualizeRightAngleQuad(i,o){const{coordinateHelper:r,view:a}=o,l=c$4(i.elevationInfo,o.elevationInfo);return t$6(new j$5({view:a,attached:!0,color:l$3.toUnitRGBA(p$7.orange),renderOccluded:h$3.Transparent,outlineRenderOccluded:h$3.Opaque,outlineColor:l$3.toUnitRGBA(p$7.orange),outlineSize:p$7.rightAngleHintOutlineSize,size:p$7.rightAngleHintSize,geometry:{previous:l$9(i.previousVertex,r,l,a),center:l$9(i.centerVertex,r,l,a),next:l$9(i.nextVertex,r,l,a)}}))}_createLineSegmentHintFromMap(e,n,t,i,r,a,l=!0,s=!0){const c=n$5(),d=n$5();return j$6(n,t,i,r,a,c,d),this._createLineSegmentHint(e,a,c,d,l,s)}_createLineSegmentHint(n,t,i,o,l=!0,s=!0){const c=new G$1({view:t,extensionType:V$1.FADED,start:i,end:o,color:l$3.toUnitRGBA(p$7.orange),renderOccluded:h$3.Opaque});switch(n){case e$5.TARGET:c.width=p$7.lineHintWidthTarget,c.fadedExtensions={start:0,end:p$7.lineHintFadedExtensions};break;case e$5.REFERENCE_EXTENSION:c.width=p$7.lineHintWidthReference,c.fadedExtensions={start:0,end:0};break;case e$5.REFERENCE:c.width=p$7.lineHintWidthReference,c.fadedExtensions={start:l?p$7.lineHintFadedExtensions:0,end:s?p$7.lineHintFadedExtensions:0};}return c.attached=!0,c}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let e$3=class extends y$3{constructor(r){super(r),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1;}};e$7([d$5({constructOnly:!0})],e$3.prototype,"layer",void 0),e$7([d$5()],e$3.prototype,"enabled",void 0),e$7([d$5()],e$3.prototype,"updating",void 0),e$7([d$5()],e$3.prototype,"availability",void 0),e$3=e$7([n$3("esri.views.interactive.snapping.SnappingLayerSource")],e$3);const p$6=e$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class j$1{constructor(t){this.coordinateHelper=t;}}class m$4 extends j$1{constructor(t,s){super(t),this.point=s;}objectEqual(t){return t instanceof m$4&&n$1(this.point,t.point)}check(s){return b$2(s,this.point)<p$7.pointThreshold}closestTo(){return this.coordinateHelper.clone(this.point)}intersect(t){const s=[];return t instanceof b$1?s.push(...y$4({start:t.start,end:t.end,type:t instanceof H$1?b$3.LINE:b$3.RAY},this.point)):t instanceof T$1&&s.push(...d$7(t.center,t.radius,this.point)),s.map((s=>new L$1(this.coordinateHelper,s,this,t)))}}class b$1 extends j$1{constructor(t,s,e){super(t),this.start=s,this.end=e;}objectEqual(t){return t instanceof b$1&&(n$1(this.start,t.start)&&n$1(this.end,t.end))}intersect(t){const s=[];return t instanceof m$4?s.push(...y$4({start:this.start,end:this.end,type:this instanceof H$1?b$3.LINE:b$3.RAY},t.point)):t instanceof b$1?s.push(...j$7({start:this.start,end:this.end,type:this instanceof H$1?b$3.LINE:b$3.RAY},{start:t.start,end:t.end,type:t instanceof H$1?b$3.LINE:b$3.RAY})):t instanceof T$1&&s.push(...v$6({start:this.start,end:this.end,type:this instanceof H$1?b$3.LINE:b$3.RAY},t.center,t.radius)),s.map((s=>new L$1(this.coordinateHelper,s,this,t)))}}class q$1 extends b$1{constructor(t,s,e){super(t,s,e),this.dir=n$6(),this.p=n$6();}objectEqual(t){return t instanceof q$1&&super.objectEqual(t)}check(t){return o$4(this.dir,this.end,this.start),o$4(this.p,t,this.start),j$8(this.dir,this.p)>=0&&E$2(t,this.start,this.end)<p$7.pointOnLineThreshold}closestTo(t){const s=this.coordinateHelper.clone(t);return N$1(s,t,this.start,this.end),s}}class H$1 extends b$1{constructor(t,s,e){super(t,s,e);}objectEqual(t){return t instanceof H$1&&super.objectEqual(t)}check(t){return E$2(t,this.start,this.end)<p$7.pointOnLineThreshold}closestTo(t){const s=this.coordinateHelper.clone(t);return L$3(s,t,this.start,this.end),s}}class L$1 extends j$1{constructor(t,s,e,n){super(t),this.intersection=s,this.first=e,this.second=n;}objectEqual(t){return t instanceof L$1&&(this.first.objectEqual(t.first)&&this.second.objectEqual(t.second))}check(){return !1}closestTo(t){const s=this.coordinateHelper.clone(t);return a$6(s,this.intersection),s}intersect(){return []}}class T$1 extends j$1{constructor(t,s,e){super(t),this.center=s,this.radius=e;}objectEqual(t){return t instanceof T$1&&(this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius)}check(){return !1}closestTo(t){const s=this.coordinateHelper.clone(t);return m$6(s,t,this.center,this.radius),s}intersect(t){const s=[];return t instanceof b$1?s.push(...v$6({start:t.start,end:t.end,type:t instanceof H$1?b$3.LINE:b$3.RAY},this.center,this.radius)):t instanceof m$4&&s.push(...d$7(this.center,this.radius,t.point)),s.map((s=>new L$1(this.coordinateHelper,s,this,t)))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class t$2{constructor(t,o,i,s){this.coordinateHelper=t,this.targetPoint=o,this.constraint=i,this.elevationInfo=s;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e$2 extends t$2{constructor({coordinateHelper:t,targetPoint:e,objectId:o,constraint:n,elevationInfo:r}){super(t,e,n,r),this.objectId=o;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e$1 extends e$2{constructor(n){super({...n,constraint:new H$1(n.coordinateHelper,n.edgeStart,n.edgeEnd)});}get hints(){return [new s$2(e$5.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo)]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class r$1 extends e$2{constructor(n){super({...n,constraint:new m$4(n.coordinateHelper,n.targetPoint)});}get hints(){return [new s$1(this.targetPoint,this.elevationInfo)]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p$5=class extends d$8{constructor(e){super(e),this.availability=0,this._ids=new Set,this.tmpP=n$5();}destroy(){this.workerHandle.destroy(),this.workerHandle=null;}initialize(){this.workerHandle=new l$1(this.schedule,{fetchAllEdgeLocations:(e,t)=>this._fetchAllEdgeLocations(e,t)});}async fetchCandidates(e,t){const r=e.coordinateHelper.toXYZ(e.point);this.view.renderCoordsHelper.toRenderCoords(r,e.coordinateHelper.spatialReference,r);const o="number"==typeof e.distance?e.distance:e.distance.pixelSize,s=await this.workerHandle.invoke({bounds:L$4(r[0],r[1],r[2],o),types:e.types},t),i=e.coordinateHelper;return s.candidates.sort(((e,t)=>e.distance-t.distance)),s.candidates.map((e=>this._convertCandidate(i,e)))}async add(e,t){this._ids.add(e.id),await this.workerHandle.invokeMethod("add",e,t);}async remove(e,t){this._ids.delete(e.id),await this.workerHandle.invokeMethod("remove",e,t);}_convertCandidate(e,t){switch(t.type){case"edge":return new e$1({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),edgeStart:this._convertRenderCoordinate(e,t.start),edgeEnd:this._convertRenderCoordinate(e,t.end),elevationInfo:m$7});case"vertex":return new r$1({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),elevationInfo:m$7})}}_convertRenderCoordinate(e,t){return this.view.renderCoordsHelper.fromRenderCoords(t,this.tmpP,e.spatialReference),e.fromXYZ(this.tmpP)}async _fetchAllEdgeLocations(e,t){const r=[],o=[];for(const{id:s,uid:i}of e.components)this._ids.has(s)&&r.push((async()=>{const e=await this.fetchEdgeLocations(s,t.signal);return o.push(e.locations.buffer),{id:s,uid:i,objectIds:e.objectIds,locations:e.locations.buffer,origin:e.origin,type:e.type}})());return {result:{components:(await Promise.all(r)).filter((({id:e})=>this._ids.has(e)))},transferList:o}}};e$7([d$5({constructOnly:!0})],p$5.prototype,"view",void 0),e$7([d$5({constructOnly:!0})],p$5.prototype,"fetchEdgeLocations",void 0),e$7([d$5({constructOnly:!0})],p$5.prototype,"schedule",void 0),e$7([d$5({readOnly:!0})],p$5.prototype,"availability",void 0),p$5=e$7([n$3("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],p$5);class l$1 extends n$7{constructor(e,t){super("SceneLayerSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated",client:t});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let c$3=class extends d$8{constructor(e){super(e),this.availability=1,this.abortController=new AbortController;}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){this.abortController=h$4(this.abortController);}initialize(){const e=this.view.resourceController;this.edgeWorker=new n$8((r=>e.schedule(r))),this.workerHandle=new p$5({view:this.view,schedule:r=>e.schedule(r),fetchEdgeLocations:async(e,r)=>{if(t$4(this.tracker))throw new Error("tracker-not-initialized");return this.tracker.fetchEdgeLocations(e,this.edgeWorker,r)}}),this.updatingHandles.addPromise(this._setupLayerView()),this.handles.add([t$6(this.workerHandle),t$6(this.edgeWorker)]);}async fetchCandidates(e,r){return this.workerHandle.fetchCandidates(e,r)}refresh(){}async _setupLayerView(){const e=await this.view.whenLayerView(this.layer);if("scene-layer-graphics-3d"===e.type)return;const r={add:(e,r)=>this.updatingHandles.addPromise(this.workerHandle.add({id:e,bounds:r},this.abortController.signal)),remove:e=>this.updatingHandles.addPromise(this.workerHandle.remove({id:e},this.abortController.signal))};this.tracker=e.trackSnappingSources(r),this.handles.add(this.tracker);}};e$7([d$5({constructOnly:!0})],c$3.prototype,"layerSource",void 0),e$7([d$5({constructOnly:!0})],c$3.prototype,"view",void 0),e$7([d$5({readOnly:!0})],c$3.prototype,"updating",null),e$7([d$5({readOnly:!0})],c$3.prototype,"availability",void 0),c$3=e$7([n$3("esri.views.interactive.snapping.featureSources.SceneLayerSnappingSource")],c$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let m$3=class extends y$3{constructor(e){super(e),this.options=null,this._snappingSources=new j$9;}initialize(){this.own([this.view.on("layerview-create",(({layerView:e})=>this._createSource(e))),this.view.on("layerview-destroy",(({layerView:e})=>this._removeSource(e)))]);for(const e of this.view.allLayerViews.items)this._createSource(e);}destroy(){this.options=null,this._snappingSources.drain((e=>e.destroy()));}get updating(){return this._snappingSources.some((e=>e.updating))}get _types(){return E$3.EDGE|E$3.VERTEX}async fetchCandidates(e,r,t){const{view:s,options:i}=this,{coordinateHelper:n,elevationInfo:a}=r,u=r$6(i)?i.distance:1,m=l$9(e,n,a,s,c$5.get()),y=u*s.state.camera.computeScreenPixelSizeAt(m),S=this._types,d=this._snappingSources.items.map((r=>r.fetchCandidates({point:e,coordinateHelper:n,distance:y,types:S},t))),h=(await Promise.all(d)).flat();return r$3(e,h),h}_createSource(e){if("scene-layer-3d"!==e.type)return;const r=new c$3({layerSource:new p$6({layer:e.layer}),view:this.view});this._snappingSources.push(r);}_removeSource(e){const r=this._snappingSources.findIndex((r=>r.layerSource.layer===e.layer));-1!==r&&this._snappingSources.removeAt(r).destroy();}};e$7([d$5({constructOnly:!0})],m$3.prototype,"view",void 0),e$7([d$5()],m$3.prototype,"updating",null),e$7([d$5()],m$3.prototype,"options",void 0),e$7([d$5()],m$3.prototype,"_snappingSources",void 0),m$3=e$7([n$3("esri.views.interactive.snapping.SceneSnappingEngine")],m$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class o$1 extends t$2{constructor({coordinateHelper:t,targetPoint:e,constraint:r,previousVertex:i,otherVertex:o,otherVertexType:n,objectId:s,elevationInfo:h}){super(t,e,r,h),this.previousVertex=i,this.otherVertex=o,this.otherVertexType=n,this.objectId=s;}get hints(){const e=this.previousVertex,o=this.otherVertexType===n.CENTER?this.otherVertex:this.targetPoint,s=this.otherVertexType===n.CENTER?this.targetPoint:this.otherVertex,h=this.elevationInfo;return [new s$2(e$5.TARGET,o,s,h),new s$2(e$5.REFERENCE,e,o,h),new i$3(this.previousVertex,o,s,h)]}}var n;!function(t){t[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER";}(n||(n={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let C=class extends d$8{constructor(e){super(e),this.options=null,this.sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null}};}get updating(){return n$9(this.snappingSources,(({snappingSource:e})=>e.updating))||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,t=new Map;if(r$6(this.options)&&r$6(this.options.featureSources))for(const r of this.options.featureSources.items){const i=r.layer.uid,s=e.get(i);if(s){e.delete(i),t.set(i,s);continue}if(!r.layer.loaded){this.updatingHandles.addPromise(r.layer.load());continue}const n=this._createSourceInfo(r);r$6(n)&&t.set(i,n);}for(const[,r]of e)r.destroy();return t}initialize(){this.updatingHandles.add((()=>this.snappingSources),(()=>this.notifyChange("updating")),U$1),r$6(this.view)&&this.handles.add([this.view.on("layerview-create",(e=>this._updateLayerView(e.layer,e.layerView))),this.view.on("layerview-destroy",(e=>this._updateLayerView(e.layer,null)))]);}_updateLayerView(e,t){for(const[,r]of this.snappingSources)r.snappingSource.layerSource.layer===e&&(r.layerView=t);}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy();}async fetchCandidates(e,t,r){if(t$4(this.options)||!this.options.effectiveFeatureEnabled)return [];const i=[],n=this._computeScreeenSizeDistanceParameters(e,t),u={distance:n,point:e,coordinateHelper:t.coordinateHelper,types:this.types,filter:null};for(const[,{snappingSource:s,layerView:a}]of this.snappingSources)!s.layerSource.enabled||r$6(a)&&a.suspended||i.push(s.fetchCandidates(u,r).then((e=>e.filter((e=>!this._candidateIsExcluded(s,e,t.excludeFeature))))));const p=(await C$1(i)).flat();return this._addRightAngleCandidates(p,e,n,t),f$2(r),r$3(e,p),p}_addRightAngleCandidates(e,t,r,i){const s=r$6(i.vertexHandle)?i.vertexHandle.rightEdge?.rightVertex?.pos:r$6(i.editGeometryOperations)&&"polygon"===i.editGeometryOperations.data.type?e$8(i.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,a=r$6(i.vertexHandle)?i.vertexHandle.leftEdge?.leftVertex?.pos:r$6(i.editGeometryOperations)?e$8(i.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,c=e.length;for(let o=0;o<c;o++)this._addRightAngleCandidate(e[o],a,t,r,i,e),this._addRightAngleCandidate(e[o],s,t,r,i,e);}_addRightAngleCandidate(e,t,r,i,o,n$1){if(t$4(t)||!(e instanceof e$1))return;const a=e.constraint.closestTo(t),c=(a[0]-r[0])/i.x,u=(a[1]-r[1])/i.y;if(c*c+u*u<=1){const r=o.coordinateHelper;n$1.push(new o$1({coordinateHelper:r,targetPoint:a,otherVertex:t,otherVertexType:n.NEXT,previousVertex:e.constraint.start,constraint:new q$1(r,t,a),objectId:e.objectId,elevationInfo:e.elevationInfo}));}}_computeScreeenSizeDistanceParameters(e,t){const r=r$6(this.options)?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;if(t$4(this.view))return {x:r,y:r,pixelSize:r};if("2d"===this.view.type){const e=r*this.view.resolution;return {x:e,y:e,pixelSize:e}}return this._computeScreenSizeDistanceParameters3D(e,r,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,r,i){const{coordinateHelper:o,elevationInfo:s}=i,n=r.state.camera.computeScreenPixelSizeAt(l$9(e,o,s,r,M$1)),a=n*r.renderCoordsHelper.unitInMeters/r.mapCoordsHelper.unitInMeters,c=t*a;return {x:c/this._computeScreenMagnitudeOfMapOffset(e,a,0,r,i),y:c/this._computeScreenMagnitudeOfMapOffset(e,0,a,r,i),pixelSize:n}}_computeScreenMagnitudeOfMapOffset(e,t,r,i,{coordinateHelper:o,elevationInfo:s}){const n=o.clone(e);n[0]+=t,n[1]+=r;const a=R$1(e,o,s,i),c=R$1(n,o,s,i),u=c.x-a.x,p=c.y-a.y;return Math.sqrt(u*u+p*p)}get types(){return E$3.EDGE|E$3.VERTEX}_candidateIsExcluded(e,t,r){if(t$4(r))return !1;const i=this._getCandidateObjectId(t);if(t$4(i))return !1;const o=e.layerSource.layer;return "graphics"===o.type?r.uid===i:r.sourceLayer===o&&(!(!r.attributes||!("objectIdField"in o))&&r.attributes[o.objectIdField]===i)}_getCandidateObjectId(e){return e instanceof e$2?e.objectId:null}_createSourceInfo(e){const t=this._createFeatureSnappingSourceType(e);if(t$4(t))return null;if("loading"in t)return this.updatingHandles.addPromise(t.loading.then((()=>{this.destroyed||this.notifyChange("snappingSources");}))),null;const r=r$6(this.view)?this.view.allLayerViews.find((t=>t.layer===e.layer)):null;return new H(t.source,r)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e)}return null}_createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source.type){case"feature-layer":{const t=this._getSourceModule("featureService");return r$6(t.module)?{source:new t.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}case"memory":case"csv":case"geojson":case"wfs":{if("mesh"===e.layer.geometryType)return null;const t=this._getSourceModule("featureCollection");return r$6(t.module)?{source:new t.module.FeatureCollectionSnappingSource({layerSource:e})}:{loading:t.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const t=this._getSourceModule("graphics");return r$6(t.module)?{source:new t.module.GraphicsSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_getSourceModule(e){const t=this.sourceModules[e];if(t$4(t.loader)){const r=this._loadSourceModule(e).then((e=>{t.module=e;}));return t.loader=r,{module:t.module,loader:r}}return {module:t.module,loader:t.loader}}_loadSourceModule(e){switch(e){case"featureService":return this.updatingHandles.addPromise(import('./FeatureServiceSnappingSource-0b6f88d3.js'));case"featureCollection":return this.updatingHandles.addPromise(import('./FeatureCollectionSnappingSource-c57051c0.js'));case"graphics":return this.updatingHandles.addPromise(import('./GraphicsSnappingSource-10a9455b.js'))}return null}};e$7([d$5({constructOnly:!0})],C.prototype,"spatialReference",void 0),e$7([d$5({constructOnly:!0})],C.prototype,"view",void 0),e$7([d$5()],C.prototype,"options",void 0),e$7([d$5({readOnly:!0})],C.prototype,"updating",null),e$7([d$5({readOnly:!0})],C.prototype,"snappingSources",null),C=e$7([n$3("esri.views.interactive.snapping.FeatureSnappingEngine")],C);class H{constructor(e,t){this.snappingSource=e,this.layerView=t,this.handles=new u$2;const i=this.snappingSource.layerSource.layer;if("refresh"in i){const t=i;this.handles.add(t.on("refresh",(()=>e.refresh())));}this.handles.add([l$4((()=>e.updating),(t=>e.layerSource.updating=t),w$1),l$4((()=>e.availability),(t=>e.layerSource.availability=t),w$1)]);}destroy(){this.snappingSource.destroy(),this.handles.destroy();}}const M$1=n$5();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class i$2{constructor(e,r){this.view=e,this.options=r,this.squaredShortLineThreshold=p$7.shortLineThreshold*p$7.shortLineThreshold;}snap(t,r){return r$6(r.vertexHandle)?"vertex"!==r.vertexHandle.type?[]:this.snapExistingVertex(t,r):this.snapNewVertex(t,r)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.leftVertex.pos,e.rightVertex.pos,t)}exceedsShortLineThreshold(e,t,{elevationInfo:i,editGeometryOperations:o}){const h=o.data.coordinateHelper;return 0===this.squaredShortLineThreshold||E(R$1(t,h,i,this.view),R$1(e,h,i,this.view))>this.squaredShortLineThreshold}squaredProximityTreshold(e){return "touch"===e?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}get squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,r=e*t;return r*r}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class a$2 extends t$2{constructor({coordinateHelper:t,lineStart:n,lineEnd:e,targetPoint:r,elevationInfo:a}){super(t,r,new H$1(t,n,e),a),this.referenceLineHint=new s$2(e$5.REFERENCE_EXTENSION,n,e,a);}get hints(){return [this.referenceLineHint,new s$2(e$5.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo)]}_lineEndClosestToTarget(){const e=this.constraint.start,i=this.constraint.end;return Math.sign(j$8(o$4(c$2,i,e),o$4(p$4,this.targetPoint,e)))>0?i:e}}const p$4=n$6(),c$2=n$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class d$4 extends i$2{snapNewVertex(e,t){const o=t.editGeometryOperations.data.components[0],r=o.edges.length,s=[];if(r<1)return s;const n=t.coordinateHelper,d=R$1(e,n,t.elevationInfo,this.view),p=o.edges[r-1];let a=p;do{this.edgeExceedsShortLineThreshold(a,t)&&this._processCandidateProposal(a.leftVertex.pos,a.rightVertex.pos,e,d,t,s),a=a.leftVertex.leftEdge;}while(a&&a!==p);return s}snapExistingVertex(t,o){const r=[],s=e$8(o.vertexHandle),n=s.component;if(n.edges.length<2)return r;const d=o.coordinateHelper,p=R$1(t,d,o.elevationInfo,this.view),a=s.leftEdge,h=s.rightEdge;a&&h&&this.edgeExceedsShortLineThreshold(a,o)&&this.edgeExceedsShortLineThreshold(h,o)&&this._processCandidateProposal(a.leftVertex.pos,h.rightVertex.pos,t,p,o,r);const l=n.edges[0];let g=l;do{g!==s.leftEdge&&g!==s.rightEdge&&this.edgeExceedsShortLineThreshold(g,o)&&this._processCandidateProposal(g.leftVertex.pos,g.rightVertex.pos,t,p,o,r),g=g.rightVertex.rightEdge;}while(g&&g!==l);return r}_processCandidateProposal(e,o,d,p,a,h){const l=L$3(n$6(),d,e,o),{coordinateHelper:g,elevationInfo:c,pointer:f}=a,m=g.fromXYZ(l,g.getZ(d,0));E(p,R$1(m,g,c,this.view))<this.squaredProximityTreshold(f)&&h.push(new a$2({coordinateHelper:g,lineStart:e,lineEnd:o,targetPoint:m,elevationInfo:c}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class o extends t$2{constructor({coordinateHelper:i,referenceLine:r,lineStart:s,targetPoint:a,elevationInfo:o}){const f=i.clone(s);o$4(f,s$6(f,f,r.rightVertex.pos),r.leftVertex.pos),super(i,a,new H$1(i,s,f),o),this._referenceLines=[{edge:r,fadeLeft:!0,fadeRight:!0}];}get hints(){const e=this.elevationInfo;return [new s$2(e$5.TARGET,this.constraint.start,this.targetPoint,e),new e$4(this.constraint.start,this.targetPoint,e),...this._referenceLines.map((t=>new s$2(e$5.REFERENCE,t.edge.leftVertex.pos,t.edge.rightVertex.pos,e,t.fadeLeft,t.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((n=>{e.rightVertex.rightEdge===n.edge&&(n.fadeLeft=!1,t.fadeRight=!1),e.leftVertex.leftEdge===n.edge&&(n.fadeRight=!1,t.fadeLeft=!1);})),this._referenceLines.push(t);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class c$1 extends i$2{constructor(){super(...arguments),this._tmpProjection=n$6();}snapNewVertex(e,t){const r=t.editGeometryOperations.data.components[0],o=r.edges.length,i=r.vertices.length,s=[];if(o<2)return s;const n=R$1(e,t.coordinateHelper,t.elevationInfo,this.view),a=r.vertices[i-1],c=r.vertices[0],h=r.edges[o-1];let p=h;do{this.edgeExceedsShortLineThreshold(p,t)&&(this._checkEdgeForParalleLines(p,a.pos,e,n,t,s),this._checkEdgeForParalleLines(p,c.pos,e,n,t,s)),p=p.leftVertex.leftEdge;}while(p&&p!==h);return s}snapExistingVertex(t,r){const o=[],i=e$8(r.vertexHandle),s=i.component;if(s.edges.length<3)return o;const n=R$1(t,r.coordinateHelper,r.elevationInfo,this.view),a=i.leftEdge,c=i.rightEdge,h=s.vertices[0],p=s.vertices.length,d=s.vertices[p-1],g=s.edges[0];let m=g;do{m!==a&&m!==c&&this.edgeExceedsShortLineThreshold(m,r)&&(a&&this._checkEdgeForParalleLines(m,a.leftVertex.pos,t,n,r,o),c&&this._checkEdgeForParalleLines(m,c.rightVertex.pos,t,n,r,o),i===h?this._checkEdgeForParalleLines(m,d.pos,t,n,r,o):i===d&&this._checkEdgeForParalleLines(m,h.pos,t,n,r,o)),m=m.rightVertex.rightEdge;}while(m&&m!==g);return o}_checkEdgeForParalleLines(e,r,i,c,h,p){const d=e.leftVertex.pos,g=e.rightVertex.pos;if(L$3(this._tmpProjection,r,d,g),b$2(this._tmpProjection,r)<p$7.parallelLineThreshold)return;L$3(this._tmpProjection,i,d,g,r);const{coordinateHelper:m,elevationInfo:f,pointer:v}=h,P=m.fromXYZ(this._tmpProjection,m.getZ(i,0));if(E(c,R$1(P,m,f,this.view))<this.squaredProximityTreshold(v)){if(this._parallelToPreviousCandidate(e,p))return;p.push(new o({coordinateHelper:m,referenceLine:e,lineStart:r,targetPoint:P,elevationInfo:f}));}}_parallelToPreviousCandidate(e,r){const i=e.leftVertex.pos,s=e.rightVertex.pos;for(const n of r)if(L$3(this._tmpProjection,s,n.constraint.start,n.constraint.end,i),b$2(this._tmpProjection,s)<p$7.parallelLineThreshold)return n.addReferenceLine(e),!0;return !1}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class f$1 extends i$2{constructor(){super(...arguments),this._tmp=n$6();}snapNewVertex(e,t){const r=t.editGeometryOperations.data.components[0],i=r.vertices.length,o=[];if(i<2)return o;const s=R$1(e,t.coordinateHelper,t.elevationInfo,this.view),n=r.vertices[i-1];this._checkForSnappingCandidate(o,n.leftEdge,n.pos,e,n.leftEdge.leftVertex.pos,n.pos,t,e,s);const p=r.vertices[0];return this._checkForSnappingCandidate(o,p.rightEdge,p.pos,e,p.rightEdge.rightVertex.pos,p.pos,t,e,s),o}snapExistingVertex(t,r){const i=[],o=e$8(r.vertexHandle),s=o.component,n=s.vertices.length;if(n<3)return i;const p=R$1(t,r.coordinateHelper,r.elevationInfo,this.view),g=o.leftEdge,h=o.rightEdge,a=s.vertices[0],d=s.vertices[n-1];if(!g)return this._checkForSnappingCandidate(i,a.rightEdge.rightVertex.rightEdge,a.rightEdge.rightVertex.pos,t,a.rightEdge.rightVertex.rightEdge.rightVertex.pos,a.rightEdge.rightVertex.pos,r,t,p),i;if(!h)return this._checkForSnappingCandidate(i,d.leftEdge.leftVertex.leftEdge,d.leftEdge.leftVertex.pos,t,d.leftEdge.leftVertex.leftEdge.leftVertex.pos,d.leftEdge.leftVertex.pos,r,t,p),i;if(g&&g.leftVertex.leftEdge){const e=g.leftVertex.leftEdge;this._checkForSnappingCandidate(i,e,g.leftVertex.pos,t,e.leftVertex.pos,g.leftVertex.pos,r,t,p);}if(h&&h.rightVertex.rightEdge){const e=h.rightVertex.rightEdge;this._checkForSnappingCandidate(i,e,h.rightVertex.pos,t,e.rightVertex.pos,h.rightVertex.pos,r,t,p);}return i}_checkForSnappingCandidate(e,p,f,l,x,V,m,E$1,v){if(!this.edgeExceedsShortLineThreshold(p,m))return;o$4(this._tmp,p.rightVertex.pos,p.leftVertex.pos);const u=r$c(this._tmp[1],-this._tmp[0]),_=j$8(u,o$4(this._tmp,l,f))/p$a(u),{coordinateHelper:S,elevationInfo:C,pointer:k}=m,j=S.fromXYZ(d$9(n$6(),V,u,_),S.getZ(E$1,0));E(v,R$1(j,S,C,this.view))<this.squaredProximityTreshold(k)&&e.push(new o$1({coordinateHelper:S,targetPoint:j,constraint:new q$1(S,V,d$9(S.createVector(),V,u,Math.sign(_))),previousVertex:x,otherVertex:V,otherVertexType:n.CENTER,elevationInfo:C}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class a$1 extends t$2{constructor({coordinateHelper:i,targetPoint:o,point1:p,point2:r,elevationInfo:e}){super(i,o,new T$1(i,A$2(h$2,p,r,.5),.5*m$8(p,r)),e),this.p1=p,this.p2=r;}get hints(){const t=this.elevationInfo;return [new s$2(e$5.REFERENCE,this.targetPoint,this.p1,t),new s$2(e$5.REFERENCE,this.targetPoint,this.p2,t),new i$3(this.p1,this.targetPoint,this.p2,t)]}}const h$2=n$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class d$3 extends i$2{snapNewVertex(e,t){const o=t.editGeometryOperations.data.components[0],r=[],s=o.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||s<2)return r;const i=o.vertices[0],n=o.vertices[s-1];return this._processCandidateProposal(i.pos,n.pos,e,t,r),r}snapExistingVertex(t,o){const r=[],s=e$8(o.vertexHandle),i=s.component;return i.edges.length<2?r:"polyline"!==o.editGeometryOperations.data.type||0!==s.index&&s.index!==i.vertices.length-1?(this._processCandidateProposal(s.leftEdge.leftVertex.pos,s.rightEdge.rightVertex.pos,t,o,r),r):r}_processCandidateProposal(e,s,d,l,m){if(!this.exceedsShortLineThreshold(e,s,l))return;const c=A$2(n$6(),e,s,.5),g=.5*m$8(e,s),h=m$6(n$6(),d,c,g),{coordinateHelper:f,elevationInfo:v,pointer:x}=l,u=f.fromXYZ(h,f.getZ(d,0)),y=R$1(d,f,v,this.view);E(y,R$1(u,f,v,this.view))<this.squaredProximityTreshold(x)&&m.push(new a$1({coordinateHelper:f,targetPoint:u,point1:e,point2:s,elevationInfo:v}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let m$2=class extends y$3{constructor(s){super(s),this.updating=!1,this._snappers=new j$9;}initialize(){this._snappers.push(new c$1(this.view,this.options),new d$4(this.view,this.options),new f$1(this.view,this.options),new d$3(this.view,this.options));}set options(s){this._set("options",s);for(const o of this._snappers)o.options=s;}async fetchCandidates(s,o){if(!this.options.effectiveSelfEnabled)return [];const t=[];for(const r of this._snappers.items)t.push(...r.snap(s,o));return r$3(s,t),t}};e$7([d$5({readOnly:!0})],m$2.prototype,"updating",void 0),e$7([d$5({constructOnly:!0})],m$2.prototype,"view",void 0),e$7([d$5()],m$2.prototype,"options",null),m$2=e$7([n$3("esri.views.interactive.snapping.SelfSnappingEngine")],m$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function i$1(i,p){return [new m$2({view:i,options:p}),new C({view:i,options:p,spatialReference:i.spatialReference})]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p$3=class extends y$3{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new j$9,this.distance=p$7.distance,this.touchSensitivityMultiplier=p$7.touchSensitivityMultiplier;}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};e$7([d$5()],p$3.prototype,"enabled",void 0),e$7([d$5()],p$3.prototype,"enabledToggled",void 0),e$7([d$5()],p$3.prototype,"selfEnabled",void 0),e$7([d$5()],p$3.prototype,"featureEnabled",void 0),e$7([d$5({type:j$9.ofType(p$6)})],p$3.prototype,"featureSources",void 0),e$7([d$5()],p$3.prototype,"distance",void 0),e$7([d$5()],p$3.prototype,"touchSensitivityMultiplier",void 0),e$7([d$5({readOnly:!0})],p$3.prototype,"effectiveEnabled",null),e$7([d$5({readOnly:!0})],p$3.prototype,"effectiveSelfEnabled",null),e$7([d$5({readOnly:!0})],p$3.prototype,"effectiveFeatureEnabled",null),p$3=e$7([n$3("esri.views.interactive.snapping.SnappingOptions")],p$3);const l=p$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class s extends t$2{constructor(i,n,s,r,o){super(i,n,new L$1(i,n,s.constraint,r.constraint),o),this.first=s,this.second=r;}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new i$4(this.targetPoint,this.elevationInfo)]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let _$1=class extends(n$a.EventedMixin(d$8)){constructor(t){super(t),this.options=new l,this.snappingEnginesFactory=i$1,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[];}initialize(){this.handles.add([l$4((()=>{const{effectiveFeatureEnabled:t,effectiveSelfEnabled:e,touchSensitivityMultiplier:i,distance:n}=this.options;return {effectiveFeatureEnabled:t,effectiveSelfEnabled:e,touchSensitivityMultiplier:i,distance:n}}),(()=>{this.doneSnapping(),this.emit("changed");}),U$1),l$4((()=>this.options),(t=>{for(const e of this._engines)e.options=t;}),U$1),l$4((()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory})),(({viewReady:t,snappingEnginesFactory:e})=>this._recreateEngines(t,e)),w$1)]);}destroy(){this._destroyEngines();}get updating(){return this._engines.some((t=>t.updating))}_recreateEngines(t,e){if(this._destroyEngines(),!t)return;const{view:i,options:n}=this;this._engines=e(i,n);}_destroyEngines(){for(const t of this._engines)t.destroy();this._engines=[];}get squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get squaredTouchProximityThreshold(){const{distance:t,touchSensitivityMultiplier:e}=this.options,i=t*e;return i*i}async snap(t,e,i){const r=e.coordinateHelper.pointToVector(t),o=await this._fetchCandidates(r,e,i);return {get valid(){return !p$b(i)},apply:()=>{const{snappedPoint:t,hints:i}=this._processCandidates(r,o,e);return this._removeVisualization(),r$6(e.visualizer)&&this.handles.add(e.visualizer.draw(i,{coordinateHelper:e.coordinateHelper,elevationInfo:e.elevationInfo,view:this.view}),m$1),t}}}update(t,e){this._removeVisualization();let i=t;const s=[];if(r$6(this._currentMainCandidate)){const n=e.coordinateHelper,r=n.pointToVector(t),o=this._currentMainCandidate.constraint.closestTo(r);if(E(R$1(r,n,e.elevationInfo,this.view),R$1(o,n,e.elevationInfo,this.view))<this._squaredPointProximityThreshold(e.pointer)){i=n.vectorToDehydratedPoint(o),this._currentMainCandidate.targetPoint=o,s.push(...this._currentMainCandidate.hints);for(const t of this._currentOtherActiveCandidates)t.targetPoint=o,s.push(...t.hints);}else this._currentMainCandidate=null,this._currentOtherActiveCandidates=[];}return r$6(e.visualizer)&&this.handles.add(e.visualizer.draw(s,{coordinateHelper:e.coordinateHelper,elevationInfo:e.elevationInfo,view:this.view}),m$1),i}doneSnapping(){this._removeVisualization(),this._currentMainCandidate=null,this._currentOtherActiveCandidates=[];}_removeVisualization(){this.handles.remove(m$1);}async _fetchCandidates(t,e,i){return (await Promise.all(this._engines.map((n=>n.fetchCandidates(t,e,i))))).flat()}_processCandidates(t,e,i){if(e.length<1)return this.doneSnapping(),{snappedPoint:i.coordinateHelper.vectorToDehydratedPoint(t),hints:[]};r$3(t,e);const s$1=this._currentMainCandidate;if(r$6(s$1)){const n=this._findOldConstraintInNewCandidates(s$1,e);if(n>=0){if(!(e[n]instanceof s))return this._intersectWithOtherCandidates(n,e,t,i);if(b$2(t,s$1.targetPoint)<this._squaredPointProximityThreshold(i.pointer))return this._updateSnappingCandidate(s$1,e,i)}}return this._intersectWithOtherCandidates(0,e,t,i)}_findOldConstraintInNewCandidates(t,e){return t instanceof s?this._findOldCandidateIndex(e,t.first)>=0&&this._findOldCandidateIndex(e,t.second)>=0?0:-1:this._findOldCandidateIndex(e,t)}_intersectWithOtherCandidates(t,e,i,n){const s$1=e[t],r=[],o=n.coordinateHelper;for(let a=0;a<e.length;++a){if(a===t)continue;const d=e[a];for(const t of s$1.constraint.intersect(d.constraint)){const e=o.fromXYZ(t.intersection,s$1.targetPoint[2]);r.push([new s(o,e,s$1,d,d.elevationInfo),E(R$1(i,n.coordinateHelper,n.elevationInfo,this.view),R$1(e,n.coordinateHelper,n.elevationInfo,this.view))]);}}return r.length>0&&(r.sort(((t,e)=>t[1]-e[1])),r[0][1]<this._squaredPointProximityThreshold(n.pointer))?this._updateSnappingCandidate(r[0][0],e,n):this._updateSnappingCandidate(s$1,e,n)}_updateSnappingCandidate(t,e,i){this.doneSnapping(),this._currentMainCandidate=t;const n=this._currentMainCandidate.targetPoint,s$1=[];s$1.push(...t.hints);for(const r of e){if(t instanceof s){if(r.constraint.objectEqual(t.first.constraint)||r.constraint.objectEqual(t.second.constraint))continue}else if(r.constraint.objectEqual(t.constraint))continue;r.constraint.check(n)&&(r.targetPoint=n,this._currentOtherActiveCandidates.push(r),s$1.push(...r.hints));}return {snappedPoint:i.coordinateHelper.vectorToDehydratedPoint(n),hints:s$1}}_squaredPointProximityThreshold(t){return "touch"===t?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}_findOldCandidateIndex(t,e){let i=-1;for(let n=0;n<t.length;++n)if(e.constraint.objectEqual(t[n].constraint)){i=n;break}return i}get test(){return {visualizationsActive:this.handles.has(m$1),engines:this._engines}}};e$7([d$5({constructOnly:!0})],_$1.prototype,"view",void 0),e$7([d$5()],_$1.prototype,"options",void 0),e$7([d$5({readOnly:!0})],_$1.prototype,"updating",null),e$7([d$5()],_$1.prototype,"snappingEnginesFactory",void 0),e$7([d$5()],_$1.prototype,"_engines",void 0),e$7([d$5()],_$1.prototype,"squaredMouseProximityTreshold",null),e$7([d$5()],_$1.prototype,"squaredTouchProximityThreshold",null),_$1=e$7([n$3("esri.views.interactive.snapping.SnappingManager")],_$1);const m$1="visualization-handle";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
const t$1=new Map;function a(e){t$1.has(e)||t$1.set(e,{referenceCount:0,snappingManager:p$2(e)});const r=t$1.get(e);r.referenceCount++;const o=n$b((()=>i(e,r)));return {snappingManager:r.snappingManager,...o}}function i(n,r){r.referenceCount--,r.referenceCount>0||t$7((()=>{0===r.referenceCount&&(r.snappingManager.destroy(),t$1.delete(n));}));}function p$2(n){return new _$1({view:n,snappingEnginesFactory:(e,o)=>[new m$3({view:n,options:o})]})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class e{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.visualizer=e.visualizer;}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
class d$2{constructor(){this.next=new G$2;}createSnapDragEventPipelineStep({predicate:d=(()=>!0),cancel:c,snappingManager:m,snappingContext:x,updatingHandles:u}){if(t$4(m))return e=>e;let y=null,f=null;const g=()=>{y=h$4(y),m.doneSnapping(),r$6(f)&&f.frameTask.remove(),f=null;};c.next((e=>(g(),e))),this.next=new G$2;const v=x$2((async({frameTask:e,point:t,context:n,event:r,dx:a,dy:i},s)=>{const p=await e.schedule((()=>m.snap(t,n,s)),s);if(p.valid){let l=await e.schedule((()=>p.apply()),s);t!==P&&(l=m.update(P,n)),r$d(l,h)||(r.mapEnd.x=l.x+a,r.mapEnd.y=l.y+i,this.next.execute(r));}}));let P,h;return e$1=>{if(!d(e$1))return e$1;if("start"===e$1.action){const n="3d"===m.view.type?m.view.resourceController.scheduler.registerTask(L$5.SNAPPING):Q;f={context:new e({editGeometryOperations:x.editGeometryOperations,elevationInfo:x.elevationInfo,pointer:x.pointer,vertexHandle:r$6(e$1.info)?e$1.info.handle:null,excludeFeature:x.excludeFeature,visualizer:x.visualizer}),originalPos:r$6(e$1.snapOrigin)?x.coordinateHelper.vectorToDehydratedPoint(e$1.snapOrigin):e$1.mapStart,frameTask:n};}if(r$6(f)){const n=f.context.coordinateHelper.vectorToDehydratedPoint(f.context.coordinateHelper.arrayToVector([f.originalPos.x,f.originalPos.y,f.originalPos.z]));n.x+=e$1.mapEnd.x-e$1.mapStart.x,n.y+=e$1.mapEnd.y-e$1.mapStart.y;const a=e$1.mapStart.x-f.originalPos.x,o=e$1.mapStart.y-f.originalPos.y,i={...e$1,action:"update"},s=f.context,p=m.update(n,f.context);if(h=p,e$1.mapEnd.x=p.x+a,e$1.mapEnd.y=p.y+o,P=n,"end"!==e$1.action){const e=f.frameTask;r$6(y)||(y=new AbortController),u.addPromise(j$a(v({frameTask:e,event:i,context:s,point:n,dx:a,dy:o},y.signal)));}}return "end"===e$1.action&&g(),e$1}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let h$1=class extends y$3{constructor(t){super(t),this.stagedPoint=null,this._abortController=null,this._snap=x$2((async(t,r,s,o)=>{const e=await this._frameTask.schedule((()=>r.snap(t,s,o)),o);e.valid&&await this._frameTask.schedule((()=>{this.stagedPoint=e.apply(),t!==this._snapMapPoint&&(this.stagedPoint=r.update(this._snapMapPoint,s));}),o);}));}initialize(){const t="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=r$6(t)?t.registerTask(L$5.SNAPPING):Q;}destroy(){this._abortController=h$4(this._abortController),this._frameTask=a$7(this._frameTask);}async snap(t,r,s){return this.stagedPoint=r.update(t,s),this._snapMapPoint=t,t$4(this._abortController)&&(this._abortController=new AbortController),this._snap(t,r,s,this._abortController.signal)}abort(){this._abortController=h$4(this._abortController);}};e$7([d$5({constructOnly:!0})],h$1.prototype,"view",void 0),e$7([d$5()],h$1.prototype,"stagedPoint",void 0),h$1=e$7([n$3("esri.views.interactive.snapping.SnappingOperation")],h$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let T=class extends d$8{constructor(n){super(n),this.stagedDimension=null,this._dimensionManipulators=new Map,this._dimensionHandles=new u$2,this._snappingPipeline=new d$2,this._snappingManagerResult=a(n.view),this.own(this._snappingManagerResult);}initialize(){this._snappingOperation=new h$1({view:this.view}),this.own([this._dimensionHandles,l$4((()=>this._snappingOperation.stagedPoint),(n=>{r$6(this.stagedDimension)&&(this.stagedDimension.endPoint=o$5(n,(n=>Z$1(n,new j$2))));}),U$1)]);}destroy(){this._snappingOperation=l$a(this._snappingOperation);}get updating(){return this.updatingHandles.updating||this._snappingManager.updating}get _snappingManager(){return this._snappingManagerResult.snappingManager}addDimension(n,i){if(this._dimensionManipulators.has(n))return;const t=this._createPointManipulator(n,{isStart:!0}),e=this._createPointManipulator(n,{isStart:!1}),s={startManipulator:t,endManipulator:e};this._setupDimensionToManipulatorsSync(n,s),this._dimensionManipulators.set(n,s),i.add(t),i.add(e);}removeDimension(n,i){const t=this._dimensionManipulators.get(n);if(t$4(t))return;this._dimensionHandles.remove(n);const{startManipulator:e,endManipulator:s}=t;this._dimensionManipulators.delete(n),i.remove(e),i.remove(s);}getManipulatorsForDimension(n){return this._dimensionManipulators.get(n)}onDeactivate(){this._snappingManager.doneSnapping();}onUnstagedClick({mapPoint:n,pointerType:i}){const e=this._snappingContext(i),s=Z$1(this._snappingManager.update(n,e),new j$2),a=new u({startPoint:s,endPoint:null});return this.stagedDimension=a,this._snappingManager.doneSnapping(),a}onStagedClick({mapPoint:n,pointerType:i}){if(t$4(this.stagedDimension))return;const t=this._snappingContext(i),e=Z$1(this._snappingManager.update(n,t),new j$2);this.stagedDimension.endPoint=e,this.stagedDimension=null,this._snappingManager.doneSnapping();}onPointerMove({mapPoint:n,pointerType:i}){const t=this._snappingContext(i);this.updatingHandles.addPromise(j$a(this._snappingOperation.snap(n,this._snappingManager,t)));}_setupDimensionToManipulatorsSync(n,i){const{startManipulator:t,endManipulator:e}=i;this._dimensionHandles.add([l$4((()=>({startPoint:n.startPoint,endPoint:n.endPoint,stagedDimension:this.stagedDimension})),(({startPoint:i,endPoint:s,stagedDimension:o})=>{r$6(i)?(t.available=t$4(o)||o===n,t.location=i):t.available=!1,r$6(s)?(e.available=t$4(o),e.location=s):e.available=!1;}),w$1)],n);}_createPointManipulator(n,t){const{isStart:e}=t,s=e?"startPoint":"endPoint",a=y$5(this.view,l$3.toUnitRGB(n$2.pointManipulators.color),n$2.pointManipulators.opacity);a.available=!1,a.radius=n$2.pointManipulators.radius;const o=p$c(a,((i,t,e,a)=>{const o=z$2(i);t.next(o).next(B(this.view)).next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:this._snappingContext(a),snappingManager:this._snappingManager,cancel:e,updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next((i=>{const t=Z$1(i.mapEnd,new j$2);n[s]=t;})),e.next(o).next(z$3(n,[s]));}));return this._dimensionHandles.add(o,n),a}_snappingContext(n){return new e({elevationInfo:{mode:"absolute-height",offset:0},pointer:n,editGeometryOperations:new S$3(new g$2("point",x$3(!0,!1,this.view.spatialReference))),visualizer:new g$1})}};e$7([d$5({constructOnly:!0,nonNullable:!0})],T.prototype,"view",void 0),e$7([d$5({readOnly:!0})],T.prototype,"updating",null),e$7([d$5()],T.prototype,"stagedDimension",void 0),T=e$7([n$3("esri.views.3d.analysis.Dimensioning.LengthDimensionSubTool")],T);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
var d$1;!function(e){e.Ready="ready",e.Creating="creating",e.Created="created";}(d$1||(d$1={}));let v$1=class extends a$8{constructor(e){super(e),this.preferManipulatorCursor=!0,this.analysisViewData=null;}initialize(){this._intersector=x$4(this.view.state.viewingMode),this._intersector.options.store=t$8.MIN,this._lengthDimensionSubTool=new T({view:this.view}),this.own(t$6(this._lengthDimensionSubTool));for(const e of this.analysis.dimensions.items)this._addDimension(e);this.own(this.analysis.dimensions.on("change",(e=>{for(const t of e.added)this._addDimension(t);for(const t of e.removed)this._removeDimension(t);}))),this.own(l$4((()=>this.state),(e=>{e===d$1.Created&&this.finishToolCreation();}),w$1));}get state(){return this.analysis.dimensions.some((e=>"length"===e.type))?r$6(this._activeSubTool)?d$1.Creating:d$1.Created:d$1.Ready}get updating(){return this._lengthDimensionSubTool.updating}get cursor(){return this.active?"crosshair":null}getManipulatorsForDimension(e){return this._lengthDimensionSubTool.getManipulatorsForDimension(e)}onInputEvent(e){switch(e.type){case"immediate-click":this._clickHandler(e);break;case"immediate-double-click":this._doubleClickHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);}}onActivate(){this._activeSubTool=this._lengthDimensionSubTool;}onDeactivate(){r$6(this._activeSubTool)&&(this._activeSubTool.onDeactivate(),r$6(this._activeSubTool.stagedDimension)&&(this.analysis.dimensions.remove(this._activeSubTool.stagedDimension),this._activeSubTool.stagedDimension=null),this._activeSubTool=null);}_clickHandler(e){if(t$4(this._activeSubTool))return;const t=this._intersectScreen(e);if(!t$4(t)){if(t$4(this._activeSubTool.stagedDimension)){const i=this._activeSubTool.onUnstagedClick({mapPoint:t,pointerType:e.pointerType});this.analysis.dimensions.add(i);}else this._activeSubTool.onStagedClick({mapPoint:t,pointerType:e.pointerType});e.stopPropagation();}}_doubleClickHandler(e){this.view.activeTool=null,e.stopPropagation();}_pointerMoveHandler(e){if(t$4(this._activeSubTool))return;if(this.hasFocusedManipulators)return;const t=this._intersectScreen(e);t$4(t)||this._activeSubTool.onPointerMove({mapPoint:t,pointerType:e.pointerType});}_intersectScreen(e){const t=c$6(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);const i=this._intersector.results.min,o=c$5.get();return i.getIntersectionPoint(o)?this.view.renderCoordsHelper.fromRenderCoords(o,this.view.spatialReference):null}_addDimension(e){this._lengthDimensionSubTool.addDimension(e,this.manipulators);}_removeDimension(e){this._lengthDimensionSubTool.removeDimension(e,this.manipulators);}};e$7([d$5({constructOnly:!0})],v$1.prototype,"view",void 0),e$7([d$5({constructOnly:!0})],v$1.prototype,"analysis",void 0),e$7([d$5({readOnly:!0})],v$1.prototype,"state",null),e$7([d$5({readOnly:!0})],v$1.prototype,"updating",null),e$7([d$5({readOnly:!0})],v$1.prototype,"cursor",null),e$7([d$5({readOnly:!0})],v$1.prototype,"preferManipulatorCursor",void 0),e$7([d$5({constructOnly:!0})],v$1.prototype,"analysisViewData",void 0),e$7([d$5()],v$1.prototype,"_activeSubTool",void 0),e$7([d$5()],v$1.prototype,"_lengthDimensionSubTool",void 0),v$1=e$7([n$3("esri.views.3d.analysis.Dimensioning.DimensioningTool")],v$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let G=class extends y$3{constructor(e){super(e),this._directSegment=new l$b,this._dimensionSegment=new l$b,this._offsetAxis=n$5(),this._startOffsetSegment=new l$b(this._directSegment.startRenderSpace,this._dimensionSegment.startRenderSpace),this._endOffsetSegment=new l$b(this._directSegment.endRenderSpace,this._dimensionSegment.endRenderSpace),this._labelSegment=new l$b,this._hasValidGeometry=!1;const t={view:e.view,attached:!0,width:1,color:r$e(1,.5,0,1),renderOccluded:h$3.OccludeAndTransparent},s={...t,stipplePattern:r$f(5)};this._dimensionVisualElement=new C$2(t),this._startOffsetVisualElement=new C$2(s),this._endOffsetVisualElement=new C$2(s),this._label=new v$7({view:e.view,attached:!0,distance:0,fontSize:n$2.labels.fontSize});}initialize(){this.own([t$6(this._dimensionVisualElement),t$6(this._startOffsetVisualElement),t$6(this._endOffsetVisualElement),t$6(this._label)]);const{computation:e,view:t}=this,{dimension:i}=e;this.own([l$4((()=>({startPoint:i.startPoint,endPoint:i.endPoint,offset:i.offset,axis:i.axis,heading:i.heading})),(e=>{this._updateGeometry(e),this._updateLines(),this._updateLabelGeometry(t.state.camera);}),h$5),l$4((()=>e.length),(e=>this._updateLabelContent(e)),h$5),l$4((()=>t.state.camera),(e=>this._updateLabelGeometry(e)),h$5)]);}get testInfo(){return {dimensionVisualElement:this._dimensionVisualElement,label:this._label}}_updateGeometry({startPoint:e,endPoint:t,offset:s,axis:n}){const{renderCoordsHelper:r}=this.view,o=this._directSegment;if(t$4(e)||t$4(t)||!r.toRenderCoords(e,o.startRenderSpace)||!r.toRenderCoords(t,o.endRenderSpace))return void(this._hasValidGeometry=!1);const{startRenderSpace:a,endRenderSpace:m}=o,d=o.eval(.5,c$5.get()),c=r.worldUpAtPosition(d,c$5.get()),h=r.worldBasisAtPosition(d,n$c.X,c$5.get()),p=this._offsetAxis;x$1(p,a,m,c,n,h);const f=s/r.unitInMeters,[u,_]=L(a,m,p,f),S=this._dimensionSegment;g$3(S.startRenderSpace,o.startRenderSpace,p,u),g$3(S.endRenderSpace,o.endRenderSpace,p,_),this._hasValidGeometry=!0;}_updateLines(){if(!this._hasValidGeometry)return this._dimensionVisualElement.visible=!1,this._startOffsetVisualElement.visible=!1,void(this._endOffsetVisualElement.visible=!1);this._dimensionVisualElement.setGeometryFromSegment(this._dimensionSegment),this._startOffsetVisualElement.setGeometryFromSegment(this._startOffsetSegment),this._endOffsetVisualElement.setGeometryFromSegment(this._endOffsetSegment),this._dimensionVisualElement.visible=!0,this._startOffsetVisualElement.visible=!0,this._endOffsetVisualElement.visible=!0;}_updateLabelContent(e){if(t$4(e)||!this._hasValidGeometry)return this._label.text="",void(this._label.visible=!1);const{value:t}=v$8(e,"meters");this._label.text=`${m$9(t,{minimumFractionDigits:2,maximumFractionDigits:2})} m`,this._label.visible=!0;}_updateLabelGeometry(e){if(!this._hasValidGeometry)return void(this._label.visible=!1);const{offset:t}=this.computation.dimension,s=e.computeRenderPixelSizeAt(this._dimensionSegment.eval(.5,c$5.get())),i=(Math.sign(t)>=0?1:-1)*n$2.labels.offset*s;P(this._labelSegment,this._dimensionSegment,this._offsetAxis,i),this._label.geometry={type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1};}};function x$1(e,t,s,i,n,r){switch(n){case"horizontal":return r$9(e,i);case"vertical":return P$2(t,i)<P$2(s,i)?J(e,s,t):J(e,t,s),_$3(e,e,i),G$3(e,f$3)?r$9(e,r):(_$3(e,e,i),z$1(e,e),e);case"direct":return P$2(t,r)>P$2(s,r)?J(e,s,t):J(e,t,s),_$3(e,e,i),G$3(e,f$3)?r$9(e,r):(z$1(e,e),e)}}function L(e,t,s,i=0){const n=P$2(t,s),r=P$2(e,s),o=Math.abs(n-r)+i;return n>r?[o,i]:[i,o]}function P(e,t,s,i){g$3(e.startRenderSpace,t.startRenderSpace,s,i),g$3(e.endRenderSpace,t.endRenderSpace,s,i);}e$7([d$5({constructOnly:!0,nonNullable:!0})],G.prototype,"computation",void 0),e$7([d$5({constructOnly:!0,nonNullable:!0})],G.prototype,"view",void 0),G=e$7([n$3("esri.views.3d.analysis.Dimensioning.LengthDimensionVisualization")],G);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let r=class extends y$3{constructor(o){super(o),this._dimensionVisualizations=new Map;}initialize(){for(const o of this.computations)this._addComputation(o);this.own(this.computations.on("change",(({added:o,removed:i})=>{for(const s of i)this._removeComputation(s);for(const s of o)this._addComputation(s);})));}destroy(){this._dimensionVisualizations.forEach((o=>{o.destroy();})),this._dimensionVisualizations.clear();}get testInfo(){return {visualizations:Array.from(this._dimensionVisualizations.values())}}_addComputation(o){this._dimensionVisualizations.has(o)||this._dimensionVisualizations.set(o,new G({computation:o,view:this.view}));}_removeComputation(o){const i=this._dimensionVisualizations.get(o);t$4(i)||(i.destroy(),this._dimensionVisualizations.delete(o));}};e$7([d$5({constructOnly:!0,nonNullable:!0})],r.prototype,"view",void 0),e$7([d$5({constructOnly:!0,nonNullable:!0})],r.prototype,"computations",void 0),r=e$7([n$3("esri.views.3d.analysis.Dimensioning.DimensioningVisualization")],r);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let t=class extends y$3{constructor(s){super(s),this.dimension=null;}};e$7([d$5({constructOnly:!0,nonNullable:!0})],t.prototype,"dimension",void 0),t=e$7([n$3("esri.views.3d.analysis.LengthDimensionResult")],t);const c=t;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
function f(t){return p$1(t,"direct")}function h(t){return p$1(t,"horizontal")}function p$1(t,i){const{hasZ:o,spatialReference:c}=t,u=i$7(c);let l=0;const s=ee(u);if(t$4(s))return null;const f="direct"===i?x:Z;for(const r of t.paths){if(r.length<2)continue;const t=r.length-1;for(let e=0;e<t;++e){const t=r[e];S[0]=t[0],S[1]=t[1],S[2]=o?t[2]:0;const i=r[e+1];k[0]=i[0],k[1]=i[1],k[2]=o?i[2]:0;const u=f(S,k,c);if(t$4(u))return null;l+=u.value;}}return o$6(l,s)}function m(t,n){const{spatialReference:r}=t;return E$4(r,n.spatialReference)?(S[0]=t.x,S[1]=t.y,S[2]=t.hasZ?t.z:0,k[0]=n.x,k[1]=n.y,k[2]=n.hasZ?n.z:0,R(S,k,r)):null}function z(t,n){const{spatialReference:r}=t;return E$4(r,n.spatialReference)?(S[0]=t.x,S[1]=t.y,S[2]=t.hasZ?t.z:0,k[0]=n.x,k[1]=n.y,k[2]=n.hasZ?n.z:0,x(S,k,r)):null}function y$1(t,n){const{spatialReference:r}=t;return E$4(r,n.spatialReference)?(S[0]=t.x,S[1]=t.y,S[2]=t.hasZ?t.z:0,k[0]=n.x,k[1]=n.y,k[2]=n.hasZ?n.z:0,Z(S,k,r)):null}function d(t,n){const{spatialReference:r}=t;return E$4(r,n.spatialReference)?(S[0]=t.x,S[1]=t.y,S[2]=t.hasZ?t.z:0,k[0]=n.x,k[1]=n.y,k[2]=n.hasZ?n.z:0,g(S,k,r)):null}function v(t){return S[0]=t.x,S[1]=t.y,S[2]=t.hasZ?t.z:0,U(S,t.spatialReference)}function R(n,e,i){const o=b(n,e,i);return r$6(o)?{direct:o$6(o.direct,o.unit),horizontal:o$6(o.horizontal,o.unit),vertical:o$6(o.vertical,o.unit)}:null}function x(n,e,i){const o=b(n,e,i,"direct");return r$6(o)?o$6(o.direct,o.unit):null}function Z(n,e,i){const o=b(n,e,i,"horizontal");return r$6(o)?o$6(o.horizontal,o.unit):null}function j(n,e,i){const o=b(n,e,i,"vertical");return r$6(o)?o$6(Math.abs(o.verticalSigned),o.unit):null}function g(n,e,i){const o=b(n,e,i,"vertical");return r$6(o)?o$6(o.verticalSigned,o.unit):null}function U(n,e){const o=se(e);return r$6(o)?o$6(n[2],o):null}function b(t,r,i,u){const s=i$7(i),f=ee(s);if(t$4(f))return null;const h=r[2]-t[2];if("vertical"===u)return {verticalSigned:h,unit:f};if(!Bn(t,i,M,s)||!Bn(r,i,q,s))return null;if("direct"===u){return {direct:x$5(q,M),unit:f}}if(o$7(w,t[0],t[1],r[2]),!Bn(w,i,w,s))return null;const p=x$5(w,q);if("horizontal"===u)return {horizontal:p,unit:f};return {direct:x$5(q,M),horizontal:p,vertical:Math.abs(h),unit:f}}const S=n$5(),k=n$5(),M=n$5(),q=n$5(),w=n$5();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let p=class extends y$3{constructor(o){super(o);}initialize(){this._set("result",new c({dimension:this.dimension}));}get length(){const{startPoint:o,endPoint:r,axis:t}=this.dimension;if(t$4(o)||t$4(r))return null;const e=m(o,r);if(t$4(e))return null;return e[t]}};e$7([d$5({constructOnly:!0,nonNullable:!0})],p.prototype,"dimension",void 0),e$7([d$5({constructOnly:!0,nonNullable:!0})],p.prototype,"result",void 0),e$7([d$5()],p.prototype,"length",null),p=e$7([n$3("esri.views.3d.analysis.LengthDimensionComputation")],p);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
let y=class extends(n$d(y$3)){constructor(s){super(s),this.type="dimensioning-view-3d",this.tool=null,this._computations=new j$9,this._dimensionsToResults=new Map,this._placementTask=null;}initialize(){this.own([c$7(this,v$1),a$9((()=>this.analysis.dimensions),"change",(({added:s,removed:i})=>{for(const o of i)this._removeDimension(o);for(const o of s)this._addDimension(o);}),{onListenerAdd:s=>{for(const i of s)this._addDimension(i);},onListenerRemove:s=>{for(const i of s)this._removeDimension(i);}})]),this._analysisVisualization=new r({view:this.view,computations:this._computations});}destroy(){this._placementTask=h$4(this._placementTask),this._analysisVisualization=l$a(this._analysisVisualization),this._computations.drain((s=>s.destroy())),m$a(this);}get results(){return this.analysis.dimensions.map((s=>this._dimensionsToResults.get(s)))}get testInfo(){return {visualization:this._analysisVisualization}}async createLengthDimensions(s){return this._placementTask=h$4(this._placementTask),this._placementTask=s$8(this,v$1,s),this._placementTask.promise}_addDimension(s){const i=this._dimensionsToResults;if(i.has(s))return;const o=this._computations,t=new p({dimension:s});o.add(t),i.set(s,t.result);}_removeDimension(s){const i=this._computations,o=this._dimensionsToResults,t=i.findIndex((i=>i.dimension===s)),n=i.removeAt(t);o.delete(s),l$a(n);}};e$7([d$5({readOnly:!0})],y.prototype,"type",void 0),e$7([d$5({constructOnly:!0,nonNullable:!0})],y.prototype,"analysis",void 0),e$7([d$5()],y.prototype,"tool",void 0),e$7([d$5({readOnly:!0})],y.prototype,"results",null),e$7([d$5()],y.prototype,"_analysisVisualization",void 0),e$7([d$5()],y.prototype,"_computations",void 0),e$7([d$5()],y.prototype,"_dimensionsToResults",void 0),e$7([d$5()],y.prototype,"_placementTask",void 0),y=e$7([n$3("esri.views.3d.analysis.DimensioningAnalysisView3D")],y);const _=y;

const DimensioningAnalysisView3D = /*#__PURE__*/Object.freeze({
	__proto__: null,
	'default': _
});

export { DimensioningAnalysisView3D as D, r$3 as a, e$1 as e, r$1 as r };
